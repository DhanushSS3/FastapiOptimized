2025-06-19 23:10:29,883 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:10:29,919 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:10:30,038 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:10:30,055 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:10:30,094 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:10:30,111 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:10:30,153 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:10:30,153 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:11:29,873 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:11:29,887 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:11:29,923 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:11:29,927 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:11:29,948 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:11:29,957 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:11:29,974 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:11:29,974 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:12:29,876 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:12:29,890 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:12:29,969 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:12:29,987 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:12:30,033 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:12:30,046 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:12:30,088 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:12:30,089 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:13:01,246 - WARNING - app.core.cache - No cached adjusted sell price found for key: adjusted_market_price:default:AUDJPY
2025-06-19 23:13:01,246 - WARNING - app.core.cache - Fallback: Using raw Firebase 'b' price for AUDJPY
2025-06-19 23:13:29,874 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:13:29,880 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:13:29,931 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:13:29,943 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:13:29,982 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:13:29,992 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:13:30,015 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:13:30,015 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:13:33,463 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:AUDJPY
2025-06-19 23:13:33,464 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for AUDJPY
2025-06-19 23:14:29,873 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:14:29,882 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:14:29,918 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:14:29,926 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:14:29,962 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:14:29,970 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:14:29,995 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:14:29,995 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:15:29,871 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:15:29,878 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:15:29,916 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:15:29,922 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:15:29,951 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:15:29,957 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:15:29,974 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:15:29,974 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:15:56,655 - INFO - app.main - Application shutdown event triggered.
2025-06-19 23:15:56,655 - INFO - app.main - APScheduler shut down gracefully.
2025-06-19 23:15:56,655 - INFO - app.main - Cancelling 3 other background tasks...
2025-06-19 23:15:56,656 - INFO - app.main - Background task 'Task-5' cancelled successfully.
2025-06-19 23:15:56,657 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-19 23:15:57,673 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-19 23:15:57,674 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-19 23:15:57,674 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-19 23:15:57,675 - INFO - app.main - Redis client connection closed.
2025-06-19 23:15:57,675 - INFO - app.main - Application shutdown event finished.
2025-06-19 23:26:10,590 - INFO - app.core.config - .env file loaded successfully.
2025-06-19 23:26:10,601 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-19 23:26:10,601 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-19 23:26:11,677 - INFO - app.main - Application startup event triggered.
2025-06-19 23:26:11,716 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-19 23:26:11,717 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-19 23:26:11,740 - INFO - app.main - Redis connection pool initialized successfully
2025-06-19 23:26:11,753 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-19 23:26:11,754 - INFO - app.main - Firebase events processor background task started
2025-06-19 23:26:11,754 - INFO - app.main - Redis publisher background task started
2025-06-19 23:26:11,754 - INFO - app.main - Stop loss/take profit checker background task started
2025-06-19 23:26:11,754 - INFO - app.main - Generating initial service account token...
2025-06-19 23:26:11,754 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-19 23:26:13,023 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-19 23:26:13,027 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-19 23:26:13,027 - INFO - app.main - Application startup event finished.
2025-06-19 23:26:13,027 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:26:13,027 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-19 23:26:13,650 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:26:17,861 - INFO - app.main - Application shutdown event triggered.
2025-06-19 23:26:17,861 - INFO - app.main - APScheduler shut down gracefully.
2025-06-19 23:26:17,861 - INFO - app.main - Cancelling 3 other background tasks...
2025-06-19 23:26:17,862 - INFO - app.main - Background task 'Task-5' cancelled successfully.
2025-06-19 23:26:17,864 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-19 23:26:18,150 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-19 23:26:18,150 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-19 23:26:18,150 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-19 23:26:18,151 - INFO - app.main - Redis client connection closed.
2025-06-19 23:26:18,151 - INFO - app.main - Application shutdown event finished.
2025-06-19 23:26:48,151 - INFO - app.core.config - .env file loaded successfully.
2025-06-19 23:26:48,161 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-19 23:26:48,161 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-19 23:26:48,932 - INFO - app.main - Application startup event triggered.
2025-06-19 23:26:48,981 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-19 23:26:48,981 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-19 23:26:49,029 - INFO - app.main - Redis connection pool initialized successfully
2025-06-19 23:26:49,042 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-19 23:26:49,042 - INFO - app.main - Firebase events processor background task started
2025-06-19 23:26:49,042 - INFO - app.main - Redis publisher background task started
2025-06-19 23:26:49,042 - INFO - app.main - Stop loss/take profit checker background task started
2025-06-19 23:26:49,042 - INFO - app.main - Generating initial service account token...
2025-06-19 23:26:49,042 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-19 23:26:49,992 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-19 23:26:49,998 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-19 23:26:49,998 - INFO - app.main - Application startup event finished.
2025-06-19 23:26:49,998 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:26:49,999 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-19 23:26:50,754 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:26:52,047 - INFO - app.api.v1.endpoints.users - Logout successful for user ID 1 by invalidating refresh token.
2025-06-19 23:26:52,578 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-19 23:26:52,600 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-19 23:26:52,624 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-19 23:26:52,645 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-19 23:26:52,673 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-19 23:26:52,694 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-19 23:26:52,718 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-19 23:26:52,740 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-19 23:26:52,764 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-19 23:26:52,786 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-19 23:26:52,805 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-19 23:26:52,827 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-19 23:26:52,848 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-19 23:26:52,868 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-19 23:26:52,887 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-19 23:26:52,908 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-19 23:26:52,928 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-19 23:26:52,951 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-19 23:26:52,971 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-19 23:26:52,992 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-19 23:26:53,012 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-19 23:26:53,036 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-19 23:26:53,058 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-19 23:26:53,078 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-19 23:26:53,099 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-19 23:26:53,114 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-19 23:26:53,135 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-19 23:26:53,162 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-19 23:26:53,177 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-19 23:26:53,191 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-19 23:26:53,214 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-19 23:26:53,237 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-19 23:26:53,256 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-19 23:26:53,275 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-19 23:26:53,296 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-19 23:26:53,320 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-19 23:26:53,341 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-19 23:26:53,360 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-19 23:26:53,380 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-19 23:26:53,403 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-19 23:26:53,423 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-19 23:26:53,445 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-19 23:26:53,465 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-19 23:26:53,484 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-19 23:26:53,502 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-19 23:26:53,523 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-19 23:26:53,541 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-19 23:26:53,558 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-19 23:26:53,596 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-19 23:26:53,617 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-19 23:26:53,634 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-19 23:26:53,652 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-19 23:26:53,668 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-19 23:26:53,688 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-19 23:26:53,706 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-19 23:26:53,723 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-19 23:26:53,740 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-19 23:26:53,759 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-19 23:26:53,778 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-19 23:26:53,798 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-19 23:26:53,817 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-19 23:26:53,834 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-19 23:26:53,854 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-19 23:26:53,874 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-19 23:26:53,894 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-19 23:26:53,914 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-19 23:26:53,932 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-19 23:26:53,950 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-19 23:26:53,969 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-19 23:26:53,982 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-19 23:26:53,996 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-19 23:26:54,013 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-19 23:26:54,032 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-19 23:26:54,052 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-19 23:26:54,072 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-19 23:26:54,091 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-19 23:26:54,108 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-19 23:26:54,128 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-19 23:26:54,146 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-19 23:27:05,335 - ERROR - app.database.session - Database session error: 401: Incorrect password for demo user
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 55, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\api\v1\endpoints\users.py", line 853, in login_demo_user
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Incorrect password for demo user
2025-06-19 23:27:16,909 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-19 23:27:16,994 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-19 23:27:17,121 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-19 23:27:17,211 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-19 23:27:17,278 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-19 23:27:17,327 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-19 23:27:17,388 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-19 23:27:17,446 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-19 23:27:17,486 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-19 23:27:17,531 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-19 23:27:17,585 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-19 23:27:17,669 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-19 23:27:17,731 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-19 23:27:17,772 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-19 23:27:17,824 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-19 23:27:17,883 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-19 23:27:17,978 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-19 23:27:18,071 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-19 23:27:18,161 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-19 23:27:18,257 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-19 23:27:18,327 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-19 23:27:18,404 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-19 23:27:18,496 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-19 23:27:18,540 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-19 23:27:18,584 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-19 23:27:18,655 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-19 23:27:18,688 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-19 23:27:18,722 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-19 23:27:18,759 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-19 23:27:18,806 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-19 23:27:18,834 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-19 23:27:18,846 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-19 23:27:18,876 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-19 23:27:18,923 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-19 23:27:18,966 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-19 23:27:19,002 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-19 23:27:19,029 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-19 23:27:19,077 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-19 23:27:19,104 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-19 23:27:19,125 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-19 23:27:19,151 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-19 23:27:19,173 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-19 23:27:19,194 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-19 23:27:19,216 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-19 23:27:19,243 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-19 23:27:19,263 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-19 23:27:19,287 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-19 23:27:19,309 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-19 23:27:19,338 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-19 23:27:19,369 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-19 23:27:19,393 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-19 23:27:19,421 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-19 23:27:19,443 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-19 23:27:19,478 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-19 23:27:19,507 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-19 23:27:19,530 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-19 23:27:19,556 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-19 23:27:19,581 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-19 23:27:19,596 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-19 23:27:19,635 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-19 23:27:19,664 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-19 23:27:19,693 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-19 23:27:19,734 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-19 23:27:19,794 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-19 23:27:19,836 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-19 23:27:19,926 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-19 23:27:20,017 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-19 23:27:20,092 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-19 23:27:20,167 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-19 23:27:20,183 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-19 23:27:20,200 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-19 23:27:20,230 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-19 23:27:20,284 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-19 23:27:20,313 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-19 23:27:20,341 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-19 23:27:20,366 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-19 23:27:20,394 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-19 23:27:20,422 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-19 23:27:20,445 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-19 23:27:49,040 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:27:49,070 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:27:49,289 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:27:49,314 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:27:49,345 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:27:49,355 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:27:49,398 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:27:49,398 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:28:04,986 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:AUDJPY
2025-06-19 23:28:04,986 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for AUDJPY
2025-06-19 23:28:05,445 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:07,544 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:10,083 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:12,587 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:14,861 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:16,765 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:19,138 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:21,865 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:28:24,018 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:26,278 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:28:48,635 - INFO - app.main - Application shutdown event triggered.
2025-06-19 23:28:48,636 - INFO - app.main - APScheduler shut down gracefully.
2025-06-19 23:28:48,636 - INFO - app.main - Cancelling 3 other background tasks...
2025-06-19 23:28:48,637 - INFO - app.main - Background task 'Task-5' cancelled successfully.
2025-06-19 23:28:48,639 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-19 23:28:50,823 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-19 23:28:50,823 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-19 23:28:50,824 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-19 23:28:50,824 - INFO - app.main - Redis client connection closed.
2025-06-19 23:28:50,824 - INFO - app.main - Application shutdown event finished.
2025-06-19 23:33:51,493 - INFO - app.core.config - .env file loaded successfully.
2025-06-19 23:33:51,500 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-19 23:33:51,500 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-19 23:33:52,470 - INFO - app.main - Application startup event triggered.
2025-06-19 23:33:52,512 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-19 23:33:52,512 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-19 23:33:52,527 - INFO - app.main - Redis connection pool initialized successfully
2025-06-19 23:33:52,535 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-19 23:33:52,535 - INFO - app.main - Firebase events processor background task started
2025-06-19 23:33:52,535 - INFO - app.main - Redis publisher background task started
2025-06-19 23:33:52,535 - INFO - app.main - Stop loss/take profit checker background task started
2025-06-19 23:33:52,535 - INFO - app.main - Generating initial service account token...
2025-06-19 23:33:52,535 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-19 23:33:53,811 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-19 23:33:53,817 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-19 23:33:53,817 - INFO - app.main - Application startup event finished.
2025-06-19 23:33:53,817 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:33:53,818 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-19 23:33:54,442 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:33:55,045 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-19 23:33:55,053 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-19 23:33:55,071 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-19 23:33:55,083 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-19 23:33:55,103 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-19 23:33:55,122 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-19 23:33:55,142 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-19 23:33:55,153 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-19 23:33:55,173 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-19 23:33:55,191 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-19 23:33:55,211 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-19 23:33:55,232 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-19 23:33:55,265 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-19 23:33:55,277 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-19 23:33:55,296 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-19 23:33:55,309 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-19 23:33:55,324 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-19 23:33:55,344 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-19 23:33:55,366 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-19 23:33:55,397 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-19 23:33:55,420 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-19 23:33:55,443 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-19 23:33:55,464 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-19 23:33:55,648 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-19 23:33:55,698 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-19 23:33:55,753 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-19 23:33:55,796 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-19 23:33:55,851 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-19 23:33:55,887 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-19 23:33:55,937 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-19 23:33:55,962 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-19 23:33:55,991 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-19 23:33:56,016 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-19 23:33:56,048 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-19 23:33:56,102 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-19 23:33:56,151 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-19 23:33:56,177 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-19 23:33:56,288 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-19 23:33:56,380 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-19 23:33:56,416 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-19 23:33:56,463 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-19 23:33:56,496 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-19 23:33:56,526 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-19 23:33:56,583 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-19 23:33:56,618 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-19 23:33:56,649 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-19 23:33:56,681 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-19 23:33:56,707 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-19 23:33:56,736 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-19 23:33:56,759 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-19 23:33:56,786 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-19 23:33:56,807 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-19 23:33:56,852 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-19 23:33:56,888 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-19 23:33:56,924 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-19 23:33:56,958 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-19 23:33:56,989 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-19 23:33:57,019 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-19 23:33:57,044 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-19 23:33:57,065 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-19 23:33:57,095 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-19 23:33:57,129 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-19 23:33:57,197 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-19 23:33:57,244 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-19 23:33:57,304 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-19 23:33:57,405 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-19 23:33:57,421 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-19 23:33:57,452 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-19 23:33:57,457 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-19 23:33:57,502 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-19 23:33:57,505 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-19 23:33:57,543 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-19 23:33:57,569 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-19 23:33:57,583 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-19 23:33:57,615 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-19 23:33:57,630 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-19 23:33:57,642 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-19 23:33:57,672 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-19 23:33:57,675 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-19 23:33:57,699 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-19 23:33:57,704 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-19 23:33:57,727 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-19 23:33:57,748 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-19 23:33:57,750 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-19 23:33:57,770 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-19 23:33:57,796 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-19 23:33:57,800 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-19 23:33:57,848 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-19 23:33:57,908 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-19 23:33:57,971 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-19 23:33:58,023 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-19 23:33:58,080 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-19 23:33:58,136 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-19 23:33:58,187 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-19 23:33:58,234 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-19 23:33:58,287 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-19 23:33:58,336 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-19 23:33:58,414 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-19 23:33:58,484 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-19 23:33:58,534 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-19 23:33:58,588 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-19 23:33:58,632 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-19 23:33:58,674 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-19 23:33:58,731 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-19 23:33:58,799 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-19 23:33:58,833 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-19 23:33:58,867 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-19 23:33:58,914 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-19 23:33:58,951 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-19 23:33:58,974 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-19 23:33:58,996 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-19 23:33:59,019 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-19 23:33:59,043 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-19 23:33:59,067 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-19 23:33:59,090 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-19 23:33:59,113 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-19 23:33:59,135 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-19 23:33:59,159 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-19 23:33:59,179 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-19 23:33:59,208 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-19 23:33:59,229 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-19 23:33:59,254 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-19 23:33:59,285 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-19 23:33:59,304 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-19 23:33:59,346 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-19 23:33:59,387 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-19 23:33:59,409 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-19 23:33:59,435 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-19 23:33:59,508 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-19 23:33:59,543 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-19 23:33:59,570 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-19 23:33:59,602 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-19 23:33:59,632 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-19 23:33:59,659 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-19 23:33:59,680 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-19 23:33:59,713 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-19 23:33:59,734 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-19 23:33:59,773 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-19 23:33:59,789 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-19 23:33:59,816 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-19 23:33:59,906 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-19 23:33:59,955 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-19 23:33:59,983 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-19 23:34:00,020 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-19 23:34:00,082 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-19 23:34:00,114 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-19 23:34:00,142 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-19 23:34:00,177 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-19 23:34:00,207 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-19 23:34:00,232 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-19 23:34:00,261 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-19 23:34:00,296 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-19 23:34:00,364 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-19 23:34:00,453 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-19 23:34:00,516 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-19 23:34:00,550 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-19 23:34:00,644 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-19 23:34:00,658 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-19 23:34:02,667 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:AUDCAD
2025-06-19 23:34:02,667 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for AUDCAD
2025-06-19 23:34:03,047 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:34:04,761 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:34:07,150 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:34:52,538 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:34:52,616 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:34:52,733 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:34:52,752 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:34:52,809 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:34:52,828 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:34:52,882 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:34:52,882 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:34:52,983 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:AUDJPY
2025-06-19 23:34:52,983 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for AUDJPY
2025-06-19 23:34:53,696 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:34:55,806 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:34:57,557 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:34:59,756 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:02,019 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:04,635 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:35:06,991 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:35:09,275 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:11,370 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:13,762 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:16,282 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:18,218 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:21,201 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:22,725 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:25,036 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:35:28,451 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-19 23:35:28,473 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-19 23:35:28,492 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-19 23:35:28,516 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-19 23:35:28,533 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-19 23:35:28,555 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-19 23:35:28,567 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-19 23:35:28,591 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-19 23:35:28,614 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-19 23:35:28,632 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-19 23:35:28,663 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-19 23:35:28,676 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-19 23:35:28,695 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-19 23:35:28,716 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-19 23:35:28,737 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-19 23:35:28,756 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-19 23:35:28,774 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-19 23:35:28,796 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-19 23:35:28,816 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-19 23:35:28,832 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-19 23:35:28,849 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-19 23:35:28,892 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-19 23:35:28,906 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-19 23:35:28,928 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-19 23:35:28,941 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-19 23:35:28,972 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-19 23:35:28,988 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-19 23:35:29,007 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-19 23:35:29,027 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-19 23:35:29,046 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-19 23:35:29,075 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-19 23:35:29,102 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-19 23:35:29,126 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-19 23:35:29,151 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-19 23:35:29,167 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-19 23:35:29,188 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-19 23:35:29,209 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-19 23:35:29,228 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-19 23:35:29,251 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-19 23:35:29,269 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-19 23:35:29,287 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-19 23:35:29,313 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-19 23:35:29,338 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-19 23:35:29,361 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-19 23:35:29,384 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-19 23:35:29,405 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-19 23:35:29,425 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-19 23:35:29,437 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-19 23:35:29,453 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-19 23:35:29,467 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-19 23:35:29,480 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-19 23:35:29,494 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-19 23:35:29,510 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-19 23:35:29,524 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-19 23:35:29,544 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-19 23:35:29,563 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-19 23:35:29,582 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-19 23:35:29,602 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-19 23:35:29,624 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-19 23:35:29,647 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-19 23:35:29,662 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-19 23:35:29,677 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-19 23:35:29,698 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-19 23:35:29,720 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-19 23:35:29,738 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-19 23:35:29,762 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-19 23:35:29,818 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-19 23:35:29,837 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-19 23:35:29,854 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-19 23:35:29,870 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-19 23:35:29,881 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-19 23:35:29,897 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-19 23:35:29,916 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-19 23:35:29,938 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-19 23:35:29,965 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-19 23:35:29,978 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-19 23:35:29,999 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-19 23:35:30,018 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-19 23:35:30,036 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-19 23:35:31,833 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:35:34,041 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:35:34,183 - INFO - app.main - Application shutdown event triggered.
2025-06-19 23:35:34,184 - INFO - app.main - APScheduler shut down gracefully.
2025-06-19 23:35:34,184 - INFO - app.main - Cancelling 3 other background tasks...
2025-06-19 23:35:34,185 - INFO - app.main - Background task 'Task-5' cancelled successfully.
2025-06-19 23:35:34,185 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-19 23:35:35,611 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-19 23:35:35,611 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-19 23:35:35,611 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-19 23:35:35,613 - INFO - app.main - Redis client connection closed.
2025-06-19 23:35:35,614 - INFO - app.main - Application shutdown event finished.
2025-06-19 23:55:35,825 - INFO - app.core.config - .env file loaded successfully.
2025-06-19 23:55:35,834 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-19 23:55:35,835 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-19 23:55:36,822 - INFO - app.main - Application startup event triggered.
2025-06-19 23:55:36,855 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-19 23:55:36,855 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-19 23:55:36,894 - INFO - app.main - Redis connection pool initialized successfully
2025-06-19 23:55:36,903 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-19 23:55:36,903 - INFO - app.main - Firebase events processor background task started
2025-06-19 23:55:36,903 - INFO - app.main - Redis publisher background task started
2025-06-19 23:55:36,903 - INFO - app.main - Stop loss/take profit checker background task started
2025-06-19 23:55:36,903 - INFO - app.main - Generating initial service account token...
2025-06-19 23:55:36,903 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-19 23:55:38,071 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-19 23:55:38,075 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-19 23:55:38,075 - INFO - app.main - Application startup event finished.
2025-06-19 23:55:38,075 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:55:38,076 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-19 23:55:38,682 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-19 23:55:55,402 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-19 23:55:55,455 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-19 23:55:55,518 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-19 23:55:55,562 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-19 23:55:55,603 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-19 23:55:55,673 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-19 23:55:55,756 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-19 23:55:55,800 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-19 23:55:55,849 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-19 23:55:55,888 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-19 23:55:55,925 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-19 23:55:55,974 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-19 23:55:56,069 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-19 23:55:56,227 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-19 23:55:56,296 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-19 23:55:56,399 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-19 23:55:56,472 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-19 23:55:56,719 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-19 23:55:56,865 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-19 23:55:56,964 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-19 23:55:57,123 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-19 23:55:57,146 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-19 23:55:57,181 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-19 23:55:57,203 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-19 23:55:57,225 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-19 23:55:57,263 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-19 23:55:57,291 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-19 23:55:57,316 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-19 23:55:57,395 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-19 23:55:57,416 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-19 23:55:57,444 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-19 23:55:57,468 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-19 23:55:57,485 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-19 23:55:57,512 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-19 23:55:57,536 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-19 23:55:57,566 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-19 23:55:57,589 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-19 23:55:57,613 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-19 23:55:57,635 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-19 23:55:57,664 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-19 23:55:57,684 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-19 23:55:57,704 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-19 23:55:57,725 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-19 23:55:57,750 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-19 23:55:57,779 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-19 23:55:57,798 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-19 23:55:57,842 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-19 23:55:57,870 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-19 23:55:57,910 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-19 23:55:57,935 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-19 23:55:57,969 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-19 23:55:57,995 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-19 23:55:58,179 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-19 23:55:58,241 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-19 23:55:58,253 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-19 23:55:58,268 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-19 23:55:58,321 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-19 23:55:58,343 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-19 23:55:58,388 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-19 23:55:58,419 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-19 23:55:58,436 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-19 23:55:58,460 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-19 23:55:58,484 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-19 23:55:58,509 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-19 23:55:58,553 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-19 23:55:58,573 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-19 23:55:58,594 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-19 23:55:58,621 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-19 23:55:58,641 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-19 23:55:58,669 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-19 23:55:58,698 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-19 23:55:58,728 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-19 23:55:58,758 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-19 23:55:58,777 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-19 23:55:58,811 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-19 23:55:58,855 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-19 23:55:58,911 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-19 23:55:58,934 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-19 23:55:58,963 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-19 23:56:02,196 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:56:04,432 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:56:06,634 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:56:08,895 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:56:36,911 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:56:36,968 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:56:37,065 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:56:37,076 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:56:37,110 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:56:37,125 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:56:37,161 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:56:37,161 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:56:48,251 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:AUDJPY
2025-06-19 23:56:48,252 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for AUDJPY
2025-06-19 23:56:48,876 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:56:50,647 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:56:52,948 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:56:55,218 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:56:57,453 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:00,328 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:57:02,414 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:04,588 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:06,742 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:09,648 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:12,431 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:14,638 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:57:16,215 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:18,400 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:20,581 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:23,127 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:25,498 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:27,739 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:57:30,142 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:32,150 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:AUDJPY
2025-06-19 23:57:32,150 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for AUDJPY
2025-06-19 23:57:32,578 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:34,581 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:36,910 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-19 23:57:36,940 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-19 23:57:36,947 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:37,018 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-19 23:57:37,032 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-19 23:57:37,068 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-19 23:57:37,082 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-19 23:57:37,097 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-19 23:57:37,136 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-19 23:57:37,136 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-19 23:57:39,295 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:41,643 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:44,357 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:46,812 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:49,073 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:57:49,073 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:57:51,356 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:57:51,356 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDJPY
2025-06-19 23:57:54,023 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-19 23:57:54,560 - INFO - app.main - Application shutdown event triggered.
2025-06-19 23:57:54,560 - INFO - app.main - APScheduler shut down gracefully.
2025-06-19 23:57:54,560 - INFO - app.main - Cancelling 3 other background tasks...
2025-06-19 23:57:54,562 - INFO - app.main - Background task 'Task-5' cancelled successfully.
2025-06-19 23:57:54,563 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-19 23:57:55,077 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-19 23:57:55,077 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-19 23:57:55,077 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-19 23:57:55,078 - INFO - app.main - Redis client connection closed.
2025-06-19 23:57:55,078 - INFO - app.main - Application shutdown event finished.
2025-06-20 05:37:58,842 - INFO - app.core.config - .env file loaded successfully.
2025-06-20 05:37:58,847 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-20 05:37:58,847 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-20 05:37:59,590 - INFO - app.main - Application startup event triggered.
2025-06-20 05:37:59,628 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-20 05:37:59,628 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-20 05:37:59,639 - INFO - app.main - Redis connection pool initialized successfully
2025-06-20 05:37:59,644 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-20 05:37:59,644 - INFO - app.main - Firebase events processor background task started
2025-06-20 05:37:59,644 - INFO - app.main - Redis publisher background task started
2025-06-20 05:37:59,644 - INFO - app.main - Stop loss/take profit checker background task started
2025-06-20 05:37:59,644 - INFO - app.main - Generating initial service account token...
2025-06-20 05:37:59,644 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-20 05:38:00,745 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-20 05:38:00,747 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-20 05:38:00,747 - INFO - app.main - Application startup event finished.
2025-06-20 05:38:00,748 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-20 05:38:00,749 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-20 05:38:01,461 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-20 05:38:03,172 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-20 05:38:03,189 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-20 05:38:03,209 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-20 05:38:03,228 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-20 05:38:03,242 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-20 05:38:03,257 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-20 05:38:03,273 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-20 05:38:03,292 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-20 05:38:03,306 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-20 05:38:03,324 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-20 05:38:03,337 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-20 05:38:03,353 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-20 05:38:03,370 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-20 05:38:03,383 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-20 05:38:03,397 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-20 05:38:03,408 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-20 05:38:03,417 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-20 05:38:03,428 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-20 05:38:03,440 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-20 05:38:03,452 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-20 05:38:03,468 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-20 05:38:03,486 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-20 05:38:03,540 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-20 05:38:03,557 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-20 05:38:03,577 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-20 05:38:03,592 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-20 05:38:03,606 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-20 05:38:03,624 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-20 05:38:03,644 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-20 05:38:03,663 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-20 05:38:03,681 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-20 05:38:03,698 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-20 05:38:03,713 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-20 05:38:03,728 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-20 05:38:03,744 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-20 05:38:03,753 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-20 05:38:03,769 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-20 05:38:03,790 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-20 05:38:03,807 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-20 05:38:03,822 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-20 05:38:03,838 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-20 05:38:03,852 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-20 05:38:03,868 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-20 05:38:03,889 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-20 05:38:03,910 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-20 05:38:03,929 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-20 05:38:03,949 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-20 05:38:03,989 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-20 05:38:04,012 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-20 05:38:04,030 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-20 05:38:04,050 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-20 05:38:04,065 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-20 05:38:04,088 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-20 05:38:04,105 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-20 05:38:04,125 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-20 05:38:04,142 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-20 05:38:04,153 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-20 05:38:04,169 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-20 05:38:04,186 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-20 05:38:04,205 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-20 05:38:04,219 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-20 05:38:04,245 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-20 05:38:04,267 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-20 05:38:04,285 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-20 05:38:04,299 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-20 05:38:04,311 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-20 05:38:04,326 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-20 05:38:04,338 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-20 05:38:04,354 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-20 05:38:04,371 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-20 05:38:04,387 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-20 05:38:04,416 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-20 05:38:04,430 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-20 05:38:04,446 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-20 05:38:04,458 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-20 05:38:04,479 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-20 05:38:04,494 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-20 05:38:04,509 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-20 05:38:04,526 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-20 05:38:06,653 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:CADCHF
2025-06-20 05:38:06,653 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for CADCHF
2025-06-20 05:38:07,244 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:08,941 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:11,262 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:13,450 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:15,913 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:18,474 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:20,651 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:23,005 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:25,227 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:27,578 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:38:59,643 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:38:59,664 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:38:59,736 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:38:59,754 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:38:59,785 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:38:59,804 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:38:59,849 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:38:59,850 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:39:59,644 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:39:59,656 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:39:59,713 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:39:59,731 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:39:59,792 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:39:59,819 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:39:59,869 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:39:59,869 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:40:59,642 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:40:59,661 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:40:59,724 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:40:59,743 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:40:59,830 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:40:59,858 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:40:59,910 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:40:59,911 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:41:59,643 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:41:59,655 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:41:59,708 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:41:59,722 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:41:59,754 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:41:59,769 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:41:59,889 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:41:59,889 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:42:59,649 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:42:59,706 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:42:59,773 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:42:59,800 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:42:59,870 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:42:59,892 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:42:59,974 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:42:59,974 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:43:59,653 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:43:59,711 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:43:59,845 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:43:59,919 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:43:59,962 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:43:59,992 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:44:00,069 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:44:00,069 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:44:54,483 - WARNING - app.core.cache - No cached adjusted buy price found for key: adjusted_market_price:default:AUDCAD
2025-06-20 05:44:54,484 - WARNING - app.core.cache - Fallback: Using raw Firebase 'o' price for AUDCAD
2025-06-20 05:44:54,766 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:44:56,868 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:44:59,200 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:44:59,644 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:44:59,653 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:44:59,697 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:44:59,709 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:44:59,738 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-20 05:44:59,744 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:44:59,750 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:44:59,786 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:44:59,786 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:45:01,379 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:03,611 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:06,169 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:08,529 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:10,892 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:13,077 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:15,343 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:17,622 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:20,140 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:22,312 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:24,524 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:26,905 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:29,107 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:31,403 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:33,821 - WARNING - app.services.portfolio_calculator - No adjusted prices found for symbol AUDCAD
2025-06-20 05:45:36,234 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:38,403 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:40,703 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:42,854 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:45,275 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:47,602 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:49,881 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:52,277 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:54,670 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:56,877 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:59,230 - ERROR - app.services.portfolio_calculator - Error calculating portfolio: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\services\portfolio_calculator.py", line 228, in calculate_user_portfolio
    price_diff = current_sell - entry_price
                 ~~~~~~~~~~~~~^~~~~~~~~~~~~
TypeError: unsupported operand type(s) for -: 'float' and 'decimal.Decimal'
2025-06-20 05:45:59,655 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-20 05:45:59,665 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-20 05:45:59,721 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-20 05:45:59,737 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-20 05:45:59,763 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-20 05:45:59,766 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-20 05:45:59,778 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-20 05:45:59,807 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-20 05:45:59,807 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-20 05:46:01,132 - INFO - app.main - Application shutdown event triggered.
2025-06-20 05:46:01,133 - INFO - app.main - APScheduler shut down gracefully.
2025-06-20 05:46:01,133 - INFO - app.main - Cancelling 3 other background tasks...
2025-06-20 05:46:01,134 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-20 05:46:03,194 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-20 05:46:03,194 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-20 05:46:03,195 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-20 05:46:03,195 - INFO - app.main - Background task 'Task-5' cancelled successfully.
2025-06-20 05:46:03,196 - INFO - app.main - Redis client connection closed.
2025-06-20 05:46:03,196 - INFO - app.main - Application shutdown event finished.
2025-06-21 06:32:43,016 - INFO - app.core.config - .env file loaded successfully.
2025-06-21 06:32:43,024 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-21 06:32:43,025 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-21 06:32:43,929 - INFO - app.main - Application startup event triggered.
2025-06-21 06:32:44,007 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-21 06:32:44,007 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-21 06:32:46,099 - WARNING - app.main - Redis connection failed - continuing without Redis: 503: Redis unavailable
2025-06-21 06:32:46,113 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-21 06:32:46,113 - INFO - app.main - Firebase events processor background task started
2025-06-21 06:32:46,113 - WARNING - app.main - Redis is not available - skipping Redis-dependent tasks
2025-06-21 06:32:46,113 - INFO - app.main - Generating initial service account token...
2025-06-21 06:32:46,113 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-21 06:32:50,201 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-21 06:32:50,205 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-21 06:32:50,206 - INFO - app.main - Application startup event finished.
2025-06-21 06:32:50,206 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-21 06:32:50,207 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-21 06:32:51,042 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-21 06:33:46,113 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:33:46,113 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:34:46,118 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:34:46,119 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:35:46,121 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:35:46,121 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:36:46,118 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:36:46,119 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:37:46,115 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:37:46,115 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:38:46,122 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:38:46,122 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:39:46,119 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:39:46,119 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:40:46,117 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:40:46,117 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:41:46,123 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:41:46,124 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:42:46,115 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:42:46,115 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:43:46,116 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:43:46,117 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:44:46,121 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:44:46,121 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:45:46,118 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:45:46,118 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:46:46,118 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:46:46,118 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:47:46,127 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:47:46,127 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:52:46,119 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:52:46,119 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:53:46,123 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:53:46,123 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:54:46,114 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:54:46,115 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:55:46,113 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:55:46,114 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:56:46,121 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:56:46,122 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:57:46,113 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:57:46,113 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:58:46,117 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:58:46,117 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 06:59:46,119 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-21 06:59:46,119 - ERROR - app.main - Cannot update dynamic portfolios - Redis client not available
2025-06-21 07:00:21,460 - INFO - app.main - Application shutdown event triggered.
2025-06-21 07:00:21,460 - INFO - app.main - APScheduler shut down gracefully.
2025-06-21 07:00:21,460 - INFO - app.main - Cancelling 1 other background tasks...
2025-06-21 07:00:21,461 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-21 07:00:21,462 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-21 07:00:21,462 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-21 07:00:21,462 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-21 07:00:21,462 - WARNING - app.main - Redis client was not initialized or already closed.
2025-06-21 07:00:21,462 - INFO - app.main - Application shutdown event finished.
2025-06-22 21:26:55,023 - INFO - app.core.config - .env file loaded successfully.
2025-06-22 21:26:55,029 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-22 21:26:55,029 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-22 21:26:55,776 - INFO - app.main - Application startup event triggered.
2025-06-22 21:26:55,813 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-22 21:26:55,813 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-22 21:26:57,890 - WARNING - app.main - Redis connection failed - continuing without Redis: 503: Redis unavailable
2025-06-22 21:26:57,909 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-22 21:26:57,909 - INFO - app.main - Firebase events processor background task started
2025-06-22 21:26:57,909 - WARNING - app.main - Redis is not available - skipping Redis-dependent tasks
2025-06-22 21:26:57,909 - INFO - app.main - Generating initial service account token...
2025-06-22 21:26:57,909 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-22 21:26:59,334 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-22 21:26:59,340 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-22 21:26:59,341 - INFO - app.main - Application startup event finished.
2025-06-22 21:26:59,342 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-22 21:26:59,343 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-22 21:27:00,059 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-22 21:27:22,791 - INFO - app.main - Application shutdown event triggered.
2025-06-22 21:27:22,792 - INFO - app.main - APScheduler shut down gracefully.
2025-06-22 21:27:22,792 - INFO - app.main - Cancelling 1 other background tasks...
2025-06-22 21:27:22,793 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-22 21:27:24,879 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-22 21:27:24,879 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-22 21:27:24,879 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-22 21:27:24,879 - WARNING - app.main - Redis client was not initialized or already closed.
2025-06-22 21:27:24,879 - INFO - app.main - Application shutdown event finished.
2025-06-22 21:27:34,702 - INFO - app.core.config - .env file loaded successfully.
2025-06-22 21:27:34,708 - INFO - app.core.config - Settings instance loaded. Project: Trading App, API Prefix: /api/v1
2025-06-22 21:27:34,708 - INFO - app.database.session - Attempting to connect to database using URL: mysql+aiomysql://roo...
2025-06-22 21:27:35,520 - INFO - app.main - Application startup event triggered.
2025-06-22 21:27:35,559 - INFO - app.main - Firebase Admin SDK already initialized
2025-06-22 21:27:35,560 - WARNING - app.dependencies.redis_client - Redis client not initialized, attempting late connection.
2025-06-22 21:27:35,575 - INFO - app.main - Redis connection pool initialized successfully
2025-06-22 21:27:35,582 - INFO - app.main - APScheduler started successfully with jobs configured
2025-06-22 21:27:35,582 - INFO - app.main - Firebase events processor background task started
2025-06-22 21:27:35,582 - INFO - app.main - Redis publisher background task started
2025-06-22 21:27:35,582 - INFO - app.main - Stop loss/take profit checker background task started
2025-06-22 21:27:35,582 - INFO - app.main - Generating initial service account token...
2025-06-22 21:27:35,582 - INFO - app.main - APScheduler: Starting rotate_service_account_jwt job...
2025-06-22 21:27:36,647 - INFO - app.main - SUCCESS: Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-22 21:27:36,653 - INFO - app.main - APScheduler: Finished rotate_service_account_jwt job successfully.
2025-06-22 21:27:36,653 - INFO - app.main - Application startup event finished.
2025-06-22 21:27:36,655 - INFO - app.firebase_stream - Starting Firebase Admin event processing task for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-22 21:27:36,656 - INFO - app.firebase_stream - Attempting to start Firebase Admin listener for path: 'datafeeds'.
2025-06-22 21:27:37,370 - INFO - app.firebase_stream - Firebase Admin listener started successfully for path: 'datafeeds'. Queuing data for Redis publishing.
2025-06-22 21:28:20,349 - ERROR - app.database.session - Database session error: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 55, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 424, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-06-22 21:28:20,441 - ERROR - app.database.session - Database session error: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 55, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 424, in get_user_from_service_or_user_token
    raise HTTPException(
    ...<3 lines>...
    )
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-06-22 21:28:20,500 - ERROR - app.database.session - Database session error: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 55, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 326, in get_current_user
    raise credentials_exception
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-06-22 21:28:20,530 - ERROR - app.database.session - Database session error: 401: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\database\session.py", line 55, in get_db
    yield session
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\routing.py", line 291, in app
    solved_result = await solve_dependencies(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\fastapi\dependencies\utils.py", line 638, in solve_dependencies
    solved = await call(**solved_result.values)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 326, in get_current_user
    raise credentials_exception
fastapi.exceptions.HTTPException: 401: Could not validate credentials
2025-06-22 21:28:35,589 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-22 21:28:35,698 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-22 21:28:35,809 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-22 21:28:35,824 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-22 21:28:35,890 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-22 21:28:35,903 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-22 21:28:35,916 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-22 21:28:35,977 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-22 21:28:35,978 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-22 21:28:40,879 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCAD'.
2025-06-22 21:28:40,943 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDCHF'.
2025-06-22 21:28:41,001 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDJPY'.
2025-06-22 21:28:41,106 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDNZD'.
2025-06-22 21:28:41,178 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDSGD'.
2025-06-22 21:28:41,278 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUDUSD'.
2025-06-22 21:28:41,351 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADCHF'.
2025-06-22 21:28:41,627 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CADJPY'.
2025-06-22 21:28:41,719 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFJPY'.
2025-06-22 21:28:41,853 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CHFSGD'.
2025-06-22 21:28:41,979 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURAUD'.
2025-06-22 21:28:42,102 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCAD'.
2025-06-22 21:28:42,238 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCHF'.
2025-06-22 21:28:42,310 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURCZK'.
2025-06-22 21:28:42,437 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURGBP'.
2025-06-22 21:28:42,508 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURJPY'.
2025-06-22 21:28:42,578 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNOK'.
2025-06-22 21:28:42,664 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURNZD'.
2025-06-22 21:28:42,755 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURPLN'.
2025-06-22 21:28:42,841 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSEK'.
2025-06-22 21:28:42,925 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURSGD'.
2025-06-22 21:28:43,010 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURTRY'.
2025-06-22 21:28:43,090 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURUSD'.
2025-06-22 21:28:43,152 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'EURZAR'.
2025-06-22 21:28:43,186 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPAUD'.
2025-06-22 21:28:43,218 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCAD'.
2025-06-22 21:28:43,243 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPCHF'.
2025-06-22 21:28:43,269 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPJPY'.
2025-06-22 21:28:43,294 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNOK'.
2025-06-22 21:28:43,339 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPNZD'.
2025-06-22 21:28:43,352 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSEK'.
2025-06-22 21:28:43,369 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPSGD'.
2025-06-22 21:28:43,428 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPTRY'.
2025-06-22 21:28:43,459 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GBPUSD'.
2025-06-22 21:28:43,602 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKJPY'.
2025-06-22 21:28:43,647 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NOKSEK'.
2025-06-22 21:28:43,665 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCAD'.
2025-06-22 21:28:43,692 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDCHF'.
2025-06-22 21:28:43,726 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDJPY'.
2025-06-22 21:28:43,768 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NZDUSD'.
2025-06-22 21:28:43,804 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SEKJPY'.
2025-06-22 21:28:43,827 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'SGDJPY'.
2025-06-22 21:28:43,866 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCAD'.
2025-06-22 21:28:43,887 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCHF'.
2025-06-22 21:28:43,921 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCNH'.
2025-06-22 21:28:43,948 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDCZK'.
2025-06-22 21:28:43,998 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDJPY'.
2025-06-22 21:28:44,038 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDMXN'.
2025-06-22 21:28:44,061 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDNOK'.
2025-06-22 21:28:44,111 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDPLN'.
2025-06-22 21:28:44,143 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSEK'.
2025-06-22 21:28:44,166 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDSGD'.
2025-06-22 21:28:44,206 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTHB'.
2025-06-22 21:28:44,220 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTRY'.
2025-06-22 21:28:44,242 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDZAR'.
2025-06-22 21:28:44,281 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'ZARJPY'.
2025-06-22 21:28:44,340 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAUUSD'.
2025-06-22 21:28:44,362 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'XAGUSD'.
2025-06-22 21:28:44,423 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'BTCUSD'.
2025-06-22 21:28:44,451 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UK100'.
2025-06-22 21:28:44,476 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'DE30'.
2025-06-22 21:28:44,513 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'AUS200'.
2025-06-22 21:28:44,532 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'FR40'.
2025-06-22 21:28:44,557 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US100'.
2025-06-22 21:28:44,595 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US500'.
2025-06-22 21:28:44,621 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000'.
2025-06-22 21:28:44,667 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US30'.
2025-06-22 21:28:44,701 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'JP225'.
2025-06-22 21:28:44,752 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'IND50'.
2025-06-22 21:28:44,800 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'CN50U'.
2025-06-22 21:28:44,832 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'HKG50'.
2025-06-22 21:28:44,875 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USOIL'.
2025-06-22 21:28:44,888 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'UKOIL'.
2025-06-22 21:28:44,921 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'NGAS'.
2025-06-22 21:28:44,963 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'USDTUSD'.
2025-06-22 21:28:45,000 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'US2000-1'.
2025-06-22 21:28:45,027 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'GER30-1'.
2025-06-22 21:28:45,089 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'W20'.
2025-06-22 21:28:45,113 - DEBUG - app.core.cache - Group-symbol settings cached for group 'Group B', symbol 'D30'.
2025-06-22 21:29:35,585 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-22 21:29:35,627 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-22 21:29:35,705 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-22 21:29:35,720 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-22 21:29:35,781 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-22 21:29:35,792 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-22 21:29:35,815 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-22 21:29:35,909 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-22 21:29:35,909 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-22 21:30:35,583 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-22 21:30:35,654 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-22 21:30:35,983 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-22 21:30:36,027 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-22 21:30:36,146 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-22 21:30:36,174 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-22 21:30:36,201 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-22 21:30:36,292 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-22 21:30:36,292 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-22 21:31:35,584 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-22 21:31:35,595 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-22 21:31:35,681 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-22 21:31:35,741 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-22 21:31:35,817 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-22 21:31:35,822 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-22 21:31:35,841 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-22 21:31:35,885 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-22 21:31:35,885 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-22 21:32:35,589 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-22 21:32:35,597 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-22 21:32:35,647 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-22 21:32:35,661 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-22 21:32:35,690 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-22 21:32:35,694 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-22 21:32:35,708 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-22 21:32:35,739 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-22 21:32:35,739 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-22 21:33:35,594 - DEBUG - app.main - Starting update_all_users_dynamic_portfolio job
2025-06-22 21:33:35,602 - DEBUG - app.main - Found 8 active users to update portfolios
2025-06-22 21:33:35,665 - WARNING - app.main - No group settings found for group Admin. Skipping portfolio update for user 5.
2025-06-22 21:33:35,680 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 8.
2025-06-22 21:33:35,725 - ERROR - app.main - Error updating portfolio for user 1: 'DemoUserOrder' object has no attribute 'to_dict'
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\main.py", line 218, in update_all_users_dynamic_portfolio
    open_positions = [o.to_dict() for o in open_orders_orm]
                      ^^^^^^^^^
AttributeError: 'DemoUserOrder' object has no attribute 'to_dict'
2025-06-22 21:33:35,731 - WARNING - app.main - User 2 has no group_name set. Skipping portfolio update.
2025-06-22 21:33:35,760 - WARNING - app.main - No group settings found for group string. Skipping portfolio update for user 3.
2025-06-22 21:33:35,797 - WARNING - app.main - User 5 has no group_name set. Skipping portfolio update.
2025-06-22 21:33:35,797 - DEBUG - app.main - Finished update_all_users_dynamic_portfolio job
2025-06-22 21:33:47,355 - INFO - app.main - Application shutdown event triggered.
2025-06-22 21:33:47,355 - INFO - app.main - APScheduler shut down gracefully.
2025-06-22 21:33:47,355 - INFO - app.main - Cancelling 3 other background tasks...
2025-06-22 21:33:47,358 - INFO - app.main - Background task 'Task-5' cancelled successfully.
2025-06-22 21:33:47,360 - INFO - app.firebase_stream - Firebase event processing task cancelled.
2025-06-22 21:33:49,691 - INFO - app.firebase_stream - Firebase listener closed.
2025-06-22 21:33:49,691 - INFO - app.firebase_stream - Firebase Admin event processing task finished.
2025-06-22 21:33:49,691 - INFO - app.main - Background task 'Task-3' cancelled successfully.
2025-06-22 21:33:49,693 - INFO - app.main - Redis client connection closed.
2025-06-22 21:33:49,693 - INFO - app.main - Application shutdown event finished.

2025-06-25 21:31:36,570 - INFO - orders - Application starting up - Orders logging initialized
2025-06-25 21:31:38,422 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:31:38,558 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:31:41,600 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:31:41,600 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:31:41,600 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:31:43,263 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:31:43,263 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:43,263 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:31:43,266 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:31:43,266 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:43,266 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:31:43,268 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:31:43,268 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:43,268 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:31:43,470 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:31:43,470 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:31:43,470 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:31:43,830 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:31:43,841 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:31:45,776 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:31:45,776 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:45,777 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:31:45,782 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:31:45,782 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:45,782 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:31:45,786 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:31:45,786 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:45,786 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:31:46,167 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:31:46,167 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:31:46,168 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:31:48,020 - INFO - orders - Order close request received - Order ID: 5733346643, User ID: 6, Close Price: 94.558
2025-06-25 21:31:48,021 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FCF50>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:31:48,021 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:31:48,021 - INFO - orders - Request to close order 5733346643 for user 6 (DemoUser) with price 94.558. Frontend provided type: SELL, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:31:48,087 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:31:48,214 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 3
2025-06-25 21:31:48,215 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 341): Type=SELL, Qty=0.01000000, StoredMargin=6.52364158
2025-06-25 21:31:48,215 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.364158
2025-06-25 21:31:48,215 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 342): Type=BUY, Qty=0.01000000, StoredMargin=6.52297244
2025-06-25 21:31:48,215 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.297244
2025-06-25 21:31:48,216 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 343): Type=BUY, Qty=0.01000000, StoredMargin=6.52351865
2025-06-25 21:31:48,216 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.351865
2025-06-25 21:31:48,216 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.01000000, NetQty=0.02000000
2025-06-25 21:31:48,216 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.364158'), Decimal('652.297244'), Decimal('652.351865')], HighestMarginPerLot=652.364158
2025-06-25 21:31:48,216 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.05, ContributingOrders=3 (based on individual stored margins)
2025-06-25 21:31:48,216 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 2
2025-06-25 21:31:48,216 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 342): Type=BUY, Qty=0.01000000, StoredMargin=6.52297244
2025-06-25 21:31:48,217 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.297244
2025-06-25 21:31:48,217 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 343): Type=BUY, Qty=0.01000000, StoredMargin=6.52351865
2025-06-25 21:31:48,217 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.351865
2025-06-25 21:31:48,220 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000
2025-06-25 21:31:48,221 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.297244'), Decimal('652.351865')], HighestMarginPerLot=652.351865
2025-06-25 21:31:48,221 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.05, ContributingOrders=2 (based on individual stored margins)
2025-06-25 21:31:48,238 - INFO - orders - Existing entry commission for order 5733346643: 0.10000000
2025-06-25 21:31:48,238 - INFO - orders - Commission calculation for order 5733346643: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:31:48,238 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -35.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 5733346643)
2025-06-25 21:31:48,238 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:31:48,240 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:31:48,241 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:31:48,241 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:31:48,243 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.8250000000'), 'o': Decimal('144.8190000000')}
2025-06-25 21:31:48,244 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.8250000000
2025-06-25 21:31:48,244 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -35.000000000000000000000000 JPY / 144.8250000000 = -0.2416709822199205938201277404 USD
2025-06-25 21:31:48,337 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99984.75000000, margin=6.53
2025-06-25 21:31:48,338 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99984.75000000, margin=6.53
2025-06-25 21:31:48,344 - INFO - orders - User data cache updated for user 6
2025-06-25 21:31:48,344 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:31:48,344 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:31:48,373 - INFO - orders - Fetched 2 open orders for user 6
2025-06-25 21:31:48,394 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:31:48,405 - INFO - orders - Updated static orders cache for user 6 with 2 open orders and 0 pending orders
2025-06-25 21:31:48,405 - INFO - orders - Publishing order update for user 6
2025-06-25 21:31:48,409 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:31:48,415 - INFO - orders - Publishing market data trigger
2025-06-25 21:31:48,676 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:31:48,677 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:48,677 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:31:48,688 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:31:48,689 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:48,689 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:31:48,713 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:31:48,714 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:48,715 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:31:48,859 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:31:48,878 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:31:49,147 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:31:49,147 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:31:49,147 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:31:51,178 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:31:51,178 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:51,179 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:31:51,185 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:31:51,186 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:51,186 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:31:51,198 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:31:51,198 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:51,199 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:31:52,450 - INFO - orders - Order close request received - Order ID: 3584262638, User ID: 6, Close Price: 94.449
2025-06-25 21:31:52,451 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FC190>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:31:52,451 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:31:52,451 - INFO - orders - Request to close order 3584262638 for user 6 (DemoUser) with price 94.449. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:31:52,496 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:31:52,563 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 2
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 342): Type=BUY, Qty=0.01000000, StoredMargin=6.52297244
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.297244
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 343): Type=BUY, Qty=0.01000000, StoredMargin=6.52351865
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.351865
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.297244'), Decimal('652.351865')], HighestMarginPerLot=652.351865
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.05, ContributingOrders=2 (based on individual stored margins)
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 343): Type=BUY, Qty=0.01000000, StoredMargin=6.52351865
2025-06-25 21:31:52,564 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.351865
2025-06-25 21:31:52,565 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:31:52,565 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.351865')], HighestMarginPerLot=652.351865
2025-06-25 21:31:52,566 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.52, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:31:52,617 - INFO - orders - Existing entry commission for order 3584262638: 0.10000000
2025-06-25 21:31:52,617 - INFO - orders - Commission calculation for order 3584262638: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:31:52,617 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -63.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 3584262638)
2025-06-25 21:31:52,618 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:31:52,625 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:31:52,626 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:31:52,626 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:31:52,632 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.8240000000'), 'o': Decimal('144.8200000000')}
2025-06-25 21:31:52,632 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.8240000000
2025-06-25 21:31:52,632 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -63.000000000000000000000000 JPY / 144.8240000000 = -0.4350107716952991216925371485 USD
2025-06-25 21:31:52,759 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99984.11000000, margin=0
2025-06-25 21:31:52,759 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99984.11000000, margin=0
2025-06-25 21:31:52,764 - INFO - orders - User data cache updated for user 6
2025-06-25 21:31:52,764 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:31:52,764 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:31:52,783 - INFO - orders - Fetched 1 open orders for user 6
2025-06-25 21:31:52,813 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:31:52,823 - INFO - orders - Updated static orders cache for user 6 with 1 open orders and 0 pending orders
2025-06-25 21:31:52,824 - INFO - orders - Publishing order update for user 6
2025-06-25 21:31:52,831 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:31:52,840 - INFO - orders - Publishing market data trigger
2025-06-25 21:31:53,935 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:31:53,950 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:31:55,109 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:31:55,109 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:55,109 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:31:55,121 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:31:55,121 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:55,122 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:31:55,133 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:31:55,133 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:31:55,133 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:31:55,470 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:31:55,470 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:31:55,471 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:31:59,001 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:31:59,071 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:00,270 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:00,271 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:00,271 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:00,346 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:00,347 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:00,347 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:00,376 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:00,376 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:00,381 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:01,719 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:01,720 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:01,720 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:01,728 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:01,728 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:01,728 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:01,734 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:01,734 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:01,734 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:02,401 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:02,401 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:02,402 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:04,102 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:32:04,119 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:04,373 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:04,374 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:04,374 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:06,131 - INFO - orders - Order close request received - Order ID: 2870742580, User ID: 6, Close Price: 94.446
2025-06-25 21:32:06,131 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FC2D0>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:32:06,131 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:32:06,131 - INFO - orders - Request to close order 2870742580 for user 6 (DemoUser) with price 94.446. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:32:06,152 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:32:06,194 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:32:06,194 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 343): Type=BUY, Qty=0.01000000, StoredMargin=6.52351865
2025-06-25 21:32:06,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.351865
2025-06-25 21:32:06,198 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:32:06,198 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.351865')], HighestMarginPerLot=652.351865
2025-06-25 21:32:06,199 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.52, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:32:06,199 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 0
2025-06-25 21:32:06,199 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDJPY. Returning zero margin.
2025-06-25 21:32:06,217 - INFO - orders - Existing entry commission for order 2870742580: 0.10000000
2025-06-25 21:32:06,218 - INFO - orders - Commission calculation for order 2870742580: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:32:06,218 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -70.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 2870742580)
2025-06-25 21:32:06,218 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:32:06,227 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:32:06,227 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:32:06,227 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:32:06,234 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.8240000000'), 'o': Decimal('144.8200000000')}
2025-06-25 21:32:06,234 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.8240000000
2025-06-25 21:32:06,234 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -70.000000000000000000000000 JPY / 144.8240000000 = -0.4833453018836656907694857206 USD
2025-06-25 21:32:06,306 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99983.43000000, margin=0
2025-06-25 21:32:06,307 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99983.43000000, margin=0
2025-06-25 21:32:06,315 - INFO - orders - User data cache updated for user 6
2025-06-25 21:32:06,315 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:32:06,315 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:32:06,328 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:32:06,339 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:32:06,342 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 0 pending orders
2025-06-25 21:32:06,342 - INFO - orders - Publishing order update for user 6
2025-06-25 21:32:06,346 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:32:06,351 - INFO - orders - Publishing market data trigger
2025-06-25 21:32:06,432 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:06,433 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:06,433 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:06,440 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:06,441 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:06,441 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:06,451 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:06,451 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:06,451 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:06,773 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:06,773 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:06,773 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:08,603 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:08,603 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:08,603 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:08,605 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:08,605 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:08,605 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:08,610 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:08,610 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:08,610 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:09,145 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:32:09,150 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:10,702 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:10,702 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:10,702 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:10,705 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:10,706 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:10,706 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:10,709 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:10,709 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:10,709 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:10,935 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:10,935 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:10,935 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:13,074 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:13,074 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:13,075 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:13,078 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:13,078 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:13,078 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:13,082 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:13,082 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:13,082 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:13,226 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:13,226 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:13,226 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:14,168 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:32:14,172 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:15,354 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:15,355 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:15,355 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:15,358 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:15,359 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:15,359 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:15,364 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:15,364 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:15,364 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:17,773 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:17,773 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:17,773 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:17,779 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:17,779 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:17,779 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:17,785 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:17,785 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:17,785 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:18,023 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:18,023 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:18,023 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:19,194 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:32:19,200 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:19,987 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:19,987 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:19,987 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:19,992 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:19,993 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:19,993 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:19,996 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:19,996 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:19,996 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:20,339 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:20,340 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:20,340 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:22,426 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:22,426 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:22,426 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:22,430 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:22,430 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:22,430 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:22,437 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:22,437 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:22,437 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:22,729 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:22,729 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:22,729 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:24,217 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:32:24,224 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:24,613 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:24,613 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:24,613 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:24,616 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:24,617 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:24,617 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:24,620 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:24,620 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:24,620 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:24,821 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:24,822 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:24,822 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:26,918 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:26,918 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:26,918 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:26,922 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:26,922 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:26,922 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:26,925 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:26,925 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:26,925 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:29,229 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:32:29,239 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:29,246 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:29,246 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:29,247 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:29,250 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:29,250 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:29,250 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:29,254 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:29,254 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:29,254 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:29,604 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:29,604 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:29,604 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:31,456 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:31,456 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:31,456 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:31,460 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:31,460 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:31,460 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:31,465 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:31,465 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:31,465 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:31,839 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:31,839 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:31,839 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:33,891 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:33,891 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:33,891 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:33,894 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:33,894 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:33,894 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:33,898 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:33,898 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:33,899 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:34,123 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:34,123 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:34,123 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:34,534 - INFO - orders - Pending order placement request received - User ID: 6, Symbol: AUDJPY, Type: SELL_LIMIT, Quantity: 0.01
2025-06-25 21:32:34,535 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:32:34,546 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:34,561 - INFO - orders - Validating pending order price: Order type=SELL_LIMIT, Order price=94.555, Current buy price=94.5570000000, Current sell price=94.4500000000
2025-06-25 21:32:34,572 - INFO - orders - Calculated contract_value for pending order: 1000.0000000000 (contract_size: 100000.00000000 * quantity: 0.01)
2025-06-25 21:32:34,575 - INFO - orders - [DEBUG] User data from cache: {'id': 6, 'email': 'cursordemo3@gmail.com', 'group_name': 'Group B', 'leverage': Decimal('100.00'), 'user_type': 'demo', 'account_number': '0BBEF', 'wallet_balance': Decimal('99983.43000000'), 'margin': Decimal('0'), 'first_name': None, 'last_name': None, 'country': None, 'phone_number': Decimal('19741258242')}
2025-06-25 21:32:34,575 - INFO - orders - [DEBUG] Group name: Group B
2025-06-25 21:32:34,579 - INFO - orders - [DEBUG] Group settings from cache: {'sending_orders': 'barclays'}
2025-06-25 21:32:34,579 - INFO - orders - [DEBUG] sending_orders value: barclays, type: <class 'str'>
2025-06-25 21:32:34,579 - INFO - orders - [DEBUG] sending_orders_normalized: barclays
2025-06-25 21:32:34,579 - INFO - orders - User 6 is_barclays_live_user: False (user_type: demo, sending_orders_normalized: barclays)
2025-06-25 21:32:34,590 - INFO - orders - [DEBUG][pending_order] Prepared order_data_for_internal_processing: {'order_id': '9399326314', 'order_company_name': 'AUDJPY', 'order_type': 'SELL_LIMIT', 'order_quantity': Decimal('0.01'), 'order_price': Decimal('94.555'), 'user_type': 'demo', 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '4771321276', 'takeprofit_id': '4341340019', 'order_user_id': 6, 'order_status': 'PENDING', 'contract_value': Decimal('1000.0000000000'), 'margin': None, 'open_time': None}
2025-06-25 21:32:34,591 - INFO - orders - Placing PENDING order: SELL_LIMIT for user 6 at price 94.555
2025-06-25 21:32:34,631 - INFO - orders - Order 9399326314 verified in database on attempt 1 before adding to Redis.
2025-06-25 21:32:34,639 - INFO - orders - Pending order 9399326314 added to Redis for user 6 under key pending_orders:AUDJPY:SELL_LIMIT.
2025-06-25 21:32:34,639 - INFO - orders - Pending order 9399326314 added to Redis for non-Barclays user or demo user.
2025-06-25 21:32:34,645 - INFO - orders - User data cache updated for user 6 after placing pending order
2025-06-25 21:32:34,645 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:32:34,645 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:32:34,651 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:32:34,656 - INFO - orders - Fetched 1 pending orders for user 6
2025-06-25 21:32:34,659 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 1 pending orders
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.549
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.54900 >= 94.55500 = False
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.54900 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.54900' vs '94.55500'
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00600
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:32:36,104 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.54900, order_price=94.55500, should_trigger=False
2025-06-25 21:32:36,105 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:32:36,120 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:36,120 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:36,120 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:36,124 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:36,124 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:36,124 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:36,129 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:36,129 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:36,129 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:36,639 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:36,640 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:36,640 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:37,690 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9548.057256438969764837625980, margin_level=147219.5262933585479944164250, balance=10000.00000000, equity=9554.547256438969764837625980
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.549
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.54900 >= 94.55500 = False
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.54900 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.54900' vs '94.55500'
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00600
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.54900, order_price=94.55500, should_trigger=False
2025-06-25 21:32:38,406 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:32:38,420 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:38,421 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:38,421 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:38,424 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:38,424 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:38,424 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:38,427 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:38,427 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:38,428 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:39,556 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:32:39,559 - INFO - orders - Key: pending_orders:AUDJPY:SELL_LIMIT, Users: 1
2025-06-25 21:32:39,561 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:SELL_LIMIT
2025-06-25 21:32:39,561 - INFO - orders -     Order 9399326314: AUDJPY SELL_LIMIT, price=94.55500000, user_type=demo
2025-06-25 21:32:39,563 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:32:39,570 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:40,874 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:40,874 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:40,874 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:43,002 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.55
2025-06-25 21:32:43,002 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55000 >= 94.55500 = False
2025-06-25 21:32:43,003 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55000 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:32:43,003 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55000' vs '94.55500'
2025-06-25 21:32:43,003 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00500
2025-06-25 21:32:43,003 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:43,003 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:32:43,003 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55000, order_price=94.55500, should_trigger=False
2025-06-25 21:32:43,003 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:32:43,021 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:43,022 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:43,022 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:43,025 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:43,025 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:43,025 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:43,030 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:43,030 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:43,031 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:44,582 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:32:44,583 - INFO - orders - Key: pending_orders:AUDJPY:SELL_LIMIT, Users: 1
2025-06-25 21:32:44,584 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:SELL_LIMIT
2025-06-25 21:32:44,585 - INFO - orders -     Order 9399326314: AUDJPY SELL_LIMIT, price=94.55500000, user_type=demo
2025-06-25 21:32:44,586 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:32:44,591 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:45,637 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:45,637 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:45,637 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:48,246 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:48,247 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:48,247 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:49,595 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:32:49,599 - INFO - orders - Key: pending_orders:AUDJPY:SELL_LIMIT, Users: 1
2025-06-25 21:32:49,602 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:SELL_LIMIT
2025-06-25 21:32:49,602 - INFO - orders -     Order 9399326314: AUDJPY SELL_LIMIT, price=94.55500000, user_type=demo
2025-06-25 21:32:49,605 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:32:49,617 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:50,034 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:50,034 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:50,034 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.551
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55100 >= 94.55500 = False
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55100 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55100' vs '94.55500'
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00400
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55100, order_price=94.55500, should_trigger=False
2025-06-25 21:32:52,013 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:32:52,024 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:52,024 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:52,024 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:52,027 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:52,027 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:52,027 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:52,029 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:52,030 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:52,030 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:52,398 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:52,398 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:52,398 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:53,791 - INFO - orders - Pending order placement request received - User ID: 6, Symbol: AUDJPY, Type: BUY_LIMIT, Quantity: 0.01
2025-06-25 21:32:53,854 - INFO - orders - Validating pending order price: Order type=BUY_LIMIT, Order price=94.549, Current buy price=94.5510000000, Current sell price=94.4440000000
2025-06-25 21:32:53,863 - INFO - orders - Calculated contract_value for pending order: 1000.0000000000 (contract_size: 100000.00000000 * quantity: 0.01)
2025-06-25 21:32:53,866 - INFO - orders - [DEBUG] User data from cache: {'id': 6, 'email': 'cursordemo3@gmail.com', 'group_name': 'Group B', 'leverage': Decimal('100.00'), 'user_type': 'demo', 'account_number': '0BBEF', 'wallet_balance': Decimal('99983.43000000'), 'margin': Decimal('0E-8'), 'first_name': None, 'last_name': None, 'country': None, 'phone_number': Decimal('19741258242')}
2025-06-25 21:32:53,866 - INFO - orders - [DEBUG] Group name: Group B
2025-06-25 21:32:53,869 - INFO - orders - [DEBUG] Group settings from cache: {'sending_orders': 'barclays'}
2025-06-25 21:32:53,869 - INFO - orders - [DEBUG] sending_orders value: barclays, type: <class 'str'>
2025-06-25 21:32:53,869 - INFO - orders - [DEBUG] sending_orders_normalized: barclays
2025-06-25 21:32:53,869 - INFO - orders - User 6 is_barclays_live_user: False (user_type: demo, sending_orders_normalized: barclays)
2025-06-25 21:32:53,876 - INFO - orders - [DEBUG][pending_order] Prepared order_data_for_internal_processing: {'order_id': '7052766578', 'order_company_name': 'AUDJPY', 'order_type': 'BUY_LIMIT', 'order_quantity': Decimal('0.01'), 'order_price': Decimal('94.549'), 'user_type': 'demo', 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '3924588669', 'takeprofit_id': '8132423442', 'order_user_id': 6, 'order_status': 'PENDING', 'contract_value': Decimal('1000.0000000000'), 'margin': None, 'open_time': None}
2025-06-25 21:32:53,877 - INFO - orders - Placing PENDING order: BUY_LIMIT for user 6 at price 94.549
2025-06-25 21:32:53,928 - INFO - orders - Order 7052766578 verified in database on attempt 1 before adding to Redis.
2025-06-25 21:32:53,940 - INFO - orders - Pending order 7052766578 added to Redis for user 6 under key pending_orders:AUDJPY:BUY_LIMIT.
2025-06-25 21:32:53,940 - INFO - orders - Pending order 7052766578 added to Redis for non-Barclays user or demo user.
2025-06-25 21:32:53,952 - INFO - orders - User data cache updated for user 6 after placing pending order
2025-06-25 21:32:53,952 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:32:53,952 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:32:53,960 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:32:53,968 - INFO - orders - Fetched 2 pending orders for user 6
2025-06-25 21:32:53,973 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 2 pending orders
2025-06-25 21:32:54,472 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.551
2025-06-25 21:32:54,472 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55100 <= 94.54900 = False
2025-06-25 21:32:54,472 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55100 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:32:54,472 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55100' vs '94.54900'
2025-06-25 21:32:54,472 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00200
2025-06-25 21:32:54,472 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:54,473 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:32:54,473 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55100, order_price=94.54900, should_trigger=False
2025-06-25 21:32:54,473 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:32:54,474 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.551
2025-06-25 21:32:54,474 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55100 >= 94.55500 = False
2025-06-25 21:32:54,474 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55100 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:32:54,474 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55100' vs '94.55500'
2025-06-25 21:32:54,474 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00400
2025-06-25 21:32:54,474 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:54,475 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:32:54,475 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55100, order_price=94.55500, should_trigger=False
2025-06-25 21:32:54,475 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:32:54,488 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:54,488 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:54,488 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:54,491 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:54,492 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:54,492 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:54,495 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:54,495 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:54,495 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:54,625 - INFO - orders - Found 2 pending order keys in Redis
2025-06-25 21:32:54,628 - INFO - orders - Key: pending_orders:AUDJPY:SELL_LIMIT, Users: 1
2025-06-25 21:32:54,629 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:SELL_LIMIT
2025-06-25 21:32:54,629 - INFO - orders -     Order 9399326314: AUDJPY SELL_LIMIT, price=94.55500000, user_type=demo
2025-06-25 21:32:54,634 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:32:54,636 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:32:54,640 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:32:54,640 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:32:54,643 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:32:54,650 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:32:56,606 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.551
2025-06-25 21:32:56,606 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55100 <= 94.54900 = False
2025-06-25 21:32:56,606 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55100 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:32:56,607 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55100' vs '94.54900'
2025-06-25 21:32:56,607 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00200
2025-06-25 21:32:56,607 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:56,607 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:32:56,607 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55100, order_price=94.54900, should_trigger=False
2025-06-25 21:32:56,607 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.551
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55100 >= 94.55500 = False
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55100 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55100' vs '94.55500'
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00400
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55100, order_price=94.55500, should_trigger=False
2025-06-25 21:32:56,610 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:32:56,624 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:32:56,625 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:56,625 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:32:56,628 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:32:56,628 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:56,628 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:32:56,632 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:32:56,632 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:32:56,632 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:32:56,860 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:56,860 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:56,860 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:59,153 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:32:59,153 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:32:59,153 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:32:59,669 - INFO - orders - Found 2 pending order keys in Redis
2025-06-25 21:32:59,671 - INFO - orders - Key: pending_orders:AUDJPY:SELL_LIMIT, Users: 1
2025-06-25 21:32:59,673 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:SELL_LIMIT
2025-06-25 21:32:59,673 - INFO - orders -     Order 9399326314: AUDJPY SELL_LIMIT, price=94.55500000, user_type=demo
2025-06-25 21:32:59,674 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:32:59,676 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:32:59,678 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:32:59,678 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:32:59,680 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:32:59,686 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:00,568 - INFO - orders - Pending order placement request received - User ID: 6, Symbol: AUDJPY, Type: SELL_LIMIT, Quantity: 0.01
2025-06-25 21:33:00,583 - INFO - orders - Validating pending order price: Order type=SELL_LIMIT, Order price=94.552, Current buy price=94.5510000000, Current sell price=94.4450000000
2025-06-25 21:33:00,595 - INFO - orders - Calculated contract_value for pending order: 1000.0000000000 (contract_size: 100000.00000000 * quantity: 0.01)
2025-06-25 21:33:00,600 - INFO - orders - [DEBUG] User data from cache: {'id': 6, 'email': 'cursordemo3@gmail.com', 'group_name': 'Group B', 'leverage': Decimal('100.00'), 'user_type': 'demo', 'account_number': '0BBEF', 'wallet_balance': Decimal('99983.43000000'), 'margin': Decimal('0E-8'), 'first_name': None, 'last_name': None, 'country': None, 'phone_number': Decimal('19741258242')}
2025-06-25 21:33:00,600 - INFO - orders - [DEBUG] Group name: Group B
2025-06-25 21:33:00,607 - INFO - orders - [DEBUG] Group settings from cache: {'sending_orders': 'barclays'}
2025-06-25 21:33:00,607 - INFO - orders - [DEBUG] sending_orders value: barclays, type: <class 'str'>
2025-06-25 21:33:00,607 - INFO - orders - [DEBUG] sending_orders_normalized: barclays
2025-06-25 21:33:00,607 - INFO - orders - User 6 is_barclays_live_user: False (user_type: demo, sending_orders_normalized: barclays)
2025-06-25 21:33:00,620 - INFO - orders - [DEBUG][pending_order] Prepared order_data_for_internal_processing: {'order_id': '2497138509', 'order_company_name': 'AUDJPY', 'order_type': 'SELL_LIMIT', 'order_quantity': Decimal('0.01'), 'order_price': Decimal('94.552'), 'user_type': 'demo', 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '8279717741', 'takeprofit_id': '6529450634', 'order_user_id': 6, 'order_status': 'PENDING', 'contract_value': Decimal('1000.0000000000'), 'margin': None, 'open_time': None}
2025-06-25 21:33:00,621 - INFO - orders - Placing PENDING order: SELL_LIMIT for user 6 at price 94.552
2025-06-25 21:33:00,677 - INFO - orders - Order 2497138509 verified in database on attempt 1 before adding to Redis.
2025-06-25 21:33:00,691 - INFO - orders - Pending order 2497138509 added to Redis for user 6 under key pending_orders:AUDJPY:SELL_LIMIT.
2025-06-25 21:33:00,691 - INFO - orders - Pending order 2497138509 added to Redis for non-Barclays user or demo user.
2025-06-25 21:33:00,703 - INFO - orders - User data cache updated for user 6 after placing pending order
2025-06-25 21:33:00,704 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:33:00,704 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:33:00,711 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:33:00,719 - INFO - orders - Fetched 3 pending orders for user 6
2025-06-25 21:33:00,724 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 3 pending orders
2025-06-25 21:33:01,308 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.554
2025-06-25 21:33:01,308 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55400 <= 94.54900 = False
2025-06-25 21:33:01,308 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55400 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:01,309 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55400' vs '94.54900'
2025-06-25 21:33:01,309 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00500
2025-06-25 21:33:01,309 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:01,309 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:01,309 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55400, order_price=94.54900, should_trigger=False
2025-06-25 21:33:01,309 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.554
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55400 >= 94.55500 = False
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55400 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55400' vs '94.55500'
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00100
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55400, order_price=94.55500, should_trigger=False
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55200000, adjusted_buy_price: 94.554
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55400 >= 94.55200 = True
2025-06-25 21:33:01,313 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55400 (<class 'decimal.Decimal'>), order_price_normalized: 94.55200 (<class 'decimal.Decimal'>)
2025-06-25 21:33:01,314 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55400' vs '94.55200'
2025-06-25 21:33:01,314 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00200
2025-06-25 21:33:01,314 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:01,314 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: True
2025-06-25 21:33:01,314 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 2497138509: type=SELL_LIMIT, adjusted_buy_price=94.55400, order_price=94.55200, should_trigger=True
2025-06-25 21:33:01,314 - INFO - orders - [PENDING_ORDER_EXECUTION] Trigger condition met for order 2497138509. Executing trigger_pending_order.
2025-06-25 21:33:01,314 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting trigger_pending_order for order 2497138509, user 6, symbol AUDJPY, type SELL_LIMIT
2025-06-25 21:33:01,328 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] User data loaded for user 6: group=Group B, wallet_balance=99983.43000000
2025-06-25 21:33:01,349 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Group settings loaded for group Group B
2025-06-25 21:33:01,355 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order 2497138509 found on attempt 1
2025-06-25 21:33:01,356 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order loaded: status=PENDING, price=94.55200000
2025-06-25 21:33:01,363 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Adjusted prices loaded: {'buy': Decimal('94.5540000000'), 'sell': Decimal('94.4470000000'), 'spread_value': Decimal('0.10000000')}
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Normalized prices for comparison - order_price: 94.55200, adjusted_buy_price: 94.55400, adjusted_sell_price: 94.44700
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] SELL_LIMIT/BUY_STOP check: 94.55400 >= 94.55200 = True
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Checking order 2497138509: type=SELL_LIMIT, adjusted_buy_price=94.55400, order_price=94.55200, should_trigger=True
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Price comparison values - adjusted_buy_price_normalized: 94.55400 (<class 'decimal.Decimal'>), order_price_normalized: 94.55200 (<class 'decimal.Decimal'>)
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw price values - adjusted_buy_price: 94.5540000000 (<class 'decimal.Decimal'>), order_price: 94.55200000 (<class 'decimal.Decimal'>)
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] String comparison for prices: '94.55400' vs '94.55200'
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Absolute price difference: 0.00200
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:01,364 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] SELL_LIMIT/BUY_STOP with epsilon: True
2025-06-25 21:33:01,371 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] External symbol info loaded: {'contract_size': Decimal('100000.00000000'), 'profit_currency': 'JPY', 'digit': Decimal('3.00000')}
2025-06-25 21:33:01,371 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw market data loaded: {'b': '94.5040000000', 'o': '94.4970000000'}
2025-06-25 21:33:01,371 - INFO - orders - [MARGIN_CALC] Starting margin calculation for AUDJPY SELL_LIMIT order, quantity: 0.01000000
2025-06-25 21:33:01,371 - INFO - orders - [MARGIN_CALC] No group_name in settings, fetching for user 6
2025-06-25 21:33:01,379 - INFO - orders - [MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:33:01,383 - INFO - orders - [MARGIN_CALC] Got SELL price for AUDJPY from cache: 94.5040000000
2025-06-25 21:33:01,383 - INFO - orders - [MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:33:01,383 - INFO - orders - [MARGIN_CALC] Contract value = contract_size * quantity = 100000.00000000 * 0.01000000 = 1000.0000000000000000
2025-06-25 21:33:01,389 - INFO - orders - [MARGIN_CALC] Using default leverage: 100
2025-06-25 21:33:01,389 - INFO - orders - [MARGIN_CALC] Margin calculation: (contract_value * price) / effective_leverage = (1000.0000000000000000 * 94.5040000000) / 100 = 945.04000000000000000000000 (rounded to 945.04)
2025-06-25 21:33:01,389 - INFO - orders - [MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:33:01,389 - INFO - orders - [MARGIN_CALC] Per lot commission: 0.01000000 * 10.0000 = 0.100000000000
2025-06-25 21:33:01,389 - INFO - orders - [MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:33:01,389 - INFO - orders - [MARGIN_CALC] Converting margin from JPY to USD: 945.04 JPY
2025-06-25 21:33:01,389 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 945.04 JPY to USD for margin for AUDJPY SELL_LIMIT order (user_id: 6, position: )
2025-06-25 21:33:01,389 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:33:01,393 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:33:01,393 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:33:01,393 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:33:01,397 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.8200000000'), 'o': Decimal('144.8150000000')}
2025-06-25 21:33:01,397 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.8200000000
2025-06-25 21:33:01,397 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 945.04 JPY / 144.8200000000 = 6.525618008562353266123463610 USD
2025-06-25 21:33:01,397 - INFO - orders - [MARGIN_CALC] Margin after USD conversion: 945.04 JPY -> 6.525618008562353266123463610 USD
2025-06-25 21:33:01,397 - INFO - orders - [MARGIN_CALC] Final results for AUDJPY SELL_LIMIT: margin=6.525618008562353266123463610, price=94.5040000000, contract_value=1000.0000000000000000, commission=0.10
2025-06-25 21:33:01,397 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin calculated successfully for order 2497138509: margin=6.525618008562353266123463610, exec_price=94.5040000000, contract_value=1000.0000000000000000
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 0
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDJPY. Returning zero margin.
2025-06-25 21:33:01,403 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Current symbol margin contribution (before): 0.0
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: None): Type=SELL, Qty=0.01000000, StoredMargin=6.525618008562353266123463610
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.561800856235326612346361
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.561800856235326612346361')], HighestMarginPerLot=652.561800856235326612346361
2025-06-25 21:33:01,403 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.53, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:33:01,403 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Symbol margin contribution after adding order: 6.53
2025-06-25 21:33:01,403 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin change required: 6.53 (Before: 0.0, After: 6.53)
2025-06-25 21:33:01,408 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Latest free_margin for user 6: 99983.43000000
2025-06-25 21:33:01,408 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Executing order 2497138509 for user 6 at price 94.55400 (order_price=94.55200, type=SELL_LIMIT)
2025-06-25 21:33:01,408 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Contract value calculated: 1000.0000000000000000
2025-06-25 21:33:01,409 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with calculated values: margin=6.525618008562353266123463610 (was None), contract_value=1000.0000000000000000, commission=0.10, execution_price=94.5040000000
2025-06-25 21:33:01,409 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Note: Order margin stored is the individual margin requirement (6.525618008562353266123463610), while margin change applied to user (6.53) considers total symbol margin effect
2025-06-25 21:33:01,409 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with new values and cleared SL/TP
2025-06-25 21:33:01,425 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fresh user data loaded: wallet_balance=99983.43000000, current_margin=0E-8
2025-06-25 21:33:01,425 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin check: current_margin=0E-8, new_margin=6.53000000, wallet_balance=99983.43000000
2025-06-25 21:33:01,426 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Using margin with hedging applied: 6.53. Adding to current total margin: 0E-8
2025-06-25 21:33:01,450 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] User margin updated successfully for user 6: 6.53000000 (includes hedging adjustments)
2025-06-25 21:33:01,458 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated user data cache with new margin value: 6.53000000
2025-06-25 21:33:01,462 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published user data update notification for user 6
2025-06-25 21:33:01,463 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Pending order 2497138509 for user 6 opened successfully. New total margin: 6.53000000
2025-06-25 21:33:01,480 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Order 2497138509 status updated to OPEN in database
2025-06-25 21:33:01,480 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting portfolio update for user 6
2025-06-25 21:33:01,493 - WARNING - orders - No price data found for commision_type
2025-06-25 21:33:01,494 - WARNING - orders - No price data found for commision_value_type
2025-06-25 21:33:01,496 - WARNING - orders - No price data found for type
2025-06-25 21:33:01,500 - WARNING - orders - No price data found for pip_currency
2025-06-25 21:33:01,502 - WARNING - orders - No price data found for show_points
2025-06-25 21:33:01,504 - WARNING - orders - No price data found for swap_buy
2025-06-25 21:33:01,508 - WARNING - orders - No price data found for swap_sell
2025-06-25 21:33:01,510 - WARNING - orders - No price data found for commision
2025-06-25 21:33:01,512 - WARNING - orders - No price data found for margin
2025-06-25 21:33:01,514 - WARNING - orders - No price data found for spread
2025-06-25 21:33:01,516 - WARNING - orders - No price data found for deviation
2025-06-25 21:33:01,517 - WARNING - orders - No price data found for min_lot
2025-06-25 21:33:01,519 - WARNING - orders - No price data found for max_lot
2025-06-25 21:33:01,520 - WARNING - orders - No price data found for pips
2025-06-25 21:33:01,521 - WARNING - orders - No price data found for spread_pip
2025-06-25 21:33:01,523 - WARNING - orders - No price data found for contract_size
2025-06-25 21:33:01,524 - WARNING - orders - No price data found for profit_currency
2025-06-25 21:33:01,524 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fetched market prices for 0 symbols
2025-06-25 21:33:01,838 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Portfolio cache updated and websocket event published for user 6
2025-06-25 21:33:01,838 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully processed triggered pending order 2497138509 for user 6. Status set to OPEN. Order Type changed from SELL_LIMIT to SELL.
2025-06-25 21:33:01,841 - INFO - orders - Pending order 2497138509 removed from Redis for symbol AUDJPY type SELL_LIMIT and user 6.
2025-06-25 21:33:01,841 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully removed order 2497138509 from Redis pending orders
2025-06-25 21:33:01,843 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published order execution notification for order 2497138509 to channel user:6:notifications
2025-06-25 21:33:01,863 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:01,864 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:01,864 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:01,869 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:01,869 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:01,869 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:01,874 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:01,875 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:01,875 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:02,137 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:02,137 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:02,137 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:03,701 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:03,701 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:03,701 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:04,702 - INFO - orders - Found 2 pending order keys in Redis
2025-06-25 21:33:04,706 - INFO - orders - Key: pending_orders:AUDJPY:SELL_LIMIT, Users: 1
2025-06-25 21:33:04,710 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:SELL_LIMIT
2025-06-25 21:33:04,710 - INFO - orders -     Order 9399326314: AUDJPY SELL_LIMIT, price=94.55500000, user_type=demo
2025-06-25 21:33:04,714 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:04,718 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:04,722 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:04,722 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:04,726 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:04,737 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:09,748 - INFO - orders - Found 2 pending order keys in Redis
2025-06-25 21:33:09,752 - INFO - orders - Key: pending_orders:AUDJPY:SELL_LIMIT, Users: 1
2025-06-25 21:33:09,754 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:SELL_LIMIT
2025-06-25 21:33:09,755 - INFO - orders -     Order 9399326314: AUDJPY SELL_LIMIT, price=94.55500000, user_type=demo
2025-06-25 21:33:09,757 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:09,760 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:09,763 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:09,763 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:09,765 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:09,771 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:10,594 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.55
2025-06-25 21:33:10,594 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55000 <= 94.54900 = False
2025-06-25 21:33:10,594 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55000 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:10,594 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55000' vs '94.54900'
2025-06-25 21:33:10,594 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00100
2025-06-25 21:33:10,594 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:10,594 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:10,595 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55000, order_price=94.54900, should_trigger=False
2025-06-25 21:33:10,595 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:10,600 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.55
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55000 >= 94.55500 = False
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55000 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55000' vs '94.55500'
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00500
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: False
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55000, order_price=94.55500, should_trigger=False
2025-06-25 21:33:10,601 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 9399326314 conditions not met for execution. Skipping.
2025-06-25 21:33:10,622 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:10,622 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:10,622 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:10,626 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:10,626 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:10,626 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:10,631 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:10,631 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:10,631 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:10,926 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:10,927 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:10,927 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:12,943 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.555
2025-06-25 21:33:12,943 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55500 <= 94.54900 = False
2025-06-25 21:33:12,943 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55500 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:12,944 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55500' vs '94.54900'
2025-06-25 21:33:12,944 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00600
2025-06-25 21:33:12,944 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:12,944 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:12,944 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55500, order_price=94.54900, should_trigger=False
2025-06-25 21:33:12,944 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.55500000, adjusted_buy_price: 94.555
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP check: 94.55500 >= 94.55500 = True
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55500 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55500' vs '94.55500'
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00000
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: True (epsilon=0.00001)
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] SELL_LIMIT/BUY_STOP with epsilon: True
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55500, order_price=94.55500, should_trigger=True
2025-06-25 21:33:12,949 - INFO - orders - [PENDING_ORDER_EXECUTION] Trigger condition met for order 9399326314. Executing trigger_pending_order.
2025-06-25 21:33:12,950 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting trigger_pending_order for order 9399326314, user 6, symbol AUDJPY, type SELL_LIMIT
2025-06-25 21:33:12,952 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] User data loaded for user 6: group=Group B, wallet_balance=99983.43000000
2025-06-25 21:33:12,957 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Group settings loaded for group Group B
2025-06-25 21:33:12,964 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order 9399326314 found on attempt 1
2025-06-25 21:33:12,964 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order loaded: status=PENDING, price=94.55500000
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Adjusted prices loaded: {'buy': Decimal('94.5550000000'), 'sell': Decimal('94.4470000000'), 'spread_value': Decimal('0.10000000')}
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Normalized prices for comparison - order_price: 94.55500, adjusted_buy_price: 94.55500, adjusted_sell_price: 94.44700
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] SELL_LIMIT/BUY_STOP check: 94.55500 >= 94.55500 = True
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Checking order 9399326314: type=SELL_LIMIT, adjusted_buy_price=94.55500, order_price=94.55500, should_trigger=True
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Price comparison values - adjusted_buy_price_normalized: 94.55500 (<class 'decimal.Decimal'>), order_price_normalized: 94.55500 (<class 'decimal.Decimal'>)
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw price values - adjusted_buy_price: 94.5550000000 (<class 'decimal.Decimal'>), order_price: 94.55500000 (<class 'decimal.Decimal'>)
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] String comparison for prices: '94.55500' vs '94.55500'
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Absolute price difference: 0.00000
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Prices within epsilon tolerance: True (epsilon=0.00001)
2025-06-25 21:33:12,971 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] SELL_LIMIT/BUY_STOP with epsilon: True
2025-06-25 21:33:12,978 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] External symbol info loaded: {'contract_size': Decimal('100000.00000000'), 'profit_currency': 'JPY', 'digit': Decimal('3.00000')}
2025-06-25 21:33:12,978 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw market data loaded: {'b': '94.5050000000', 'o': '94.4970000000'}
2025-06-25 21:33:12,978 - INFO - orders - [MARGIN_CALC] Starting margin calculation for AUDJPY SELL_LIMIT order, quantity: 0.01000000
2025-06-25 21:33:12,979 - INFO - orders - [MARGIN_CALC] No group_name in settings, fetching for user 6
2025-06-25 21:33:12,985 - INFO - orders - [MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:33:12,990 - INFO - orders - [MARGIN_CALC] Got SELL price for AUDJPY from cache: 94.5050000000
2025-06-25 21:33:12,990 - INFO - orders - [MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:33:12,990 - INFO - orders - [MARGIN_CALC] Contract value = contract_size * quantity = 100000.00000000 * 0.01000000 = 1000.0000000000000000
2025-06-25 21:33:12,995 - INFO - orders - [MARGIN_CALC] Using default leverage: 100
2025-06-25 21:33:12,995 - INFO - orders - [MARGIN_CALC] Margin calculation: (contract_value * price) / effective_leverage = (1000.0000000000000000 * 94.5050000000) / 100 = 945.05000000000000000000000 (rounded to 945.05)
2025-06-25 21:33:12,995 - INFO - orders - [MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:33:12,995 - INFO - orders - [MARGIN_CALC] Per lot commission: 0.01000000 * 10.0000 = 0.100000000000
2025-06-25 21:33:12,996 - INFO - orders - [MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:33:12,996 - INFO - orders - [MARGIN_CALC] Converting margin from JPY to USD: 945.05 JPY
2025-06-25 21:33:12,996 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 945.05 JPY to USD for margin for AUDJPY SELL_LIMIT order (user_id: 6, position: )
2025-06-25 21:33:12,996 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:33:12,999 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:33:12,999 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:33:12,999 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:33:13,002 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.8210000000'), 'o': Decimal('144.8150000000')}
2025-06-25 21:33:13,002 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.8210000000
2025-06-25 21:33:13,002 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 945.05 JPY / 144.8210000000 = 6.525641999433783774452600106 USD
2025-06-25 21:33:13,002 - INFO - orders - [MARGIN_CALC] Margin after USD conversion: 945.05 JPY -> 6.525641999433783774452600106 USD
2025-06-25 21:33:13,002 - INFO - orders - [MARGIN_CALC] Final results for AUDJPY SELL_LIMIT: margin=6.525641999433783774452600106, price=94.5050000000, contract_value=1000.0000000000000000, commission=0.10
2025-06-25 21:33:13,002 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin calculated successfully for order 9399326314: margin=6.525641999433783774452600106, exec_price=94.5050000000, contract_value=1000.0000000000000000
2025-06-25 21:33:13,008 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:33:13,008 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.561801
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.01000000, NetQty=0.01000000
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.561801')], HighestMarginPerLot=652.561801
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.53, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:33:13,009 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Current symbol margin contribution (before): 6.53
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 2
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.561801
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: None): Type=SELL, Qty=0.01000000, StoredMargin=6.525641999433783774452600106
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.5641999433783774452600106
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.02000000, NetQty=0.02000000
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.561801'), Decimal('652.5641999433783774452600106')], HighestMarginPerLot=652.5641999433783774452600106
2025-06-25 21:33:13,009 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.05, ContributingOrders=2 (based on individual stored margins)
2025-06-25 21:33:13,009 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Symbol margin contribution after adding order: 13.05
2025-06-25 21:33:13,009 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin change required: 6.52 (Before: 6.53, After: 13.05)
2025-06-25 21:33:13,012 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Latest free_margin for user 6: 99976.48236431432122634995166
2025-06-25 21:33:13,013 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Executing order 9399326314 for user 6 at price 94.55500 (order_price=94.55500, type=SELL_LIMIT)
2025-06-25 21:33:13,013 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Contract value calculated: 1000.0000000000000000
2025-06-25 21:33:13,013 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with calculated values: margin=6.525641999433783774452600106 (was None), contract_value=1000.0000000000000000, commission=0.10, execution_price=94.5050000000
2025-06-25 21:33:13,013 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Note: Order margin stored is the individual margin requirement (6.525641999433783774452600106), while margin change applied to user (6.52) considers total symbol margin effect
2025-06-25 21:33:13,013 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with new values and cleared SL/TP
2025-06-25 21:33:13,025 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fresh user data loaded: wallet_balance=99983.43000000, current_margin=6.53000000
2025-06-25 21:33:13,026 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin check: current_margin=6.53000000, new_margin=13.05000000, wallet_balance=99983.43000000
2025-06-25 21:33:13,026 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Using margin with hedging applied: 6.52. Adding to current total margin: 6.53000000
2025-06-25 21:33:13,055 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] User margin updated successfully for user 6: 13.05000000 (includes hedging adjustments)
2025-06-25 21:33:13,067 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated user data cache with new margin value: 13.05000000
2025-06-25 21:33:13,071 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published user data update notification for user 6
2025-06-25 21:33:13,071 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Pending order 9399326314 for user 6 opened successfully. New total margin: 13.05000000
2025-06-25 21:33:13,090 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Order 9399326314 status updated to OPEN in database
2025-06-25 21:33:13,090 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting portfolio update for user 6
2025-06-25 21:33:13,102 - WARNING - orders - No price data found for commision_type
2025-06-25 21:33:13,104 - WARNING - orders - No price data found for commision_value_type
2025-06-25 21:33:13,107 - WARNING - orders - No price data found for type
2025-06-25 21:33:13,110 - WARNING - orders - No price data found for pip_currency
2025-06-25 21:33:13,112 - WARNING - orders - No price data found for show_points
2025-06-25 21:33:13,115 - WARNING - orders - No price data found for swap_buy
2025-06-25 21:33:13,117 - WARNING - orders - No price data found for swap_sell
2025-06-25 21:33:13,119 - WARNING - orders - No price data found for commision
2025-06-25 21:33:13,120 - WARNING - orders - No price data found for margin
2025-06-25 21:33:13,122 - WARNING - orders - No price data found for spread
2025-06-25 21:33:13,125 - WARNING - orders - No price data found for deviation
2025-06-25 21:33:13,128 - WARNING - orders - No price data found for min_lot
2025-06-25 21:33:13,131 - WARNING - orders - No price data found for max_lot
2025-06-25 21:33:13,133 - WARNING - orders - No price data found for pips
2025-06-25 21:33:13,134 - WARNING - orders - No price data found for spread_pip
2025-06-25 21:33:13,135 - WARNING - orders - No price data found for contract_size
2025-06-25 21:33:13,136 - WARNING - orders - No price data found for profit_currency
2025-06-25 21:33:13,136 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fetched market prices for 0 symbols
2025-06-25 21:33:13,436 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Portfolio cache updated and websocket event published for user 6
2025-06-25 21:33:13,437 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully processed triggered pending order 9399326314 for user 6. Status set to OPEN. Order Type changed from SELL_LIMIT to SELL.
2025-06-25 21:33:13,443 - INFO - orders - Pending order 9399326314 removed from Redis for symbol AUDJPY type SELL_LIMIT and user 6.
2025-06-25 21:33:13,443 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully removed order 9399326314 from Redis pending orders
2025-06-25 21:33:13,445 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published order execution notification for order 9399326314 to channel user:6:notifications
2025-06-25 21:33:13,468 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:13,468 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:13,468 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:13,475 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:13,475 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:13,475 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:13,482 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:13,482 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:13,482 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:14,784 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:33:14,792 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:14,797 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:14,797 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:14,800 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:14,812 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:17,509 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.553
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55300 <= 94.54900 = False
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55300 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55300' vs '94.54900'
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00400
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55300, order_price=94.54900, should_trigger=False
2025-06-25 21:33:17,510 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:17,529 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:17,529 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:17,529 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:17,533 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:17,533 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:17,533 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:17,537 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:17,537 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:17,537 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:18,016 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:18,017 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:18,017 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:19,802 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.554
2025-06-25 21:33:19,802 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55400 <= 94.54900 = False
2025-06-25 21:33:19,803 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55400 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:19,803 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55400' vs '94.54900'
2025-06-25 21:33:19,803 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00500
2025-06-25 21:33:19,803 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:19,803 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:19,803 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55400, order_price=94.54900, should_trigger=False
2025-06-25 21:33:19,803 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:19,817 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:19,817 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:19,818 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:19,819 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:33:19,820 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:19,820 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:19,820 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:19,823 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:19,825 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:19,825 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:19,825 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:19,825 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:19,825 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:19,827 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:19,836 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:20,043 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:20,044 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:20,044 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:21,856 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.555
2025-06-25 21:33:21,856 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55500 <= 94.54900 = False
2025-06-25 21:33:21,857 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55500 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:21,857 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55500' vs '94.54900'
2025-06-25 21:33:21,857 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00600
2025-06-25 21:33:21,857 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:21,857 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:21,857 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55500, order_price=94.54900, should_trigger=False
2025-06-25 21:33:21,857 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:21,873 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:21,873 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:21,873 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:21,877 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:21,878 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:21,878 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:21,882 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:21,883 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:21,883 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:22,102 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:22,102 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:22,102 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.553
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55300 <= 94.54900 = False
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55300 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55300' vs '94.54900'
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00400
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55300, order_price=94.54900, should_trigger=False
2025-06-25 21:33:24,244 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:24,265 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:24,265 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:24,266 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:24,269 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:24,269 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:24,269 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:24,274 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:24,274 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:24,274 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:24,880 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:33:24,884 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:24,889 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:24,890 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:24,895 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:24,904 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.553
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55300 <= 94.54900 = False
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55300 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55300' vs '94.54900'
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00400
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55300, order_price=94.54900, should_trigger=False
2025-06-25 21:33:26,560 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:26,575 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:26,576 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:26,576 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:26,580 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:26,580 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:26,580 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:26,585 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:26,585 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:26,585 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:29,922 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:33:29,925 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:29,928 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:29,928 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:29,930 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:29,938 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.552
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55200 <= 94.54900 = False
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55200 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55200' vs '94.54900'
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00300
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55200, order_price=94.54900, should_trigger=False
2025-06-25 21:33:31,114 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:31,133 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:31,134 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:31,134 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:31,139 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:31,139 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:31,139 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:31,142 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:31,143 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:31,143 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:31,334 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:31,334 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:31,334 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.551
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55100 <= 94.54900 = False
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55100 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55100' vs '94.54900'
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00200
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55100, order_price=94.54900, should_trigger=False
2025-06-25 21:33:33,400 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:33,414 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:33,414 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:33,414 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:33,417 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:33,417 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:33,417 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:33,420 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:33,421 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:33,421 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:33,611 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:33,611 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:33,611 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:34,952 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:33:34,957 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:34,959 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:34,959 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:34,962 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:34,970 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:35,686 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.551
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55100 <= 94.54900 = False
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55100 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55100' vs '94.54900'
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00200
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55100, order_price=94.54900, should_trigger=False
2025-06-25 21:33:35,687 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:35,700 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:35,700 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:35,700 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:35,703 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:35,703 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:35,703 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:35,706 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:35,706 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:35,706 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:35,867 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:35,867 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:35,867 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:37,233 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9548.059976358161411542194460, margin_level=147219.5682027451681285392059, balance=10000.00000000, equity=9554.549976358161411542194460
2025-06-25 21:33:37,711 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=6, user_type=demo, group_name=Group B, free_margin=99969.53779246338381222680284, margin_level=766150.0980265393395572935084, balance=99983.43000000, equity=99982.58779246338381222680284
2025-06-25 21:33:38,007 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.553
2025-06-25 21:33:38,007 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.55300 <= 94.54900 = False
2025-06-25 21:33:38,007 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.55300 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:38,007 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.55300' vs '94.54900'
2025-06-25 21:33:38,007 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00400
2025-06-25 21:33:38,007 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:38,007 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:33:38,008 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.55300, order_price=94.54900, should_trigger=False
2025-06-25 21:33:38,008 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 7052766578 conditions not met for execution. Skipping.
2025-06-25 21:33:38,023 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:38,024 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:38,024 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:38,027 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:38,027 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:38,027 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:38,030 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:38,030 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:38,030 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:38,318 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:38,319 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:38,319 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:39,975 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:33:39,977 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:33:39,979 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:33:39,979 - INFO - orders -     Order 7052766578: AUDJPY BUY_LIMIT, price=94.54900000, user_type=demo
2025-06-25 21:33:39,981 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:33:39,985 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:40,332 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.54900000, adjusted_buy_price: 94.548
2025-06-25 21:33:40,332 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.54800 <= 94.54900 = True
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.54800 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.54800' vs '94.54900'
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00100
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: True
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.54800, order_price=94.54900, should_trigger=True
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION] Trigger condition met for order 7052766578. Executing trigger_pending_order.
2025-06-25 21:33:40,333 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting trigger_pending_order for order 7052766578, user 6, symbol AUDJPY, type BUY_LIMIT
2025-06-25 21:33:40,359 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] User data loaded for user 6: group=Group B, wallet_balance=99983.43000000
2025-06-25 21:33:40,365 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Group settings loaded for group Group B
2025-06-25 21:33:40,371 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order 7052766578 found on attempt 1
2025-06-25 21:33:40,371 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order loaded: status=PENDING, price=94.54900000
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Adjusted prices loaded: {'buy': Decimal('94.5480000000'), 'sell': Decimal('94.4420000000'), 'spread_value': Decimal('0.10000000')}
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Normalized prices for comparison - order_price: 94.54900, adjusted_buy_price: 94.54800, adjusted_sell_price: 94.44200
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] BUY_LIMIT/SELL_STOP check: 94.54800 <= 94.54900 = True
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Checking order 7052766578: type=BUY_LIMIT, adjusted_buy_price=94.54800, order_price=94.54900, should_trigger=True
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Price comparison values - adjusted_buy_price_normalized: 94.54800 (<class 'decimal.Decimal'>), order_price_normalized: 94.54900 (<class 'decimal.Decimal'>)
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw price values - adjusted_buy_price: 94.5480000000 (<class 'decimal.Decimal'>), order_price: 94.54900000 (<class 'decimal.Decimal'>)
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] String comparison for prices: '94.54800' vs '94.54900'
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Absolute price difference: 0.00100
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:33:40,377 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] BUY_LIMIT/SELL_STOP with epsilon: True
2025-06-25 21:33:40,380 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] External symbol info loaded: {'contract_size': Decimal('100000.00000000'), 'profit_currency': 'JPY', 'digit': Decimal('3.00000')}
2025-06-25 21:33:40,380 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw market data loaded: {'b': '94.4980000000', 'o': '94.4920000000'}
2025-06-25 21:33:40,381 - INFO - orders - [MARGIN_CALC] Starting margin calculation for AUDJPY BUY_LIMIT order, quantity: 0.01000000
2025-06-25 21:33:40,381 - INFO - orders - [MARGIN_CALC] No group_name in settings, fetching for user 6
2025-06-25 21:33:40,385 - INFO - orders - [MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:33:40,392 - INFO - orders - [MARGIN_CALC] Got BUY price for AUDJPY from cache: 94.4920000000
2025-06-25 21:33:40,392 - INFO - orders - [MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:33:40,392 - INFO - orders - [MARGIN_CALC] Contract value = contract_size * quantity = 100000.00000000 * 0.01000000 = 1000.0000000000000000
2025-06-25 21:33:40,396 - INFO - orders - [MARGIN_CALC] Using default leverage: 100
2025-06-25 21:33:40,397 - INFO - orders - [MARGIN_CALC] Margin calculation: (contract_value * price) / effective_leverage = (1000.0000000000000000 * 94.4920000000) / 100 = 944.92000000000000000000000 (rounded to 944.92)
2025-06-25 21:33:40,397 - INFO - orders - [MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:33:40,397 - INFO - orders - [MARGIN_CALC] Per lot commission: 0.01000000 * 10.0000 = 0.100000000000
2025-06-25 21:33:40,397 - INFO - orders - [MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:33:40,397 - INFO - orders - [MARGIN_CALC] Converting margin from JPY to USD: 944.92 JPY
2025-06-25 21:33:40,397 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 944.92 JPY to USD for margin for AUDJPY BUY_LIMIT order (user_id: 6, position: )
2025-06-25 21:33:40,397 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:33:40,431 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:33:40,432 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:33:40,432 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:33:40,435 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.8130000000'), 'o': Decimal('144.8070000000')}
2025-06-25 21:33:40,435 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.8130000000
2025-06-25 21:33:40,435 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 944.92 JPY / 144.8130000000 = 6.525104790315786566123207171 USD
2025-06-25 21:33:40,435 - INFO - orders - [MARGIN_CALC] Margin after USD conversion: 944.92 JPY -> 6.525104790315786566123207171 USD
2025-06-25 21:33:40,435 - INFO - orders - [MARGIN_CALC] Final results for AUDJPY BUY_LIMIT: margin=6.525104790315786566123207171, price=94.4920000000, contract_value=1000.0000000000000000, commission=0.10
2025-06-25 21:33:40,435 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin calculated successfully for order 7052766578: margin=6.525104790315786566123207171, exec_price=94.4920000000, contract_value=1000.0000000000000000
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 2
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.561801
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0, TotalSellQty=0.02000000, NetQty=0.02000000
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.561801')], HighestMarginPerLot=652.5642
2025-06-25 21:33:40,439 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.05, ContributingOrders=2 (based on individual stored margins)
2025-06-25 21:33:40,439 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Current symbol margin contribution (before): 13.05
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 3
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.561801
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: None): Type=BUY, Qty=0.01000000, StoredMargin=6.525104790315786566123207171
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.5104790315786566123207171
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.02000000, NetQty=0.02000000
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.561801'), Decimal('652.5104790315786566123207171')], HighestMarginPerLot=652.5642
2025-06-25 21:33:40,440 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.05, ContributingOrders=3 (based on individual stored margins)
2025-06-25 21:33:40,440 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Symbol margin contribution after adding order: 13.05
2025-06-25 21:33:40,440 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin change required: 0.0 (Before: 13.05, After: 13.05)
2025-06-25 21:33:40,442 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Latest free_margin for user 6: 99969.51017063385193318279436
2025-06-25 21:33:40,442 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Executing order 7052766578 for user 6 at price 94.54800 (order_price=94.54900, type=BUY_LIMIT)
2025-06-25 21:33:40,442 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Contract value calculated: 1000.0000000000000000
2025-06-25 21:33:40,442 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with calculated values: margin=6.525104790315786566123207171 (was None), contract_value=1000.0000000000000000, commission=0.10, execution_price=94.4920000000
2025-06-25 21:33:40,442 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Note: Order margin stored is the individual margin requirement (6.525104790315786566123207171), while margin change applied to user (0.0) considers total symbol margin effect
2025-06-25 21:33:40,442 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with new values and cleared SL/TP
2025-06-25 21:33:40,449 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fresh user data loaded: wallet_balance=99983.43000000, current_margin=13.05000000
2025-06-25 21:33:40,449 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Perfect hedging detected: order 7052766578 requires no additional margin. Keeping current margin of 13.05000000
2025-06-25 21:33:40,449 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] No margin update needed for user 6 - margin remains at 13.05000000
2025-06-25 21:33:40,458 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated user data cache with new margin value: 13.05000000
2025-06-25 21:33:40,463 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published user data update notification for user 6
2025-06-25 21:33:40,464 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Pending order 7052766578 for user 6 opened successfully. New total margin: 13.05000000
2025-06-25 21:33:40,487 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Order 7052766578 status updated to OPEN in database
2025-06-25 21:33:40,487 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting portfolio update for user 6
2025-06-25 21:33:40,506 - WARNING - orders - No price data found for commision_type
2025-06-25 21:33:40,510 - WARNING - orders - No price data found for commision_value_type
2025-06-25 21:33:40,515 - WARNING - orders - No price data found for type
2025-06-25 21:33:40,519 - WARNING - orders - No price data found for pip_currency
2025-06-25 21:33:40,523 - WARNING - orders - No price data found for show_points
2025-06-25 21:33:40,527 - WARNING - orders - No price data found for swap_buy
2025-06-25 21:33:40,530 - WARNING - orders - No price data found for swap_sell
2025-06-25 21:33:40,534 - WARNING - orders - No price data found for commision
2025-06-25 21:33:40,536 - WARNING - orders - No price data found for margin
2025-06-25 21:33:40,540 - WARNING - orders - No price data found for spread
2025-06-25 21:33:40,543 - WARNING - orders - No price data found for deviation
2025-06-25 21:33:40,545 - WARNING - orders - No price data found for min_lot
2025-06-25 21:33:40,547 - WARNING - orders - No price data found for max_lot
2025-06-25 21:33:40,548 - WARNING - orders - No price data found for pips
2025-06-25 21:33:40,549 - WARNING - orders - No price data found for spread_pip
2025-06-25 21:33:40,551 - WARNING - orders - No price data found for contract_size
2025-06-25 21:33:40,553 - WARNING - orders - No price data found for profit_currency
2025-06-25 21:33:40,553 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fetched market prices for 0 symbols
2025-06-25 21:33:40,852 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Portfolio cache updated and websocket event published for user 6
2025-06-25 21:33:40,852 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully processed triggered pending order 7052766578 for user 6. Status set to OPEN. Order Type changed from BUY_LIMIT to BUY.
2025-06-25 21:33:40,856 - INFO - orders - Pending order 7052766578 removed from Redis for symbol AUDJPY type BUY_LIMIT and user 6.
2025-06-25 21:33:40,856 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully removed order 7052766578 from Redis pending orders
2025-06-25 21:33:40,857 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published order execution notification for order 7052766578 to channel user:6:notifications
2025-06-25 21:33:40,878 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:40,878 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:40,878 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:40,882 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:40,883 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:40,883 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:40,886 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:40,886 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:40,886 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:42,834 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:42,834 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:42,834 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:42,838 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:42,838 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:42,838 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:42,844 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:42,844 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:42,844 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:43,234 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:43,235 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:43,235 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:44,995 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:44,995 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:44,995 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:44,998 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:33:45,001 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:45,001 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:45,001 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:45,006 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:45,006 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:45,006 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:45,007 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:45,359 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:45,359 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:45,359 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:47,333 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:47,334 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:47,334 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:47,342 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:47,342 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:47,342 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:47,350 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:47,351 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:47,351 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:47,872 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:47,872 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:47,872 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:49,351 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:49,351 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:49,351 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:49,354 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:49,354 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:49,354 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:49,357 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:49,357 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:49,357 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:50,023 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:33:50,029 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:52,732 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:52,733 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:52,733 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:52,738 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:52,738 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:52,738 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:52,743 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:52,743 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:52,743 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:54,851 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:54,851 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:54,851 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:54,856 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:54,856 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:54,856 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:54,861 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:54,861 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:54,861 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:55,035 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:33:55,049 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:33:55,166 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:55,167 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:55,167 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:57,325 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:33:57,325 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:57,325 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:33:57,332 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:33:57,332 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:57,332 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:33:57,339 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:33:57,339 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:33:57,339 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:33:57,713 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:57,713 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:57,713 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:33:59,737 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:33:59,738 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:33:59,738 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:00,235 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:00,243 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:01,740 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:01,740 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:01,740 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:01,742 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:01,742 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:01,742 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:01,745 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:01,745 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:01,745 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:01,995 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:01,996 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:01,996 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:03,963 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:03,963 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:03,963 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:03,966 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:03,966 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:03,967 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:03,969 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:03,970 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:03,970 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:04,230 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:04,231 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:04,231 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:05,114 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDJPY, Type: BUY, Quantity: 0.01
2025-06-25 21:34:05,123 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:34:05,123 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:34:05,123 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:34:05,527 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDJPY BUY order, quantity: 0.01
2025-06-25 21:34:05,527 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:34:05,531 - INFO - orders - [ORDER_MARGIN_CALC] Got BUY price for AUDJPY from cache: 94.5210000000
2025-06-25 21:34:05,534 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:34:05,534 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:34:05,534 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 94.5210000000) / 100.00 = 945.210000000000000000 (rounded to 945.21)
2025-06-25 21:34:05,534 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:34:05,535 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:34:05,535 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:34:05,535 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from JPY to USD: 945.21 JPY
2025-06-25 21:34:05,535 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 945.21 JPY to USD for margin for AUDJPY BUY order (user_id: 6, position: )
2025-06-25 21:34:05,535 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:05,536 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:05,545 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:05,549 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:05,549 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:05,580 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7950000000'), 'o': Decimal('144.7900000000')}
2025-06-25 21:34:05,580 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7950000000
2025-06-25 21:34:05,581 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 945.21 JPY / 144.7950000000 = 6.527918781725888324873096447 USD
2025-06-25 21:34:05,582 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 945.21 JPY -> 6.527918781725888324873096447 USD
2025-06-25 21:34:05,582 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDJPY BUY: margin=6.527918781725888324873096447, price=94.5210000000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:34:05,582 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDJPY: Calculated commission=0.10
2025-06-25 21:34:05,591 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:05,598 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 3
2025-06-25 21:34:05,599 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:05,599 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:05,599 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:05,599 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:05,600 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:05,600 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:05,600 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0.02000000, NetQty=0.02000000
2025-06-25 21:34:05,600 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801')], HighestMarginPerLot=652.5642
2025-06-25 21:34:05,600 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.05, ContributingOrders=3 (based on individual stored margins)
2025-06-25 21:34:05,600 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 4
2025-06-25 21:34:05,601 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:05,601 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:05,601 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:05,601 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:05,602 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:05,602 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:05,603 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: None): Type=BUY, Qty=0.01, StoredMargin=6.527918781725888324873096447
2025-06-25 21:34:05,603 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.7918781725888324873096447
2025-06-25 21:34:05,603 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000
2025-06-25 21:34:05,604 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.7918781725888324873096447')], HighestMarginPerLot=652.7918781725888324873096447
2025-06-25 21:34:05,604 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.06, ContributingOrders=4 (based on individual stored margins)
2025-06-25 21:34:05,604 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDJPY: MarginBefore=13.05, MarginAfter=13.06, AdditionalMargin=0.01
2025-06-25 21:34:05,604 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDJPY
2025-06-25 21:34:05,604 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.527918781725888324873096447
2025-06-25 21:34:05,604 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 3
2025-06-25 21:34:05,604 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 13.05
2025-06-25 21:34:05,604 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 13.06
2025-06-25 21:34:05,605 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 0.01
2025-06-25 21:34:05,612 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=13.05000000, CalculatedNewMargin=13.06
2025-06-25 21:34:05,653 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '3992087759', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDJPY', 'order_type': 'BUY', 'order_price': Decimal('94.5210000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.527918781725888324873096447'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:34:05,680 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 13.06000000
2025-06-25 21:34:05,782 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:34:06,356 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:34:06,361 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:06,361 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:06,386 - INFO - orders - Fetched 4 open orders for user 6
2025-06-25 21:34:06,412 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:06,424 - INFO - orders - Updated static orders cache for user 6 with 4 open orders and 0 pending orders
2025-06-25 21:34:06,715 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:06,716 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:06,716 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:06,723 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:06,723 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:06,724 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:06,739 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:06,739 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:06,739 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:07,043 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:07,043 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:07,044 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:08,649 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:08,649 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:08,649 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:08,659 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:08,659 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:08,659 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:08,666 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:08,667 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:08,667 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:09,031 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:09,031 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:09,031 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:10,626 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:10,643 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:14,015 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:14,015 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:14,015 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:15,392 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDJPY, Type: SELL, Quantity: 0.01
2025-06-25 21:34:15,399 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:34:15,399 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:34:15,399 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:34:15,767 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDJPY SELL order, quantity: 0.01
2025-06-25 21:34:15,767 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:34:15,771 - INFO - orders - [ORDER_MARGIN_CALC] Got SELL price for AUDJPY from cache: 94.4150000000
2025-06-25 21:34:15,772 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:34:15,772 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:34:15,772 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 94.4150000000) / 100.00 = 944.150000000000000000 (rounded to 944.15)
2025-06-25 21:34:15,772 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:34:15,773 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:34:15,773 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:34:15,773 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from JPY to USD: 944.15 JPY
2025-06-25 21:34:15,773 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 944.15 JPY to USD for margin for AUDJPY SELL order (user_id: 6, position: )
2025-06-25 21:34:15,773 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:15,777 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:15,810 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:15,812 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:15,813 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:15,818 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:15,823 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7950000000'), 'o': Decimal('144.7910000000')}
2025-06-25 21:34:15,823 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7950000000
2025-06-25 21:34:15,823 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 944.15 JPY / 144.7950000000 = 6.520598086950516247107980248 USD
2025-06-25 21:34:15,824 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 944.15 JPY -> 6.520598086950516247107980248 USD
2025-06-25 21:34:15,824 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDJPY SELL: margin=6.520598086950516247107980248, price=94.4150000000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:34:15,825 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDJPY: Calculated commission=0.10
2025-06-25 21:34:15,838 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 4
2025-06-25 21:34:15,839 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:15,839 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:15,839 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:15,839 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:15,839 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:15,839 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:15,840 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:15,840 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:15,840 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.02000000, NetQty=0.02000000
2025-06-25 21:34:15,840 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878')], HighestMarginPerLot=652.791878
2025-06-25 21:34:15,840 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.06, ContributingOrders=4 (based on individual stored margins)
2025-06-25 21:34:15,841 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 5
2025-06-25 21:34:15,841 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:15,841 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:15,841 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:15,841 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:15,841 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:15,841 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:15,842 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:15,842 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:15,842 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: None): Type=SELL, Qty=0.01, StoredMargin=6.520598086950516247107980248
2025-06-25 21:34:15,842 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.0598086950516247107980248
2025-06-25 21:34:15,842 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.03000000, NetQty=0.03000000
2025-06-25 21:34:15,842 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.0598086950516247107980248')], HighestMarginPerLot=652.791878
2025-06-25 21:34:15,842 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=5 (based on individual stored margins)
2025-06-25 21:34:15,842 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDJPY: MarginBefore=13.06, MarginAfter=19.58, AdditionalMargin=6.52
2025-06-25 21:34:15,842 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDJPY
2025-06-25 21:34:15,842 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.520598086950516247107980248
2025-06-25 21:34:15,843 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 4
2025-06-25 21:34:15,843 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 13.06
2025-06-25 21:34:15,843 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 19.58
2025-06-25 21:34:15,843 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 6.52
2025-06-25 21:34:15,855 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=13.06000000, CalculatedNewMargin=19.58
2025-06-25 21:34:15,889 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '7479623692', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDJPY', 'order_type': 'SELL', 'order_price': Decimal('94.4150000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.520598086950516247107980248'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:34:15,925 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 19.58000000
2025-06-25 21:34:15,949 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:34:16,682 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:34:16,709 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:16,709 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:16,730 - INFO - orders - Fetched 5 open orders for user 6
2025-06-25 21:34:16,756 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:16,764 - INFO - orders - Updated static orders cache for user 6 with 5 open orders and 0 pending orders
2025-06-25 21:34:16,985 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:16,986 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:16,986 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:19,796 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDJPY, Type: SELL, Quantity: 0.01
2025-06-25 21:34:19,803 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:34:19,803 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:34:19,803 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:34:20,115 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDJPY SELL order, quantity: 0.01
2025-06-25 21:34:20,115 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:34:20,120 - INFO - orders - [ORDER_MARGIN_CALC] Got SELL price for AUDJPY from cache: 94.4150000000
2025-06-25 21:34:20,120 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:34:20,121 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:34:20,121 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 94.4150000000) / 100.00 = 944.150000000000000000 (rounded to 944.15)
2025-06-25 21:34:20,121 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:34:20,121 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:34:20,121 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:34:20,121 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from JPY to USD: 944.15 JPY
2025-06-25 21:34:20,121 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 944.15 JPY to USD for margin for AUDJPY SELL order (user_id: 6, position: )
2025-06-25 21:34:20,121 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:20,123 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:20,123 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:20,124 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:20,128 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7910000000')}
2025-06-25 21:34:20,128 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:20,128 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 944.15 JPY / 144.7940000000 = 6.520643120571294390651546335 USD
2025-06-25 21:34:20,129 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 944.15 JPY -> 6.520643120571294390651546335 USD
2025-06-25 21:34:20,129 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDJPY SELL: margin=6.520643120571294390651546335, price=94.4150000000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:34:20,129 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDJPY: Calculated commission=0.10
2025-06-25 21:34:20,136 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 5
2025-06-25 21:34:20,137 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:20,137 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:20,137 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:20,137 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:20,138 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:20,138 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:20,141 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:20,141 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:20,141 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:20,141 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:20,141 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.03000000, NetQty=0.03000000
2025-06-25 21:34:20,141 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809')], HighestMarginPerLot=652.791878
2025-06-25 21:34:20,142 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=5 (based on individual stored margins)
2025-06-25 21:34:20,142 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 6
2025-06-25 21:34:20,142 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:20,142 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:20,144 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:20,144 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:20,144 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:20,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: None): Type=SELL, Qty=0.01, StoredMargin=6.520643120571294390651546335
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.0643120571294390651546335
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.04000000, NetQty=0.04000000
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.0643120571294390651546335')], HighestMarginPerLot=652.791878
2025-06-25 21:34:20,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=6 (based on individual stored margins)
2025-06-25 21:34:20,147 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDJPY: MarginBefore=19.58, MarginAfter=26.11, AdditionalMargin=6.53
2025-06-25 21:34:20,147 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDJPY
2025-06-25 21:34:20,147 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.520643120571294390651546335
2025-06-25 21:34:20,147 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 5
2025-06-25 21:34:20,147 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 19.58
2025-06-25 21:34:20,147 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 26.11
2025-06-25 21:34:20,147 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 6.53
2025-06-25 21:34:20,165 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=19.58000000, CalculatedNewMargin=26.11
2025-06-25 21:34:20,200 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '6250064077', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDJPY', 'order_type': 'SELL', 'order_price': Decimal('94.4150000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.520643120571294390651546335'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:34:20,262 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 26.11000000
2025-06-25 21:34:20,307 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:34:21,073 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:21,114 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:34:21,128 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:21,133 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:21,133 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:21,142 - INFO - orders - Fetched 6 open orders for user 6
2025-06-25 21:34:21,159 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:21,167 - INFO - orders - Updated static orders cache for user 6 with 6 open orders and 0 pending orders
2025-06-25 21:34:21,203 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:21,204 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:21,204 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:23,049 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDJPY, Type: BUY, Quantity: 0.01
2025-06-25 21:34:23,064 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:34:23,064 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:34:23,064 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:34:23,076 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:23,076 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:23,076 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:23,386 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDJPY BUY order, quantity: 0.01
2025-06-25 21:34:23,386 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:34:23,389 - INFO - orders - [ORDER_MARGIN_CALC] Got BUY price for AUDJPY from cache: 94.5210000000
2025-06-25 21:34:23,389 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:34:23,389 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:34:23,389 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 94.5210000000) / 100.00 = 945.210000000000000000 (rounded to 945.21)
2025-06-25 21:34:23,389 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:34:23,389 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:34:23,389 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:34:23,390 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from JPY to USD: 945.21 JPY
2025-06-25 21:34:23,390 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 945.21 JPY to USD for margin for AUDJPY BUY order (user_id: 6, position: )
2025-06-25 21:34:23,390 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:23,392 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:23,392 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:23,392 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:23,396 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7950000000'), 'o': Decimal('144.7910000000')}
2025-06-25 21:34:23,396 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7950000000
2025-06-25 21:34:23,396 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 945.21 JPY / 144.7950000000 = 6.527918781725888324873096447 USD
2025-06-25 21:34:23,396 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 945.21 JPY -> 6.527918781725888324873096447 USD
2025-06-25 21:34:23,397 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDJPY BUY: margin=6.527918781725888324873096447, price=94.5210000000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:34:23,397 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDJPY: Calculated commission=0.10
2025-06-25 21:34:23,408 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 6
2025-06-25 21:34:23,408 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:23,409 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.064312
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0.04000000, NetQty=0.04000000
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312')], HighestMarginPerLot=652.791878
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=6 (based on individual stored margins)
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 7
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:23,410 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.064312
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: None): Type=BUY, Qty=0.01, StoredMargin=6.527918781725888324873096447
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.7918781725888324873096447
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0.04000000, NetQty=0.04000000
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.7918781725888324873096447')], HighestMarginPerLot=652.7918781725888324873096447
2025-06-25 21:34:23,411 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=7 (based on individual stored margins)
2025-06-25 21:34:23,412 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDJPY: MarginBefore=26.11, MarginAfter=26.11, AdditionalMargin=0.00
2025-06-25 21:34:23,412 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDJPY
2025-06-25 21:34:23,412 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.527918781725888324873096447
2025-06-25 21:34:23,412 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 6
2025-06-25 21:34:23,412 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 26.11
2025-06-25 21:34:23,412 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 26.11
2025-06-25 21:34:23,412 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 0.0
2025-06-25 21:34:23,431 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=26.11000000, CalculatedNewMargin=26.11
2025-06-25 21:34:23,497 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '2751300651', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDJPY', 'order_type': 'BUY', 'order_price': Decimal('94.5210000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.527918781725888324873096447'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:34:23,555 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 26.11000000
2025-06-25 21:34:23,886 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:34:24,345 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:34:24,348 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:24,348 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:24,356 - INFO - orders - Fetched 7 open orders for user 6
2025-06-25 21:34:24,388 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:24,396 - INFO - orders - Updated static orders cache for user 6 with 7 open orders and 0 pending orders
2025-06-25 21:34:25,246 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:25,247 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:25,247 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:25,263 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:25,263 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:25,263 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:25,271 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:25,271 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:25,271 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:26,135 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:26,149 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:27,029 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDJPY, Type: BUY, Quantity: 0.01
2025-06-25 21:34:27,041 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:34:27,041 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:34:27,041 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:34:27,415 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDJPY BUY order, quantity: 0.01
2025-06-25 21:34:27,415 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:34:27,418 - INFO - orders - [ORDER_MARGIN_CALC] Got BUY price for AUDJPY from cache: 94.5220000000
2025-06-25 21:34:27,418 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:34:27,418 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:34:27,418 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 94.5220000000) / 100.00 = 945.220000000000000000 (rounded to 945.22)
2025-06-25 21:34:27,419 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:34:27,419 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:34:27,419 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:34:27,419 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from JPY to USD: 945.22 JPY
2025-06-25 21:34:27,419 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 945.22 JPY to USD for margin for AUDJPY BUY order (user_id: 6, position: )
2025-06-25 21:34:27,419 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:27,422 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:27,422 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:27,422 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:27,427 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7950000000'), 'o': Decimal('144.7900000000')}
2025-06-25 21:34:27,427 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7950000000
2025-06-25 21:34:27,428 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 945.22 JPY / 144.7950000000 = 6.527987844884146552021823958 USD
2025-06-25 21:34:27,428 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 945.22 JPY -> 6.527987844884146552021823958 USD
2025-06-25 21:34:27,428 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDJPY BUY: margin=6.527987844884146552021823958, price=94.5220000000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:34:27,428 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDJPY: Calculated commission=0.10
2025-06-25 21:34:27,446 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 7
2025-06-25 21:34:27,450 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:27,451 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:27,451 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:27,452 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:27,452 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:27,452 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:27,452 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:27,452 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:27,453 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:27,453 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:27,453 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:27,453 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.064312
2025-06-25 21:34:27,453 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:27,454 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.791878
2025-06-25 21:34:27,454 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0.04000000, NetQty=0.04000000
2025-06-25 21:34:27,455 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878')], HighestMarginPerLot=652.791878
2025-06-25 21:34:27,455 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=7 (based on individual stored margins)
2025-06-25 21:34:27,455 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 8
2025-06-25 21:34:27,455 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:27,456 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:27,457 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.064312
2025-06-25 21:34:27,457 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:27,457 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.791878
2025-06-25 21:34:27,457 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8 (ID: None): Type=BUY, Qty=0.01, StoredMargin=6.527987844884146552021823958
2025-06-25 21:34:27,457 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8: MarginPerLot=652.7987844884146552021823958
2025-06-25 21:34:27,457 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.04000000, TotalSellQty=0.04000000, NetQty=0.04000000
2025-06-25 21:34:27,457 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.7987844884146552021823958')], HighestMarginPerLot=652.7987844884146552021823958
2025-06-25 21:34:27,458 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=8 (based on individual stored margins)
2025-06-25 21:34:27,458 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDJPY: MarginBefore=26.11, MarginAfter=26.11, AdditionalMargin=0.00
2025-06-25 21:34:27,458 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDJPY
2025-06-25 21:34:27,458 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.527987844884146552021823958
2025-06-25 21:34:27,458 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 7
2025-06-25 21:34:27,458 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 26.11
2025-06-25 21:34:27,458 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 26.11
2025-06-25 21:34:27,458 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 0.0
2025-06-25 21:34:27,466 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=26.11000000, CalculatedNewMargin=26.11
2025-06-25 21:34:27,505 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '6873160663', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDJPY', 'order_type': 'BUY', 'order_price': Decimal('94.5220000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.527987844884146552021823958'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:34:27,550 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 26.11000000
2025-06-25 21:34:27,594 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:34:28,522 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:34:28,529 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:28,529 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:28,828 - INFO - orders - Fetched 8 open orders for user 6
2025-06-25 21:34:28,837 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:28,843 - INFO - orders - Updated static orders cache for user 6 with 8 open orders and 0 pending orders
2025-06-25 21:34:30,277 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:30,278 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:30,279 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:31,163 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:31,172 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:31,878 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:31,878 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:31,878 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:31,886 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:31,886 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:31,886 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:31,895 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:31,896 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:31,897 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:32,354 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:32,354 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:32,355 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:33,194 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDJPY, Type: BUY, Quantity: 0.01
2025-06-25 21:34:33,200 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:34:33,200 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:34:33,201 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:34:33,584 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDJPY BUY order, quantity: 0.01
2025-06-25 21:34:33,584 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:34:33,586 - INFO - orders - [ORDER_MARGIN_CALC] Got BUY price for AUDJPY from cache: 94.5210000000
2025-06-25 21:34:33,586 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:34:33,586 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:34:33,586 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 94.5210000000) / 100.00 = 945.210000000000000000 (rounded to 945.21)
2025-06-25 21:34:33,587 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:34:33,587 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:34:33,587 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:34:33,587 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from JPY to USD: 945.21 JPY
2025-06-25 21:34:33,587 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 945.21 JPY to USD for margin for AUDJPY BUY order (user_id: 6, position: )
2025-06-25 21:34:33,587 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:33,588 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:33,589 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:33,589 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:33,591 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7910000000')}
2025-06-25 21:34:33,591 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:33,591 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 945.21 JPY / 144.7940000000 = 6.527963865906045830628340953 USD
2025-06-25 21:34:33,591 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 945.21 JPY -> 6.527963865906045830628340953 USD
2025-06-25 21:34:33,591 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDJPY BUY: margin=6.527963865906045830628340953, price=94.5210000000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:34:33,591 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDJPY: Calculated commission=0.10
2025-06-25 21:34:33,602 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 8
2025-06-25 21:34:33,603 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:33,603 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:33,603 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:33,603 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:33,604 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:33,604 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:33,604 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.064312
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.791878
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8: MarginPerLot=652.798784
2025-06-25 21:34:33,605 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.04000000, TotalSellQty=0.04000000, NetQty=0.04000000
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784')], HighestMarginPerLot=652.798784
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=8 (based on individual stored margins)
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 9
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:33,606 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.064312
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.791878
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8: MarginPerLot=652.798784
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 9 (ID: None): Type=BUY, Qty=0.01, StoredMargin=6.527963865906045830628340953
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 9: MarginPerLot=652.7963865906045830628340953
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.05000000, TotalSellQty=0.04000000, NetQty=0.05000000
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.7963865906045830628340953')], HighestMarginPerLot=652.798784
2025-06-25 21:34:33,607 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=32.64, ContributingOrders=9 (based on individual stored margins)
2025-06-25 21:34:33,607 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDJPY: MarginBefore=26.11, MarginAfter=32.64, AdditionalMargin=6.53
2025-06-25 21:34:33,607 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDJPY
2025-06-25 21:34:33,608 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.527963865906045830628340953
2025-06-25 21:34:33,608 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 8
2025-06-25 21:34:33,608 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 26.11
2025-06-25 21:34:33,608 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 32.64
2025-06-25 21:34:33,608 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 6.53
2025-06-25 21:34:33,623 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=26.11000000, CalculatedNewMargin=32.64
2025-06-25 21:34:33,671 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '6093605334', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDJPY', 'order_type': 'BUY', 'order_price': Decimal('94.5210000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.527963865906045830628340953'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:34:33,759 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 32.64000000
2025-06-25 21:34:33,795 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:34:34,517 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:34:34,530 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:34,530 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:34,541 - INFO - orders - Fetched 9 open orders for user 6
2025-06-25 21:34:34,555 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:34,564 - INFO - orders - Updated static orders cache for user 6 with 9 open orders and 0 pending orders
2025-06-25 21:34:35,336 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:35,336 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:35,337 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:36,251 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:36,264 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:36,884 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:36,884 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:36,884 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:36,891 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:36,891 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:36,891 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:36,898 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:36,898 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:36,899 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:37,385 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:37,386 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:37,386 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:37,904 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9547.917559260872270266907236, margin_level=147217.3737944664448423252271, balance=10000.00000000, equity=9554.407559260872270266907236
2025-06-25 21:34:38,896 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:38,896 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:38,896 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:38,903 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:38,904 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:38,904 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:38,913 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:38,914 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:38,914 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:39,338 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=6, user_type=demo, group_name=Group B, free_margin=99944.66184670529652676579669, margin_level=306303.0081087784820060226614, balance=99983.43000000, equity=99977.30184670529652676579669
2025-06-25 21:34:40,093 - INFO - orders - Order close request received - Order ID: 9399326314, User ID: 6, Close Price: 94.52
2025-06-25 21:34:40,093 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB53FD7D90>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:40,093 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:40,093 - INFO - orders - Request to close order 9399326314 for user 6 (DemoUser) with price 94.52. Frontend provided type: SELL, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:40,110 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:40,144 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 9
2025-06-25 21:34:40,144 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 344): Type=SELL, Qty=0.01000000, StoredMargin=6.52564200
2025-06-25 21:34:40,144 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.5642
2025-06-25 21:34:40,144 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:40,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.510479
2025-06-25 21:34:40,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:40,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.561801
2025-06-25 21:34:40,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:40,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:40,145 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.059809
2025-06-25 21:34:40,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:40,146 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.064312
2025-06-25 21:34:40,149 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,149 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.791878
2025-06-25 21:34:40,149 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:40,150 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8: MarginPerLot=652.798784
2025-06-25 21:34:40,150 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 9 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:40,150 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 9: MarginPerLot=652.796387
2025-06-25 21:34:40,150 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.05000000, TotalSellQty=0.04000000, NetQty=0.05000000
2025-06-25 21:34:40,150 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.5642'), Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:40,150 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=32.64, ContributingOrders=9 (based on individual stored margins)
2025-06-25 21:34:40,150 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 8
2025-06-25 21:34:40,151 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:40,151 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.510479
2025-06-25 21:34:40,151 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:40,151 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.561801
2025-06-25 21:34:40,151 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.791878
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.059809
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.064312
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.791878
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:40,152 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.798784
2025-06-25 21:34:40,153 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:40,153 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8: MarginPerLot=652.796387
2025-06-25 21:34:40,153 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.05000000, TotalSellQty=0.03000000, NetQty=0.05000000
2025-06-25 21:34:40,153 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:40,153 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=32.64, ContributingOrders=8 (based on individual stored margins)
2025-06-25 21:34:40,167 - INFO - orders - Existing entry commission for order 9399326314: 0.10000000
2025-06-25 21:34:40,168 - INFO - orders - Commission calculation for order 9399326314: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:40,168 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -15.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 9399326314)
2025-06-25 21:34:40,168 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:40,171 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:40,172 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:40,172 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:40,177 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7930000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:40,177 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7930000000
2025-06-25 21:34:40,177 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -15.000000000000000000000000 JPY / 144.7930000000 = -0.1035961683230542912986125020 USD
2025-06-25 21:34:40,242 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99983.13000000, margin=32.64
2025-06-25 21:34:40,242 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99983.13000000, margin=32.64
2025-06-25 21:34:40,248 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:40,248 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:40,248 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:40,258 - INFO - orders - Fetched 8 open orders for user 6
2025-06-25 21:34:40,272 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:40,279 - INFO - orders - Updated static orders cache for user 6 with 8 open orders and 0 pending orders
2025-06-25 21:34:40,279 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:40,298 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:40,312 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:40,858 - INFO - orders - Order close request received - Order ID: 7052766578, User ID: 6, Close Price: 94.413
2025-06-25 21:34:40,858 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FEFD0>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:40,859 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:40,859 - INFO - orders - Request to close order 7052766578 for user 6 (DemoUser) with price 94.413. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:40,883 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:40,920 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 8
2025-06-25 21:34:40,920 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 345): Type=BUY, Qty=0.01000000, StoredMargin=6.52510479
2025-06-25 21:34:40,920 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.510479
2025-06-25 21:34:40,921 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:40,921 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.561801
2025-06-25 21:34:40,921 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,921 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.791878
2025-06-25 21:34:40,921 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:40,922 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.059809
2025-06-25 21:34:40,922 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:40,922 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.064312
2025-06-25 21:34:40,922 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,922 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.791878
2025-06-25 21:34:40,922 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:40,922 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.798784
2025-06-25 21:34:40,923 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:40,926 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 8: MarginPerLot=652.796387
2025-06-25 21:34:40,926 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.05000000, TotalSellQty=0.03000000, NetQty=0.05000000
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.510479'), Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=32.64, ContributingOrders=8 (based on individual stored margins)
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 7
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.561801
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.791878
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:40,927 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.059809
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.064312
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.791878
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.798784
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.796387
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.04000000, TotalSellQty=0.03000000, NetQty=0.04000000
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:40,928 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=7 (based on individual stored margins)
2025-06-25 21:34:40,949 - INFO - orders - Existing entry commission for order 7052766578: 0.10000000
2025-06-25 21:34:40,949 - INFO - orders - Commission calculation for order 7052766578: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:40,949 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -79.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 7052766578)
2025-06-25 21:34:40,949 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:40,953 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:40,953 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:40,954 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:40,960 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7930000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:40,960 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7930000000
2025-06-25 21:34:40,960 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -79.000000000000000000000000 JPY / 144.7930000000 = -0.5456064865014192675060258438 USD
2025-06-25 21:34:41,191 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99982.38000000, margin=26.11
2025-06-25 21:34:41,192 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99982.38000000, margin=26.11
2025-06-25 21:34:41,209 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:41,209 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:41,210 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:41,236 - INFO - orders - Fetched 7 open orders for user 6
2025-06-25 21:34:41,247 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:41,253 - INFO - orders - Updated static orders cache for user 6 with 7 open orders and 0 pending orders
2025-06-25 21:34:41,253 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:41,258 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:41,263 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:41,279 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:41,298 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:41,785 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:41,785 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:41,785 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:42,300 - INFO - orders - Order close request received - Order ID: 2497138509, User ID: 6, Close Price: 94.521
2025-06-25 21:34:42,301 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FF9D0>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:42,301 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:42,301 - INFO - orders - Request to close order 2497138509 for user 6 (DemoUser) with price 94.521. Frontend provided type: SELL, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:42,347 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:42,420 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 7
2025-06-25 21:34:42,421 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 346): Type=SELL, Qty=0.01000000, StoredMargin=6.52561801
2025-06-25 21:34:42,421 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.561801
2025-06-25 21:34:42,421 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:42,421 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.791878
2025-06-25 21:34:42,422 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:42,422 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.059809
2025-06-25 21:34:42,422 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:42,422 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.064312
2025-06-25 21:34:42,422 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:42,422 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.791878
2025-06-25 21:34:42,422 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.798784
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 7: MarginPerLot=652.796387
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.04000000, TotalSellQty=0.03000000, NetQty=0.04000000
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.561801'), Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=7 (based on individual stored margins)
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 6
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.791878
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:42,423 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.059809
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.064312
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.798784
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.796387
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.04000000, TotalSellQty=0.02000000, NetQty=0.04000000
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:42,424 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=6 (based on individual stored margins)
2025-06-25 21:34:42,444 - INFO - orders - Existing entry commission for order 2497138509: 0.10000000
2025-06-25 21:34:42,444 - INFO - orders - Commission calculation for order 2497138509: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:42,444 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -17.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 2497138509)
2025-06-25 21:34:42,445 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:42,449 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:42,450 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:42,450 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:42,462 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:42,462 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:42,463 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -17.000000000000000000000000 JPY / 144.7940000000 = -0.1174081798969570562316118071 USD
2025-06-25 21:34:42,578 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99982.06000000, margin=26.11
2025-06-25 21:34:42,580 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99982.06000000, margin=26.11
2025-06-25 21:34:42,590 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:42,590 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:42,590 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:42,607 - INFO - orders - Fetched 6 open orders for user 6
2025-06-25 21:34:42,626 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:42,641 - INFO - orders - Updated static orders cache for user 6 with 6 open orders and 0 pending orders
2025-06-25 21:34:42,641 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:42,652 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:42,660 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:43,233 - INFO - orders - Order close request received - Order ID: 3992087759, User ID: 6, Close Price: 94.413
2025-06-25 21:34:43,233 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FDF90>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:43,233 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:43,233 - INFO - orders - Request to close order 3992087759 for user 6 (DemoUser) with price 94.413. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:43,262 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:43,288 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 6
2025-06-25 21:34:43,289 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 347): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:43,289 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.791878
2025-06-25 21:34:43,289 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:43,289 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.059809
2025-06-25 21:34:43,289 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:43,289 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.064312
2025-06-25 21:34:43,290 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:43,290 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.791878
2025-06-25 21:34:43,290 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:43,290 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.798784
2025-06-25 21:34:43,290 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:43,290 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 6: MarginPerLot=652.796387
2025-06-25 21:34:43,290 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.04000000, TotalSellQty=0.02000000, NetQty=0.04000000
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.791878'), Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=26.11, ContributingOrders=6 (based on individual stored margins)
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 5
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.059809
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.064312
2025-06-25 21:34:43,291 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:43,292 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.791878
2025-06-25 21:34:43,292 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:43,292 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.798784
2025-06-25 21:34:43,292 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:43,292 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.796387
2025-06-25 21:34:43,292 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0.02000000, NetQty=0.03000000
2025-06-25 21:34:43,292 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:43,294 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=5 (based on individual stored margins)
2025-06-25 21:34:43,632 - INFO - orders - Existing entry commission for order 3992087759: 0.10000000
2025-06-25 21:34:43,632 - INFO - orders - Commission calculation for order 3992087759: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:43,632 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -108.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 3992087759)
2025-06-25 21:34:43,632 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:43,634 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:43,634 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:43,634 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:43,638 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:43,638 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:43,638 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -108.000000000000000000000000 JPY / 144.7940000000 = -0.7458872605218448278243573629 USD
2025-06-25 21:34:43,730 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99981.11000000, margin=19.58
2025-06-25 21:34:43,731 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99981.11000000, margin=19.58
2025-06-25 21:34:43,736 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:43,736 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:43,736 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:43,745 - INFO - orders - Fetched 5 open orders for user 6
2025-06-25 21:34:43,760 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:43,765 - INFO - orders - Updated static orders cache for user 6 with 5 open orders and 0 pending orders
2025-06-25 21:34:43,766 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:43,770 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:43,774 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:44,978 - INFO - orders - Order close request received - Order ID: 7479623692, User ID: 6, Close Price: 94.521
2025-06-25 21:34:44,979 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FFED0>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:44,979 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:44,979 - INFO - orders - Request to close order 7479623692 for user 6 (DemoUser) with price 94.521. Frontend provided type: SELL, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:45,071 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:45,112 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 5
2025-06-25 21:34:45,112 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 348): Type=SELL, Qty=0.01000000, StoredMargin=6.52059809
2025-06-25 21:34:45,112 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.059809
2025-06-25 21:34:45,112 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:45,112 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.064312
2025-06-25 21:34:45,112 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:45,113 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.791878
2025-06-25 21:34:45,113 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:45,113 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.798784
2025-06-25 21:34:45,113 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:45,113 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 5: MarginPerLot=652.796387
2025-06-25 21:34:45,113 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0.02000000, NetQty=0.03000000
2025-06-25 21:34:45,113 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.059809'), Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:45,114 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=5 (based on individual stored margins)
2025-06-25 21:34:45,114 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 4
2025-06-25 21:34:45,114 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:45,114 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.064312
2025-06-25 21:34:45,115 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:45,115 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.791878
2025-06-25 21:34:45,115 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:45,115 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.798784
2025-06-25 21:34:45,115 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:45,115 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.796387
2025-06-25 21:34:45,115 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0.01000000, NetQty=0.03000000
2025-06-25 21:34:45,116 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:45,116 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=4 (based on individual stored margins)
2025-06-25 21:34:45,132 - INFO - orders - Existing entry commission for order 7479623692: 0.10000000
2025-06-25 21:34:45,132 - INFO - orders - Commission calculation for order 7479623692: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:45,132 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -106.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 7479623692)
2025-06-25 21:34:45,132 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:45,134 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:45,134 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:45,134 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:45,138 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7930000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:45,139 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7930000000
2025-06-25 21:34:45,139 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -106.000000000000000000000000 JPY / 144.7930000000 = -0.7320795894829169918435283474 USD
2025-06-25 21:34:45,246 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99980.18000000, margin=19.58
2025-06-25 21:34:45,246 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99980.18000000, margin=19.58
2025-06-25 21:34:45,250 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:45,250 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:45,250 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:45,261 - INFO - orders - Fetched 4 open orders for user 6
2025-06-25 21:34:45,272 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:45,279 - INFO - orders - Updated static orders cache for user 6 with 4 open orders and 0 pending orders
2025-06-25 21:34:45,280 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:45,291 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:45,304 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:46,096 - INFO - orders - Order close request received - Order ID: 6250064077, User ID: 6, Close Price: 94.521
2025-06-25 21:34:46,097 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB53FD7D90>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:46,097 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:46,097 - INFO - orders - Request to close order 6250064077 for user 6 (DemoUser) with price 94.521. Frontend provided type: SELL, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:46,142 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:46,194 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 4
2025-06-25 21:34:46,194 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 349): Type=SELL, Qty=0.01000000, StoredMargin=6.52064312
2025-06-25 21:34:46,194 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.064312
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.791878
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.798784
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 4: MarginPerLot=652.796387
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0.01000000, NetQty=0.03000000
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.064312'), Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=4 (based on individual stored margins)
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 3
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:46,195 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.791878
2025-06-25 21:34:46,196 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:46,196 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.798784
2025-06-25 21:34:46,196 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:46,196 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.796387
2025-06-25 21:34:46,196 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0, NetQty=0.03000000
2025-06-25 21:34:46,196 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:46,196 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=3 (based on individual stored margins)
2025-06-25 21:34:46,208 - INFO - orders - Existing entry commission for order 6250064077: 0.10000000
2025-06-25 21:34:46,208 - INFO - orders - Commission calculation for order 6250064077: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:46,209 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -106.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 6250064077)
2025-06-25 21:34:46,209 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:46,210 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:46,210 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:46,210 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:46,214 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:46,215 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:46,215 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -106.000000000000000000000000 JPY / 144.7940000000 = -0.7320745334751439976794618562 USD
2025-06-25 21:34:46,287 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99979.25000000, margin=19.58
2025-06-25 21:34:46,288 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99979.25000000, margin=19.58
2025-06-25 21:34:46,294 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:46,294 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:46,294 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:46,303 - INFO - orders - Fetched 3 open orders for user 6
2025-06-25 21:34:46,337 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:46,341 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:46,355 - INFO - orders - Updated static orders cache for user 6 with 3 open orders and 0 pending orders
2025-06-25 21:34:46,355 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:46,364 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:46,367 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:46,371 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:46,819 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:46,820 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:46,820 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:46,922 - INFO - orders - Order close request received - Order ID: 2751300651, User ID: 6, Close Price: 94.413
2025-06-25 21:34:46,922 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB53FD7D90>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:46,922 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:46,922 - INFO - orders - Request to close order 2751300651 for user 6 (DemoUser) with price 94.413. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:46,945 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:46,981 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 3
2025-06-25 21:34:46,981 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 350): Type=BUY, Qty=0.01000000, StoredMargin=6.52791878
2025-06-25 21:34:46,982 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.791878
2025-06-25 21:34:46,982 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:46,982 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.798784
2025-06-25 21:34:46,982 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:46,982 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 3: MarginPerLot=652.796387
2025-06-25 21:34:46,982 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.03000000, TotalSellQty=0, NetQty=0.03000000
2025-06-25 21:34:46,983 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.791878'), Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:46,983 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=19.58, ContributingOrders=3 (based on individual stored margins)
2025-06-25 21:34:46,983 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 2
2025-06-25 21:34:46,983 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:46,983 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.798784
2025-06-25 21:34:46,984 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:46,984 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.796387
2025-06-25 21:34:46,984 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000
2025-06-25 21:34:46,984 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:46,984 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.06, ContributingOrders=2 (based on individual stored margins)
2025-06-25 21:34:47,030 - INFO - orders - Existing entry commission for order 2751300651: 0.10000000
2025-06-25 21:34:47,030 - INFO - orders - Commission calculation for order 2751300651: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:47,031 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -108.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 2751300651)
2025-06-25 21:34:47,031 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:47,038 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:47,039 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:47,039 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:47,048 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:47,049 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:47,049 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -108.000000000000000000000000 JPY / 144.7940000000 = -0.7458872605218448278243573629 USD
2025-06-25 21:34:47,517 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99978.30000000, margin=13.06
2025-06-25 21:34:47,518 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99978.30000000, margin=13.06
2025-06-25 21:34:47,519 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:47,520 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:47,520 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:47,525 - INFO - orders - Fetched 2 open orders for user 6
2025-06-25 21:34:47,584 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:47,610 - INFO - orders - Updated static orders cache for user 6 with 2 open orders and 0 pending orders
2025-06-25 21:34:47,610 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:47,622 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:47,629 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:48,749 - INFO - orders - Order close request received - Order ID: 6873160663, User ID: 6, Close Price: 94.413
2025-06-25 21:34:48,749 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FFED0>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:48,749 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:48,749 - INFO - orders - Request to close order 6873160663 for user 6 (DemoUser) with price 94.413. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:48,768 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:48,805 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 2
2025-06-25 21:34:48,805 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 351): Type=BUY, Qty=0.01000000, StoredMargin=6.52798784
2025-06-25 21:34:48,806 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.798784
2025-06-25 21:34:48,807 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:48,807 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 2: MarginPerLot=652.796387
2025-06-25 21:34:48,808 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.02000000, TotalSellQty=0, NetQty=0.02000000
2025-06-25 21:34:48,808 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.798784'), Decimal('652.796387')], HighestMarginPerLot=652.798784
2025-06-25 21:34:48,808 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=13.06, ContributingOrders=2 (based on individual stored margins)
2025-06-25 21:34:48,808 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:34:48,808 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:48,808 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.796387
2025-06-25 21:34:48,808 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:34:48,809 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.796387')], HighestMarginPerLot=652.796387
2025-06-25 21:34:48,809 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.53, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:34:48,836 - INFO - orders - Existing entry commission for order 6873160663: 0.10000000
2025-06-25 21:34:48,836 - INFO - orders - Commission calculation for order 6873160663: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:48,836 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -109.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 6873160663)
2025-06-25 21:34:48,837 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:48,845 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:48,846 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:48,846 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:48,851 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7880000000')}
2025-06-25 21:34:48,851 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:48,851 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -109.000000000000000000000000 JPY / 144.7940000000 = -0.7527936240451952428968051162 USD
2025-06-25 21:34:48,930 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99977.35000000, margin=6.53
2025-06-25 21:34:48,931 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99977.35000000, margin=6.53
2025-06-25 21:34:48,937 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:48,938 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:48,938 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:48,952 - INFO - orders - Fetched 1 open orders for user 6
2025-06-25 21:34:48,970 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:48,975 - INFO - orders - Updated static orders cache for user 6 with 1 open orders and 0 pending orders
2025-06-25 21:34:48,975 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:48,980 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:48,985 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:49,412 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:49,413 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:49,413 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:49,431 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:49,432 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:49,432 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:49,449 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:49,450 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:49,450 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:50,251 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:50,252 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:50,252 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:50,874 - INFO - orders - Order close request received - Order ID: 6093605334, User ID: 6, Close Price: 94.413
2025-06-25 21:34:50,875 - INFO - orders - user_to_operate_on: <app.database.models.DemoUser object at 0x000001FB541FFED0>, type: <class 'app.database.models.DemoUser'>, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'city', 'country', 'created_at', 'demo_user_favorites', 'email', 'group_name', 'hashed_password', 'id', 'isActive', 'is_service_account', 'leverage', 'margin', 'metadata', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-06-25 21:34:50,875 - INFO - orders - Using order model: demo_user_orders for user 6 (DemoUser)
2025-06-25 21:34:50,875 - INFO - orders - Request to close order 6093605334 for user 6 (DemoUser) with price 94.413. Frontend provided type: BUY, company: AUDJPY, status: CLOSED, frontend_status: CLOSED.
2025-06-25 21:34:50,893 - INFO - orders - Demo user 6 from group 'default' ('sending_orders' is NOT 'barclays'). Processing close locally.
2025-06-25 21:34:50,952 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:34:50,955 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 352): Type=BUY, Qty=0.01000000, StoredMargin=6.52796387
2025-06-25 21:34:50,955 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.796387
2025-06-25 21:34:50,955 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:34:50,956 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.796387')], HighestMarginPerLot=652.796387
2025-06-25 21:34:50,956 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.53, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:34:50,956 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 0
2025-06-25 21:34:50,956 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDJPY. Returning zero margin.
2025-06-25 21:34:50,992 - INFO - orders - Existing entry commission for order 6093605334: 0.10000000
2025-06-25 21:34:50,992 - INFO - orders - Commission calculation for order 6093605334: entry=0.10000000, exit=0.100000000000, total=0.20
2025-06-25 21:34:50,992 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -108.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 6093605334)
2025-06-25 21:34:50,992 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:34:50,997 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:34:50,997 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:34:50,997 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:34:51,009 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7940000000'), 'o': Decimal('144.7900000000')}
2025-06-25 21:34:51,010 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7940000000
2025-06-25 21:34:51,010 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -108.000000000000000000000000 JPY / 144.7940000000 = -0.7458872605218448278243573629 USD
2025-06-25 21:34:51,134 - INFO - orders - AFTER COMMIT: User 6 wallet_balance=99976.40000000, margin=0
2025-06-25 21:34:51,135 - INFO - orders - Setting user data cache for user 6 with wallet_balance=99976.40000000, margin=0
2025-06-25 21:34:51,141 - INFO - orders - User data cache updated for user 6
2025-06-25 21:34:51,141 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:34:51,141 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:34:51,158 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:34:51,171 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:34:51,179 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 0 pending orders
2025-06-25 21:34:51,179 - INFO - orders - Publishing order update for user 6
2025-06-25 21:34:51,191 - INFO - orders - Publishing user data update for user 6
2025-06-25 21:34:51,206 - INFO - orders - Publishing market data trigger
2025-06-25 21:34:51,614 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:51,653 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:55,171 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:55,172 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:55,172 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:55,181 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:55,182 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:55,182 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:55,192 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:55,192 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:55,193 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:56,753 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:34:56,818 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:56,818 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:56,818 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:56,936 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:56,936 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:56,936 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:56,979 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:34:56,989 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:56,989 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:56,989 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:57,366 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:57,367 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:57,367 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:58,236 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:58,236 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:58,236 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:58,247 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:58,248 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:58,248 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:58,256 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:58,257 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:58,257 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:34:58,698 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:34:58,699 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:34:58,699 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:34:59,654 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:34:59,654 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:59,655 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:34:59,666 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:34:59,667 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:59,667 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:34:59,675 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:34:59,676 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:34:59,676 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:01,715 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:01,715 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:01,716 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:01,723 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:01,724 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:01,724 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:01,734 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:01,735 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:01,735 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:02,002 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:02,024 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:03,989 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:03,990 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:03,990 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:04,001 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:04,001 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:04,002 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:04,015 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:04,016 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:04,016 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:04,533 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:04,533 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:04,533 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:06,199 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:06,199 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:06,200 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:06,210 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:06,211 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:06,211 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:06,222 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:06,223 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:06,223 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:06,772 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:06,773 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:06,773 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:07,038 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:07,057 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:08,659 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:08,660 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:08,660 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:08,670 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:08,671 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:08,671 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:08,678 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:08,679 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:08,679 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:09,171 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:09,172 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:09,172 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:10,913 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:10,914 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:10,914 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:10,923 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:10,923 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:10,924 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:10,935 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:10,935 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:10,936 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:11,570 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:11,571 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:11,571 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:12,087 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:12,104 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:13,013 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:13,013 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:13,013 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:13,024 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:13,024 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:13,024 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:13,033 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:13,033 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:13,033 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:13,455 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:13,455 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:13,456 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:15,805 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:15,806 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:15,806 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:15,815 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:15,815 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:15,815 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:15,826 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:15,826 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:15,826 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:16,537 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:16,538 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:16,538 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:17,134 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:17,165 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:17,697 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:17,697 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:17,698 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:17,703 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:17,704 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:17,704 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:17,710 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:17,711 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:17,711 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:18,210 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:18,210 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:18,211 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:20,043 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:20,044 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:20,044 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:20,053 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:20,054 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:20,054 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:20,066 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:20,066 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:20,066 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:20,648 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:20,649 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:20,649 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:22,206 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:22,235 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:22,378 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:22,379 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:22,379 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:22,429 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:22,430 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:22,430 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:22,458 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:22,458 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:22,458 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:25,204 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:25,204 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:25,205 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:27,013 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:27,013 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:27,013 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:27,047 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:27,048 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:27,048 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:27,056 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:27,056 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:27,056 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:27,251 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:27,278 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:27,567 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:27,568 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:27,568 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:29,370 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:29,370 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:29,371 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:29,384 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:29,384 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:29,384 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:29,390 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:29,390 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:29,391 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:29,916 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:29,916 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:29,916 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:31,823 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:31,823 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:31,823 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:31,844 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:31,844 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:31,844 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:31,855 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:31,856 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:31,856 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:32,299 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:32,327 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:33,705 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:33,705 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:33,705 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:33,715 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:33,715 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:33,715 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:33,724 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:33,724 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:33,724 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:34,392 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:34,393 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:34,393 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:36,210 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:36,210 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:36,210 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:37,391 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:37,399 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9547.970159263406743809879308, margin_level=147218.1842721634321080104670, balance=10000.00000000, equity=9554.460159263406743809879308
2025-06-25 21:35:37,418 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:38,083 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:38,083 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:38,083 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:38,092 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:38,092 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:38,093 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:38,125 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:38,132 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:38,133 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:38,596 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:38,596 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:38,596 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:40,187 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:40,188 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:40,188 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:40,197 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:40,197 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:40,197 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:40,205 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:40,206 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:40,206 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:40,565 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:40,566 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:40,566 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:42,448 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:42,476 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:42,648 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:42,649 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:42,649 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:42,660 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:42,660 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:42,660 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:42,669 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:42,669 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:42,669 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:43,097 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:43,098 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:43,098 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:45,167 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:45,167 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:45,167 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:45,176 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:45,176 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:45,177 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:45,193 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:45,193 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:45,194 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:45,861 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:45,862 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:45,862 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:47,492 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:47,510 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:47,799 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:47,799 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:47,799 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:47,803 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:47,803 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:47,803 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:47,812 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:47,812 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:47,813 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:49,499 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:49,501 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:49,501 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:49,512 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:49,512 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:49,515 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:49,524 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:49,524 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:49,525 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:51,708 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:51,708 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:51,708 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:51,739 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:51,739 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:51,739 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:51,783 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:51,783 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:51,783 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:52,275 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:52,275 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:52,275 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:52,673 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:52,696 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:56,288 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:35:56,288 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:56,288 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:35:56,296 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:35:56,296 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:56,296 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:35:56,308 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:35:56,308 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:35:56,308 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:35:56,922 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:56,922 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:56,922 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:35:57,745 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:35:57,773 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:35:59,353 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:35:59,353 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:35:59,353 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:00,913 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:00,914 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:00,914 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:00,927 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:00,928 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:00,928 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:00,937 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:00,937 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:00,938 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:01,595 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:01,595 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:01,595 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:02,797 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:02,823 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:03,269 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:03,270 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:03,270 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:03,281 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:03,282 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:03,283 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:03,303 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:03,304 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:03,304 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:03,939 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:03,939 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:03,939 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:07,605 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:07,605 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:07,605 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:07,613 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:07,613 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:07,614 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:07,623 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:07,623 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:07,623 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:07,852 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:07,875 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:08,115 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:08,115 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:08,116 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:09,912 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:09,912 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:09,912 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:09,927 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:09,927 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:09,927 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:09,949 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:09,949 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:09,949 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:12,942 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:12,953 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:14,408 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:14,409 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:14,409 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:14,416 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:14,417 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:14,417 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:14,426 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:14,426 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:14,426 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:14,679 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:14,679 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:14,679 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:16,926 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:16,927 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:16,927 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:17,970 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:18,005 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:23,034 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:23,058 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:26,248 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:26,249 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:26,249 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:26,265 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:26,266 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:26,266 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:26,276 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:26,276 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:26,277 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:26,825 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:26,826 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:26,826 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:28,086 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:28,153 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:28,654 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:28,654 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:28,655 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:28,665 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:28,665 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:28,665 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:28,674 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:28,675 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:28,676 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:28,919 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:28,920 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:28,920 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:31,486 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:31,486 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:31,487 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:33,284 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:33,353 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:35,659 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:35,659 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:35,659 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:37,645 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:37,651 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:37,652 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:37,683 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:37,684 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:37,685 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:37,709 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:37,710 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:37,710 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:38,081 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9547.996402548277921560820227, margin_level=147218.5886371075180517845952, balance=10000.00000000, equity=9554.486402548277921560820227
2025-06-25 21:36:38,386 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:38,466 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:38,874 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:38,874 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:38,874 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:39,949 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:39,949 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:39,950 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:39,966 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:39,967 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:39,967 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:39,978 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:39,979 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:39,979 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:42,022 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:42,023 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:42,023 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:42,029 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:42,029 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:42,029 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:42,034 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:42,034 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:42,035 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:42,656 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:42,656 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:42,656 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:43,504 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:43,515 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:44,641 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:44,641 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:44,641 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:44,648 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:44,650 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:44,651 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:44,660 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:44,660 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:44,660 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:46,681 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:46,684 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:46,684 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:46,698 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:46,698 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:46,698 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:46,709 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:46,709 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:46,710 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:47,179 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:47,180 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:47,180 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:48,575 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:48,688 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:49,263 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:49,263 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:49,263 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:49,276 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:49,277 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:49,277 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:49,286 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:49,287 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:49,287 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:49,757 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:49,757 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:49,757 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:51,253 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:51,253 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:51,253 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:51,272 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:51,273 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:51,273 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:51,292 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:51,292 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:51,293 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:53,600 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:53,601 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:53,601 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:53,611 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:53,611 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:53,612 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:53,621 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:53,622 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:53,622 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:53,705 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:53,736 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:56,581 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:56,581 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:56,581 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:36:58,085 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:36:58,085 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:58,085 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:36:58,135 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:36:58,136 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:58,136 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:36:58,169 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:36:58,170 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:36:58,170 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:36:58,749 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:36:58,789 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:36:58,906 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:36:58,907 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:36:58,907 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:00,397 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:00,401 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:00,401 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:00,412 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:00,412 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:00,412 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:00,426 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:00,427 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:00,427 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:01,027 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:01,027 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:01,028 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:02,644 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:02,644 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:02,645 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:02,662 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:02,665 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:02,665 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:02,679 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:02,680 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:02,681 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:03,800 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:03,811 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:05,028 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:05,029 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:05,029 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:05,056 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:05,057 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:05,057 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:05,078 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:05,078 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:05,078 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:07,101 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:07,101 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:07,101 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:07,124 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:07,124 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:07,124 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:07,141 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:07,141 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:07,141 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:08,829 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:08,860 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:13,175 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:13,175 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:13,176 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:13,889 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:13,938 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:14,432 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:14,432 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:14,432 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:17,880 - INFO - orders - Pending order placement request received - User ID: 6, Symbol: AUDJPY, Type: BUY_LIMIT, Quantity: 0.01
2025-06-25 21:37:17,954 - INFO - orders - Validating pending order price: Order type=BUY_LIMIT, Order price=94.52, Current buy price=94.5210000000, Current sell price=94.4140000000
2025-06-25 21:37:18,093 - INFO - orders - Calculated contract_value for pending order: 1000.0000000000 (contract_size: 100000.00000000 * quantity: 0.01)
2025-06-25 21:37:18,101 - INFO - orders - [DEBUG] User data from cache: {'id': 6, 'email': 'cursordemo3@gmail.com', 'group_name': 'Group B', 'leverage': Decimal('100.00'), 'user_type': 'demo', 'account_number': '0BBEF', 'wallet_balance': Decimal('99976.40000000'), 'margin': Decimal('0'), 'first_name': None, 'last_name': None, 'country': None, 'phone_number': Decimal('19741258242')}
2025-06-25 21:37:18,102 - INFO - orders - [DEBUG] Group name: Group B
2025-06-25 21:37:18,106 - INFO - orders - [DEBUG] Group settings from cache: {'sending_orders': 'barclays'}
2025-06-25 21:37:18,106 - INFO - orders - [DEBUG] sending_orders value: barclays, type: <class 'str'>
2025-06-25 21:37:18,106 - INFO - orders - [DEBUG] sending_orders_normalized: barclays
2025-06-25 21:37:18,106 - INFO - orders - User 6 is_barclays_live_user: False (user_type: demo, sending_orders_normalized: barclays)
2025-06-25 21:37:18,208 - INFO - orders - [DEBUG][pending_order] Prepared order_data_for_internal_processing: {'order_id': '5942819337', 'order_company_name': 'AUDJPY', 'order_type': 'BUY_LIMIT', 'order_quantity': Decimal('0.01'), 'order_price': Decimal('94.52'), 'user_type': 'demo', 'status': 'PENDING', 'stop_loss': Decimal('0'), 'take_profit': Decimal('0'), 'stoploss_id': '1643622135', 'takeprofit_id': '2915773031', 'order_user_id': 6, 'order_status': 'PENDING', 'contract_value': Decimal('1000.0000000000'), 'margin': None, 'open_time': None}
2025-06-25 21:37:18,209 - INFO - orders - Placing PENDING order: BUY_LIMIT for user 6 at price 94.52
2025-06-25 21:37:18,356 - INFO - orders - Order 5942819337 verified in database on attempt 1 before adding to Redis.
2025-06-25 21:37:18,425 - INFO - orders - Pending order 5942819337 added to Redis for user 6 under key pending_orders:AUDJPY:BUY_LIMIT.
2025-06-25 21:37:18,425 - INFO - orders - Pending order 5942819337 added to Redis for non-Barclays user or demo user.
2025-06-25 21:37:18,475 - INFO - orders - User data cache updated for user 6 after placing pending order
2025-06-25 21:37:18,475 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:37:18,475 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:37:18,526 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:37:18,573 - INFO - orders - Fetched 1 pending orders for user 6
2025-06-25 21:37:18,584 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 1 pending orders
2025-06-25 21:37:18,967 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:37:18,978 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:37:18,985 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:37:18,985 - INFO - orders -     Order 5942819337: AUDJPY BUY_LIMIT, price=94.52000000, user_type=demo
2025-06-25 21:37:18,989 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:37:19,020 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:20,035 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:20,036 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:20,036 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:21,344 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.52000000, adjusted_buy_price: 94.521
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.52100 <= 94.52000 = False
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.52100 (<class 'decimal.Decimal'>), order_price_normalized: 94.52000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.52100' vs '94.52000'
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00100
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 5942819337: type=BUY_LIMIT, adjusted_buy_price=94.52100, order_price=94.52000, should_trigger=False
2025-06-25 21:37:21,345 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 5942819337 conditions not met for execution. Skipping.
2025-06-25 21:37:21,385 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:21,385 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:21,386 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:21,399 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:21,399 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:21,399 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:21,416 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:21,417 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:21,417 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:21,774 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:21,774 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:21,774 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:24,264 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:37:24,267 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:37:24,277 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:37:24,277 - INFO - orders -     Order 5942819337: AUDJPY BUY_LIMIT, price=94.52000000, user_type=demo
2025-06-25 21:37:24,314 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:37:24,382 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.52000000, adjusted_buy_price: 94.521
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.52100 <= 94.52000 = False
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.52100 (<class 'decimal.Decimal'>), order_price_normalized: 94.52000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.52100' vs '94.52000'
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00100
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 5942819337: type=BUY_LIMIT, adjusted_buy_price=94.52100, order_price=94.52000, should_trigger=False
2025-06-25 21:37:25,455 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 5942819337 conditions not met for execution. Skipping.
2025-06-25 21:37:25,497 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:25,497 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:25,497 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:25,510 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:25,510 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:25,510 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:25,526 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:25,527 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:25,527 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.52000000, adjusted_buy_price: 94.521
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.52100 <= 94.52000 = False
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.52100 (<class 'decimal.Decimal'>), order_price_normalized: 94.52000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.52100' vs '94.52000'
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00100
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:37:27,523 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 5942819337: type=BUY_LIMIT, adjusted_buy_price=94.52100, order_price=94.52000, should_trigger=False
2025-06-25 21:37:27,524 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 5942819337 conditions not met for execution. Skipping.
2025-06-25 21:37:27,558 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:27,558 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:27,558 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:27,564 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:27,565 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:27,565 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:27,570 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:27,571 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:27,571 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:29,399 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:37:29,401 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:37:29,404 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:37:29,404 - INFO - orders -     Order 5942819337: AUDJPY BUY_LIMIT, price=94.52000000, user_type=demo
2025-06-25 21:37:29,406 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:37:29,416 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:29,681 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.52000000, adjusted_buy_price: 94.521
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.52100 <= 94.52000 = False
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.52100 (<class 'decimal.Decimal'>), order_price_normalized: 94.52000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.52100' vs '94.52000'
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00100
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 5942819337: type=BUY_LIMIT, adjusted_buy_price=94.52100, order_price=94.52000, should_trigger=False
2025-06-25 21:37:29,682 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 5942819337 conditions not met for execution. Skipping.
2025-06-25 21:37:29,709 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:29,710 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:29,710 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:29,717 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:29,717 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:29,717 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:29,722 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:29,722 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:29,722 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:32,509 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:32,509 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:32,509 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:34,275 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.52000000, adjusted_buy_price: 94.526
2025-06-25 21:37:34,275 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.52600 <= 94.52000 = False
2025-06-25 21:37:34,275 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.52600 (<class 'decimal.Decimal'>), order_price_normalized: 94.52000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:34,275 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.52600' vs '94.52000'
2025-06-25 21:37:34,275 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00600
2025-06-25 21:37:34,276 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: False (epsilon=0.00001)
2025-06-25 21:37:34,276 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: False
2025-06-25 21:37:34,276 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 5942819337: type=BUY_LIMIT, adjusted_buy_price=94.52600, order_price=94.52000, should_trigger=False
2025-06-25 21:37:34,276 - INFO - orders - [PENDING_ORDER_EXECUTION] Order 5942819337 conditions not met for execution. Skipping.
2025-06-25 21:37:34,304 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:34,304 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:34,304 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:34,310 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:34,310 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:34,310 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:34,315 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:34,316 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:34,316 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:34,427 - INFO - orders - Found 1 pending order keys in Redis
2025-06-25 21:37:34,431 - INFO - orders - Key: pending_orders:AUDJPY:BUY_LIMIT, Users: 1
2025-06-25 21:37:34,435 - INFO - orders -   User 6 has 1 pending orders for pending_orders:AUDJPY:BUY_LIMIT
2025-06-25 21:37:34,436 - INFO - orders -     Order 5942819337: AUDJPY BUY_LIMIT, price=94.52000000, user_type=demo
2025-06-25 21:37:34,441 - WARNING - orders - No price data found for AUDJPY
2025-06-25 21:37:34,454 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] Raw values - order_price: 94.52000000, adjusted_buy_price: 94.52
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP check: 94.52000 <= 94.52000 = True
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] Price comparison values - adjusted_buy_price_normalized: 94.52000 (<class 'decimal.Decimal'>), order_price_normalized: 94.52000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] String comparison for prices: '94.52000' vs '94.52000'
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] Absolute price difference: 0.00000
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] Prices within epsilon tolerance: True (epsilon=0.00001)
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] BUY_LIMIT/SELL_STOP with epsilon: True
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] Checking order 5942819337: type=BUY_LIMIT, adjusted_buy_price=94.52000, order_price=94.52000, should_trigger=True
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION] Trigger condition met for order 5942819337. Executing trigger_pending_order.
2025-06-25 21:37:36,495 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting trigger_pending_order for order 5942819337, user 6, symbol AUDJPY, type BUY_LIMIT
2025-06-25 21:37:36,497 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] User data loaded for user 6: group=Group B, wallet_balance=99983.43000000
2025-06-25 21:37:36,499 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Group settings loaded for group Group B
2025-06-25 21:37:36,507 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order 5942819337 found on attempt 1
2025-06-25 21:37:36,507 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Database order loaded: status=PENDING, price=94.52000000
2025-06-25 21:37:36,511 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Adjusted prices loaded: {'buy': Decimal('94.5200000000'), 'sell': Decimal('94.4130000000'), 'spread_value': Decimal('0.10000000')}
2025-06-25 21:37:36,511 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Normalized prices for comparison - order_price: 94.52000, adjusted_buy_price: 94.52000, adjusted_sell_price: 94.41300
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] BUY_LIMIT/SELL_STOP check: 94.52000 <= 94.52000 = True
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Checking order 5942819337: type=BUY_LIMIT, adjusted_buy_price=94.52000, order_price=94.52000, should_trigger=True
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Price comparison values - adjusted_buy_price_normalized: 94.52000 (<class 'decimal.Decimal'>), order_price_normalized: 94.52000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw price values - adjusted_buy_price: 94.5200000000 (<class 'decimal.Decimal'>), order_price: 94.52000000 (<class 'decimal.Decimal'>)
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] String comparison for prices: '94.52000' vs '94.52000'
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Absolute price difference: 0.00000
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Prices within epsilon tolerance: True (epsilon=0.00001)
2025-06-25 21:37:36,512 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] BUY_LIMIT/SELL_STOP with epsilon: True
2025-06-25 21:37:36,515 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] External symbol info loaded: {'contract_size': Decimal('100000.00000000'), 'profit_currency': 'JPY', 'digit': Decimal('3.00000')}
2025-06-25 21:37:36,516 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Raw market data loaded: {'b': '94.4700000000', 'o': '94.4630000000'}
2025-06-25 21:37:36,516 - INFO - orders - [MARGIN_CALC] Starting margin calculation for AUDJPY BUY_LIMIT order, quantity: 0.01000000
2025-06-25 21:37:36,516 - INFO - orders - [MARGIN_CALC] No group_name in settings, fetching for user 6
2025-06-25 21:37:36,522 - INFO - orders - [MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:37:36,524 - INFO - orders - [MARGIN_CALC] Got BUY price for AUDJPY from cache: 94.4630000000
2025-06-25 21:37:36,524 - INFO - orders - [MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:37:36,524 - INFO - orders - [MARGIN_CALC] Contract value = contract_size * quantity = 100000.00000000 * 0.01000000 = 1000.0000000000000000
2025-06-25 21:37:36,527 - INFO - orders - [MARGIN_CALC] Using default leverage: 100
2025-06-25 21:37:36,527 - INFO - orders - [MARGIN_CALC] Margin calculation: (contract_value * price) / effective_leverage = (1000.0000000000000000 * 94.4630000000) / 100 = 944.63000000000000000000000 (rounded to 944.63)
2025-06-25 21:37:36,527 - INFO - orders - [MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:37:36,527 - INFO - orders - [MARGIN_CALC] Per lot commission: 0.01000000 * 10.0000 = 0.100000000000
2025-06-25 21:37:36,527 - INFO - orders - [MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:37:36,527 - INFO - orders - [MARGIN_CALC] Converting margin from JPY to USD: 944.63 JPY
2025-06-25 21:37:36,527 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 944.63 JPY to USD for margin for AUDJPY BUY_LIMIT order (user_id: 6, position: )
2025-06-25 21:37:36,527 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:37:36,529 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:37:36,529 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:37:36,529 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:37:36,531 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7900000000'), 'o': Decimal('144.7860000000')}
2025-06-25 21:37:36,531 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7900000000
2025-06-25 21:37:36,531 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 944.63 JPY / 144.7900000000 = 6.524138407348573796532909731 USD
2025-06-25 21:37:36,531 - INFO - orders - [MARGIN_CALC] Margin after USD conversion: 944.63 JPY -> 6.524138407348573796532909731 USD
2025-06-25 21:37:36,531 - INFO - orders - [MARGIN_CALC] Final results for AUDJPY BUY_LIMIT: margin=6.524138407348573796532909731, price=94.4630000000, contract_value=1000.0000000000000000, commission=0.10
2025-06-25 21:37:36,531 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin calculated successfully for order 5942819337: margin=6.524138407348573796532909731, exec_price=94.4630000000, contract_value=1000.0000000000000000
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 0
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDJPY. Returning zero margin.
2025-06-25 21:37:36,535 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Current symbol margin contribution (before): 0.0
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: None): Type=BUY, Qty=0.01000000, StoredMargin=6.524138407348573796532909731
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.4138407348573796532909731
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.4138407348573796532909731')], HighestMarginPerLot=652.4138407348573796532909731
2025-06-25 21:37:36,535 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.52, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:37:36,535 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Symbol margin contribution after adding order: 6.52
2025-06-25 21:37:36,536 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin change required: 6.52 (Before: 0.0, After: 6.52)
2025-06-25 21:37:36,540 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Latest free_margin for user 6: 99976.40000000
2025-06-25 21:37:36,540 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Executing order 5942819337 for user 6 at price 94.52000 (order_price=94.52000, type=BUY_LIMIT)
2025-06-25 21:37:36,540 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Contract value calculated: 1000.0000000000000000
2025-06-25 21:37:36,540 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with calculated values: margin=6.524138407348573796532909731 (was None), contract_value=1000.0000000000000000, commission=0.10, execution_price=94.4630000000
2025-06-25 21:37:36,540 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Note: Order margin stored is the individual margin requirement (6.524138407348573796532909731), while margin change applied to user (6.52) considers total symbol margin effect
2025-06-25 21:37:36,540 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated order object with new values and cleared SL/TP
2025-06-25 21:37:36,547 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fresh user data loaded: wallet_balance=99976.40000000, current_margin=0E-8
2025-06-25 21:37:36,547 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Margin check: current_margin=0E-8, new_margin=6.52000000, wallet_balance=99976.40000000
2025-06-25 21:37:36,547 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Using margin with hedging applied: 6.52. Adding to current total margin: 0E-8
2025-06-25 21:37:36,567 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] User margin updated successfully for user 6: 6.52000000 (includes hedging adjustments)
2025-06-25 21:37:36,576 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Updated user data cache with new margin value: 6.52000000
2025-06-25 21:37:36,580 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published user data update notification for user 6
2025-06-25 21:37:36,580 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Pending order 5942819337 for user 6 opened successfully. New total margin: 6.52000000
2025-06-25 21:37:36,594 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Order 5942819337 status updated to OPEN in database
2025-06-25 21:37:36,594 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Starting portfolio update for user 6
2025-06-25 21:37:36,609 - WARNING - orders - No price data found for commision_type
2025-06-25 21:37:36,612 - WARNING - orders - No price data found for commision_value_type
2025-06-25 21:37:36,614 - WARNING - orders - No price data found for type
2025-06-25 21:37:36,618 - WARNING - orders - No price data found for pip_currency
2025-06-25 21:37:36,620 - WARNING - orders - No price data found for show_points
2025-06-25 21:37:36,622 - WARNING - orders - No price data found for swap_buy
2025-06-25 21:37:36,625 - WARNING - orders - No price data found for swap_sell
2025-06-25 21:37:36,627 - WARNING - orders - No price data found for commision
2025-06-25 21:37:36,630 - WARNING - orders - No price data found for margin
2025-06-25 21:37:36,634 - WARNING - orders - No price data found for spread
2025-06-25 21:37:36,639 - WARNING - orders - No price data found for deviation
2025-06-25 21:37:36,644 - WARNING - orders - No price data found for min_lot
2025-06-25 21:37:36,649 - WARNING - orders - No price data found for max_lot
2025-06-25 21:37:36,651 - WARNING - orders - No price data found for pips
2025-06-25 21:37:36,653 - WARNING - orders - No price data found for spread_pip
2025-06-25 21:37:36,657 - WARNING - orders - No price data found for contract_size
2025-06-25 21:37:36,662 - WARNING - orders - No price data found for profit_currency
2025-06-25 21:37:36,663 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Fetched market prices for 0 symbols
2025-06-25 21:37:36,963 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Portfolio cache updated and websocket event published for user 6
2025-06-25 21:37:36,963 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully processed triggered pending order 5942819337 for user 6. Status set to OPEN. Order Type changed from BUY_LIMIT to BUY.
2025-06-25 21:37:36,967 - INFO - orders - Pending order 5942819337 removed from Redis for symbol AUDJPY type BUY_LIMIT and user 6.
2025-06-25 21:37:36,967 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Successfully removed order 5942819337 from Redis pending orders
2025-06-25 21:37:36,970 - INFO - orders - [PENDING_ORDER_EXECUTION_DEBUG] Published order execution notification for order 5942819337 to channel user:6:notifications
2025-06-25 21:37:37,004 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:37,004 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:37,004 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:37,009 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:37,010 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:37,010 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:37,015 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:37,015 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:37,015 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:37,348 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:37,348 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:37,348 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:38,059 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9547.996402548277921560820227, margin_level=147218.5886371075180517845952, balance=10000.00000000, equity=9554.486402548277921560820227
2025-06-25 21:37:38,685 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=6, user_type=demo, group_name=Group B, free_margin=99969.43467705398088292170838, margin_level=1533373.537991625473664443380, balance=99976.40000000, equity=99975.95467705398088292170838
2025-06-25 21:37:39,037 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:39,038 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:39,038 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:39,042 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:39,042 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:39,042 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:39,047 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:39,047 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:39,047 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:39,564 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:39,569 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:41,014 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:41,014 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:41,014 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:41,018 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:41,018 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:41,018 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:41,023 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:41,024 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:41,024 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:41,390 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:41,390 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:41,391 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:44,180 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:44,181 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:44,181 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:44,650 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:44,663 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:45,788 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:45,789 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:45,789 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:45,793 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:45,793 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:45,793 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:45,797 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:45,797 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:45,797 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:46,224 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:46,224 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:46,224 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:48,357 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:48,357 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:48,357 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:48,372 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:48,373 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:48,373 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:48,388 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:48,389 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:48,389 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:49,690 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:49,703 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:50,604 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:50,604 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:50,604 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:50,613 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:50,613 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:50,613 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:50,629 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:50,630 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:50,630 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:53,065 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:53,066 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:53,066 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:54,711 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:54,733 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:37:55,096 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:37:55,096 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:55,096 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:37:55,103 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:37:55,104 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:55,104 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:37:55,114 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:37:55,114 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:37:55,114 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:37:55,823 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:55,823 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:55,824 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:57,810 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:37:57,810 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:37:57,811 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:37:59,767 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:37:59,800 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:00,242 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:00,243 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:00,243 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:02,796 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:02,796 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:02,797 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:04,700 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:04,700 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:04,700 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:04,710 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:04,711 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:04,711 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:04,729 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:04,731 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:04,732 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:04,858 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:04,876 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:05,424 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:05,425 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:05,425 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:07,971 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:07,972 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:07,977 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:09,958 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:10,007 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:11,384 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:11,385 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:11,385 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:11,431 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:11,432 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:11,432 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:11,445 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:11,446 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:11,446 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:12,252 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:12,253 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:12,253 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:13,891 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:13,891 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:13,891 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:13,930 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:13,930 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:13,930 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:13,957 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:13,959 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:13,959 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:14,848 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:14,848 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:14,848 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:15,063 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:15,197 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:16,561 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:16,562 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:16,562 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:16,580 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:16,581 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:16,581 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:16,599 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:16,599 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:16,599 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:17,483 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:17,483 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:17,483 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:20,129 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:20,130 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:20,130 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:20,256 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:20,401 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:21,900 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:21,900 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:21,900 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:21,916 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:21,916 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:21,916 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:21,938 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:21,939 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:21,939 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:22,705 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:22,705 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:22,709 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:24,589 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:24,590 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:24,590 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:25,534 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:25,581 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:26,628 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:26,628 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:26,629 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:26,648 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:26,649 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:26,649 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:26,676 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:26,677 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:26,677 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:27,531 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:27,531 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:27,531 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:30,635 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:30,725 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:30,742 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:30,742 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:30,743 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:32,600 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:32,601 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:32,601 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:32,609 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:32,609 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:32,609 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:32,624 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:32,624 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:32,625 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:33,412 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:33,412 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:33,413 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:35,778 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:35,809 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:36,082 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:36,082 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:36,083 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:37,959 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:37,963 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:37,963 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:37,998 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:37,999 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:38,000 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:38,026 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:38,026 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:38,026 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:38,617 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9547.974232741028321138818376, margin_level=147218.2470376121467047583725, balance=10000.00000000, equity=9554.464232741028321138818376
2025-06-25 21:38:39,811 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:39,812 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:39,812 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:40,936 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:40,946 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=6, user_type=demo, group_name=Group B, free_margin=99969.44156481379157918001989, margin_level=1533373.643632113367778834661, balance=99976.40000000, equity=99975.96156481379157918001989
2025-06-25 21:38:40,969 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:41,614 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:41,615 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:41,615 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:41,631 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:41,632 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:41,632 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:41,638 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:41,638 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:41,639 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:42,498 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:42,499 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:42,499 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:44,183 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:44,184 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:44,184 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:44,205 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:44,205 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:44,206 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:44,234 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:44,236 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:44,236 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:45,162 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:45,163 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:45,163 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:46,010 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:46,033 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:47,104 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:47,105 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:47,105 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:47,134 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:47,135 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:47,135 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:47,160 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:47,160 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:47,160 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:48,198 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:48,203 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:48,203 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:49,928 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:49,929 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:49,929 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:49,960 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:49,961 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:49,961 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:49,971 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:49,971 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:49,972 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:50,866 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:50,866 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:50,866 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:51,060 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:51,103 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:52,403 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:52,424 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:52,424 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:52,453 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:52,454 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:52,454 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:52,476 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:52,477 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:52,477 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:53,357 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:53,359 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:53,359 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:55,245 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:55,246 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:55,246 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:38:56,123 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:38:56,144 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:38:56,564 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:38:56,565 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:56,565 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:38:56,569 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:38:56,569 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:56,569 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:38:56,575 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:38:56,575 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:38:56,575 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:38:59,727 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:38:59,727 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:38:59,727 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:01,196 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:01,226 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:01,775 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:01,775 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:01,775 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:05,793 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:05,793 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:05,793 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:06,402 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:06,425 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:07,290 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:07,290 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:07,291 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:09,825 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:09,825 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:09,825 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:11,465 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:11,482 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:13,403 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:13,404 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:13,404 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:15,200 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:15,200 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:15,200 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:16,500 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:16,525 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:18,519 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:18,520 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:18,520 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:18,534 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:18,534 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:18,535 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:18,555 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:18,555 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:18,556 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:19,517 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:19,518 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:19,519 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:20,678 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:20,679 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:20,679 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:20,692 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:20,692 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:20,693 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:20,708 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:20,710 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:20,710 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:21,350 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:21,352 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:21,353 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:21,541 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:21,842 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:23,016 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:23,017 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:23,017 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:24,573 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:24,573 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:24,574 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:24,584 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:24,584 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:24,585 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:24,601 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:24,601 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:24,602 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:26,530 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:26,530 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:26,531 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:26,539 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:26,539 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:26,540 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:26,555 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:26,555 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:26,556 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:26,852 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:26,870 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:26,965 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:26,965 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:26,965 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:31,772 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:31,772 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:31,775 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:31,794 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:31,794 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:31,794 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:31,814 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:31,814 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:31,814 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:31,896 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:31,953 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:34,225 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:34,225 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:34,226 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:34,233 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:34,234 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:34,234 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:34,250 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:34,251 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:34,251 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:35,423 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:35,423 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:35,423 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:36,395 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:36,395 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:36,395 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:36,405 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:36,405 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:36,406 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:36,413 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:36,413 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:36,413 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:36,973 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:37,044 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:38,639 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9547.806794185728152923314334, margin_level=147215.6670906891857153053056, balance=10000.00000000, equity=9554.296794185728152923314334
2025-06-25 21:39:39,338 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:39,339 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:39,339 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:39,879 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=6, user_type=demo, group_name=Group B, free_margin=99969.43464604673329695605026, margin_level=1533373.537516054191671105065, balance=99976.40000000, equity=99975.95464604673329695605026
2025-06-25 21:39:41,423 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:41,423 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:41,424 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:42,102 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:42,124 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:43,109 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:43,109 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:43,109 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:47,151 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:47,165 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:47,575 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:47,575 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:47,575 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:49,918 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:49,918 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:49,918 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:51,503 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:51,503 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:51,504 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:51,508 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:51,509 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:51,509 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:51,521 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:51,523 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:51,523 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:51,969 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:51,969 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:51,969 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:52,453 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:52,467 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:53,958 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:53,958 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:53,958 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:53,966 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:53,966 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:53,966 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:53,976 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:53,978 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:53,978 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:54,787 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:54,787 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:54,788 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:56,439 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:56,439 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:56,440 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:56,453 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:56,453 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:56,453 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:56,462 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:56,462 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:56,463 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:57,152 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:57,153 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:57,153 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:39:57,739 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:39:57,766 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:39:58,592 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:39:58,592 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:58,593 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:39:58,603 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:39:58,604 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:58,604 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:39:58,613 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:39:58,614 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:39:58,615 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:39:59,165 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:39:59,166 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:39:59,166 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:00,919 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:00,919 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:00,919 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:00,927 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:00,927 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:00,927 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:00,932 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:00,933 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:00,933 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:01,611 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:01,612 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:01,612 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:02,798 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:02,829 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:40:03,008 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:03,009 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:03,009 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:03,018 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:03,018 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:03,018 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:03,029 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:03,029 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:03,029 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:03,542 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:03,542 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:03,543 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:07,783 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:07,784 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:07,784 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:07,845 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:07,868 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:40:09,873 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:09,873 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:09,873 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:09,879 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:09,880 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:09,880 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:09,887 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:09,887 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:09,887 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:10,375 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:10,376 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:10,377 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:12,394 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:12,395 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:12,395 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:12,405 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:12,405 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:12,406 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:12,416 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:12,416 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:12,417 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:12,852 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:12,853 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:12,853 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:12,876 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:12,920 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:40:15,291 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:15,291 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:15,291 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:16,131 - INFO - orders - Add stoploss request received - Order ID: 5942819337, User ID: 6
2025-06-25 21:40:16,164 - INFO - orders - Generated stoploss_id: 2685036772 for order 5942819337
2025-06-25 21:40:16,178 - INFO - orders - User 6 is_barclays_live_user: False
2025-06-25 21:40:16,178 - INFO - orders - Non-Barclays user. Adding stoploss to order 5942819337 immediately
2025-06-25 21:40:16,230 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:40:16,230 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:40:16,245 - INFO - orders - Fetched 1 open orders for user 6
2025-06-25 21:40:16,259 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:40:16,268 - INFO - orders - Updated static orders cache for user 6 with 1 open orders and 0 pending orders
2025-06-25 21:40:16,973 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:16,973 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:16,974 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:16,992 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:16,993 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:16,994 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:17,011 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:17,012 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:17,012 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:18,053 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:18,113 - INFO - orders - [SLTP_CHECK] Checking order 5942819337: symbol=AUDJPY, type=BUY, stop_loss=94.42100000, take_profit=None, user_id=6
2025-06-25 21:40:18,133 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'decimal.Decimal'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'NoneType'>
2025-06-25 21:40:18,133 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.42100, stop_loss_n=94.42100, adjusted_buy_price_n=94.52700, take_profit_n=None
2025-06-25 21:40:18,136 - INFO - orders - [SLTP_DEBUG] BUY SL: adjusted_sell_price_n=94.42100, stop_loss_n=94.42100, price_diff=0.00000, epsilon=0.00001
2025-06-25 21:40:18,136 - INFO - orders - [SLTP_DEBUG] BUY SL triggered: (adjusted_sell_price_n <= stop_loss_n)=True, (price_diff < epsilon)=True, sl_triggered=True
2025-06-25 21:40:18,136 - INFO - orders - [SLTP_CHECK] Order 5942819337 SL triggered: True, TP triggered: False
2025-06-25 21:40:18,136 - INFO - orders - [SLTP_TRIGGER] Triggering stop_loss for order 5942819337 (user 6, symbol AUDJPY, type BUY)
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 353): Type=BUY, Qty=0.01000000, StoredMargin=6.52413841
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.413841
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.413841')], HighestMarginPerLot=652.413841
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.52, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 0
2025-06-25 21:40:18,156 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDJPY. Returning zero margin.
2025-06-25 21:40:18,184 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -42.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 5942819337)
2025-06-25 21:40:18,184 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:40:18,186 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:40:18,187 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:40:18,187 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:40:18,189 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7760000000'), 'o': Decimal('144.7730000000')}
2025-06-25 21:40:18,190 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7760000000
2025-06-25 21:40:18,190 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -42.000000000000000000000000 JPY / 144.7760000000 = -0.2901033320439851909156213737 USD
2025-06-25 21:40:18,313 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:40:18,313 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:40:18,345 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:40:18,356 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:40:18,361 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 0 pending orders
2025-06-25 21:40:18,407 - INFO - orders - [SLTP_TRIGGER] Successfully closed order 5942819337 due to stop_loss trigger with robust margin/wallet logic.
2025-06-25 21:40:18,407 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 1 demo orders
2025-06-25 21:40:19,688 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:19,689 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:19,689 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:19,697 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:19,697 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:19,697 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:19,711 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:19,711 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:19,711 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:23,420 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:23,493 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:40:23,983 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:23,983 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:23,984 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:23,993 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:23,994 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:23,994 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:24,001 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:24,001 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:24,002 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:26,486 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:26,487 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:26,487 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:26,503 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:26,505 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:26,505 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:26,526 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:26,527 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:26,527 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:27,406 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:27,407 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:27,407 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:27,776 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDJPY, Type: BUY, Quantity: 0.01
2025-06-25 21:40:27,787 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:40:27,787 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:40:27,787 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:40:28,091 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDJPY BUY order, quantity: 0.01
2025-06-25 21:40:28,091 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDJPY: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:40:28,384 - INFO - orders - [ORDER_MARGIN_CALC] Got BUY price for AUDJPY from cache: 94.5300000000
2025-06-25 21:40:28,385 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDJPY:
2025-06-25 21:40:28,385 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:40:28,385 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 94.5300000000) / 100.00 = 945.300000000000000000 (rounded to 945.30)
2025-06-25 21:40:28,385 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDJPY: type=0, value_type=0, rate=10.0000
2025-06-25 21:40:28,385 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:40:28,385 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDJPY: JPY
2025-06-25 21:40:28,385 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from JPY to USD: 945.30 JPY
2025-06-25 21:40:28,385 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 945.30 JPY to USD for margin for AUDJPY BUY order (user_id: 6, position: )
2025-06-25 21:40:28,386 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:40:28,388 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:40:28,388 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:40:28,388 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:40:28,390 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7760000000'), 'o': Decimal('144.7730000000')}
2025-06-25 21:40:28,390 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7760000000
2025-06-25 21:40:28,390 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 945.30 JPY / 144.7760000000 = 6.529397137647123832679449633 USD
2025-06-25 21:40:28,390 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 945.30 JPY -> 6.529397137647123832679449633 USD
2025-06-25 21:40:28,390 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDJPY BUY: margin=6.529397137647123832679449633, price=94.5300000000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:40:28,390 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDJPY: Calculated commission=0.10
2025-06-25 21:40:28,399 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 0
2025-06-25 21:40:28,399 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDJPY. Returning zero margin.
2025-06-25 21:40:28,399 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:40:28,400 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: None): Type=BUY, Qty=0.01, StoredMargin=6.529397137647123832679449633
2025-06-25 21:40:28,400 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.9397137647123832679449633
2025-06-25 21:40:28,400 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01
2025-06-25 21:40:28,400 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.9397137647123832679449633')], HighestMarginPerLot=652.9397137647123832679449633
2025-06-25 21:40:28,401 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.53, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:40:28,401 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDJPY: MarginBefore=0.00, MarginAfter=6.53, AdditionalMargin=6.53
2025-06-25 21:40:28,401 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDJPY
2025-06-25 21:40:28,401 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.529397137647123832679449633
2025-06-25 21:40:28,401 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 0
2025-06-25 21:40:28,401 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 0.0
2025-06-25 21:40:28,401 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 6.53
2025-06-25 21:40:28,402 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 6.53
2025-06-25 21:40:28,420 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=0E-8, CalculatedNewMargin=6.53
2025-06-25 21:40:28,490 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '5493703625', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDJPY', 'order_type': 'BUY', 'order_price': Decimal('94.5300000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.529397137647123832679449633'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:40:28,537 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 6.53000000
2025-06-25 21:40:28,556 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:28,600 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:40:28,605 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:40:29,749 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:40:29,758 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:40:29,758 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:40:29,766 - INFO - orders - Fetched 1 open orders for user 6
2025-06-25 21:40:29,797 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:40:29,808 - INFO - orders - Updated static orders cache for user 6 with 1 open orders and 0 pending orders
2025-06-25 21:40:30,056 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:30,056 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:30,056 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:30,072 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:30,072 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:30,072 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:30,083 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:30,084 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:30,084 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:32,581 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:32,581 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:32,581 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:32,589 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:32,590 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:32,590 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:32,599 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:32,600 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:32,600 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:33,041 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:33,041 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:33,042 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:33,615 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:33,640 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:40:34,090 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:34,090 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:34,091 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:34,101 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:34,101 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:34,101 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:34,109 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:34,110 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:34,110 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:34,548 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:34,548 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:34,549 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:35,616 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:35,616 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:35,616 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:35,625 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:35,625 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:35,625 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:35,634 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:35,634 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:35,634 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:36,319 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:36,319 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:36,320 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:38,044 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:38,044 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:38,044 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:38,067 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:38,068 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:38,068 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:38,078 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=9, user_type=live, group_name=Group B, free_margin=9547.806794185728152923314334, margin_level=147215.6670906891857153053056, balance=10000.00000000, equity=9554.296794185728152923314334
2025-06-25 21:40:38,083 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:38,084 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:38,084 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:38,651 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:38,676 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:40:38,818 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:38,818 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:38,818 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:39,532 - INFO - orders - Add takeprofit request received - Order ID: 5493703625, User ID: 6
2025-06-25 21:40:39,571 - INFO - orders - Generated takeprofit_id: 3813454086 for order 5493703625
2025-06-25 21:40:39,587 - INFO - orders - User 6 is_barclays_live_user: False
2025-06-25 21:40:39,587 - INFO - orders - Non-Barclays user. Adding takeprofit to order 5493703625 immediately
2025-06-25 21:40:39,655 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:40:39,656 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:40:39,673 - INFO - orders - Fetched 1 open orders for user 6
2025-06-25 21:40:39,688 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:40:39,698 - INFO - orders - Updated static orders cache for user 6 with 1 open orders and 0 pending orders
2025-06-25 21:40:40,040 - INFO - orders - [PENDING_ORDER_EXECUTION][PORTFOLIO_UPDATE] user_id=6, user_type=demo, group_name=Group B, free_margin=99968.47877329428504330768487, margin_level=1531010.854108641424859229477, balance=99975.91000000, equity=99975.00877329428504330768487
2025-06-25 21:40:40,734 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:40,734 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:40,735 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:40,755 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:40,755 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:40,756 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:40,778 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:40,778 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:40,779 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:41,522 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:41,522 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:41,522 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:43,033 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:43,035 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:43,036 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:43,072 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:43,072 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:43,074 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:43,158 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:43,159 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:43,159 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:43,741 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:43,768 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=94.53100000, user_id=6
2025-06-25 21:40:43,791 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:40:43,791 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41400, stop_loss_n=None, adjusted_buy_price_n=94.52200, take_profit_n=94.53100
2025-06-25 21:40:43,791 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=94.41400, take_profit_n=94.53100, price_diff=0.11700, epsilon=0.00001
2025-06-25 21:40:43,792 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:40:43,792 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: False, TP triggered: False
2025-06-25 21:40:43,792 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 5493703625. Skipping.
2025-06-25 21:40:43,792 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 1 demo orders
2025-06-25 21:40:43,957 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:43,958 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:43,958 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:45,207 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:45,207 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:45,208 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:45,218 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:45,218 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:45,218 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:45,226 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:45,226 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:45,226 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:45,834 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:45,835 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:45,836 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:48,835 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:48,870 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=94.53100000, user_id=6
2025-06-25 21:40:48,890 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:40:48,890 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41400, stop_loss_n=None, adjusted_buy_price_n=94.52000, take_profit_n=94.53100
2025-06-25 21:40:48,890 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=94.41400, take_profit_n=94.53100, price_diff=0.11700, epsilon=0.00001
2025-06-25 21:40:48,890 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:40:48,890 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: False, TP triggered: False
2025-06-25 21:40:48,891 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 5493703625. Skipping.
2025-06-25 21:40:48,891 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 1 demo orders
2025-06-25 21:40:48,932 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:48,932 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:48,933 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:48,943 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:48,943 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:48,943 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:48,953 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:48,953 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:48,954 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:49,527 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:49,527 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:49,527 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:51,247 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:51,248 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:51,248 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:51,263 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:51,263 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:51,263 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:51,275 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:51,276 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:51,276 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:51,548 - INFO - orders - Order placement request received - User ID: 6, Symbol: AUDCAD, Type: BUY, Quantity: 0.01
2025-06-25 21:40:51,560 - INFO - orders - [DEBUG] group_settings_cache: {'sending_orders': 'barclays'}
2025-06-25 21:40:51,560 - INFO - orders - [DEBUG] sending_orders_cache value: barclays (type: <class 'str'>)
2025-06-25 21:40:51,560 - INFO - orders - Order placement: user_id=6, is_barclays_live_user=False, user_type=demo, group_name=Group B, sending_orders_setting=barclays
2025-06-25 21:40:51,946 - INFO - orders - [ORDER_MARGIN_CALC] Calculating margin for AUDCAD BUY order, quantity: 0.01
2025-06-25 21:40:51,946 - INFO - orders - [ORDER_MARGIN_CALC] Contract size for AUDCAD: 100000.00000000 (raw: 100000.00000000, type: <class 'decimal.Decimal'>)
2025-06-25 21:40:51,963 - INFO - orders - [ORDER_MARGIN_CALC] Got BUY price for AUDCAD from cache: 0.8950200000
2025-06-25 21:40:51,963 - INFO - orders - [ORDER_MARGIN_CALC] Contract value calculation for AUDCAD:
2025-06-25 21:40:51,964 - INFO - orders - [ORDER_MARGIN_CALC] Contract value = quantity * contract_size = 0.01 * 100000.00000000 = 1000.0000000000
2025-06-25 21:40:51,965 - INFO - orders - [ORDER_MARGIN_CALC] Margin calculation: (contract_value * price) / leverage = (1000.0000000000 * 0.8950200000) / 100.00 = 8.950200000000000000 (rounded to 8.95)
2025-06-25 21:40:51,965 - INFO - orders - [ORDER_MARGIN_CALC] Commission settings for AUDCAD: type=0, value_type=0, rate=10.0000
2025-06-25 21:40:51,967 - INFO - orders - [ORDER_MARGIN_CALC] Per lot commission: 0.01 * 10.0000 = 0.100000
2025-06-25 21:40:51,967 - INFO - orders - [ORDER_MARGIN_CALC] Profit currency for AUDCAD: CAD
2025-06-25 21:40:51,967 - INFO - orders - [ORDER_MARGIN_CALC] Converting margin from CAD to USD: 8.95 CAD
2025-06-25 21:40:51,968 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 8.95 CAD to USD for margin for AUDCAD BUY order (user_id: 6, position: )
2025-06-25 21:40:51,968 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CADUSD
2025-06-25 21:40:51,973 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:40:51,974 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CADUSD, trying inverse
2025-06-25 21:40:51,974 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCAD
2025-06-25 21:40:51,981 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('1.3717500000'), 'o': Decimal('1.3717100000')}
2025-06-25 21:40:51,981 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 1.3717500000
2025-06-25 21:40:51,981 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 8.95 CAD / 1.3717500000 = 6.524512484053216694004009477 USD
2025-06-25 21:40:51,981 - INFO - orders - [ORDER_MARGIN_CALC] Margin after USD conversion: 8.95 CAD -> 6.524512484053216694004009477 USD
2025-06-25 21:40:51,982 - INFO - orders - [ORDER_MARGIN_CALC] Final results for AUDCAD BUY: margin=6.524512484053216694004009477, price=0.8950200000, contract_value=1000.0000000000, commission=0.10
2025-06-25 21:40:51,982 - app.services.order_processing - INFO - [COMMISSION_CALC] User 6 Symbol AUDCAD: Calculated commission=0.10
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDCAD, Positions count: 0
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDCAD. Returning zero margin.
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDCAD, Positions count: 1
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDCAD, Pos 1 (ID: None): Type=BUY, Qty=0.01, StoredMargin=6.524512484053216694004009477
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDCAD, Pos 1: MarginPerLot=652.4512484053216694004009477
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDCAD: TotalBuyQty=0.01, TotalSellQty=0, NetQty=0.01
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.4512484053216694004009477')], HighestMarginPerLot=652.4512484053216694004009477
2025-06-25 21:40:51,987 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDCAD: CalculatedTotalMargin=6.52, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:40:51,988 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6 Symbol AUDCAD: MarginBefore=0.00, MarginAfter=6.52, AdditionalMargin=6.52
2025-06-25 21:40:51,988 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] User 6 Symbol AUDCAD
2025-06-25 21:40:51,988 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Full margin for this order: 6.524512484053216694004009477
2025-06-25 21:40:51,988 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Existing open orders count: 0
2025-06-25 21:40:51,988 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin before: 0.0
2025-06-25 21:40:51,988 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Total margin after: 6.52
2025-06-25 21:40:51,988 - app.services.order_processing - INFO - [MARGIN_PROCESS_DEBUG] Additional margin needed: 6.52
2025-06-25 21:40:52,002 - app.services.order_processing - INFO - [MARGIN_PROCESS] User 6: OriginalMarginDB=6.53000000, CalculatedNewMargin=13.05
2025-06-25 21:40:52,056 - INFO - orders - [PRE-CRUD] About to call create_order with: {'order_id': '8568913187', 'order_status': 'OPEN', 'order_user_id': 6, 'order_company_name': 'AUDCAD', 'order_type': 'BUY', 'order_price': Decimal('0.8950200000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('1000.0000000000'), 'margin': Decimal('6.524512484053216694004009477'), 'commission': Decimal('0.10'), 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'status': 'OPEN'}
2025-06-25 21:40:52,110 - INFO - orders - [MARGIN_COMMIT_CHECK] User 6 margin in session BEFORE commit: 13.05000000
2025-06-25 21:40:52,146 - INFO - orders - User data cache updated for user 6 after placing order
2025-06-25 21:40:52,505 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:52,507 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:52,507 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:53,413 - INFO - orders - Portfolio cache updated and websocket event published for user 6 after placing order.
2025-06-25 21:40:53,418 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:40:53,418 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:40:53,425 - INFO - orders - Fetched 2 open orders for user 6
2025-06-25 21:40:53,463 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:40:53,485 - INFO - orders - Updated static orders cache for user 6 with 2 open orders and 0 pending orders
2025-06-25 21:40:53,898 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:53,927 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=94.53100000, user_id=6
2025-06-25 21:40:53,956 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:40:53,956 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41600, stop_loss_n=None, adjusted_buy_price_n=94.52200, take_profit_n=94.53100
2025-06-25 21:40:53,957 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=94.41600, take_profit_n=94.53100, price_diff=0.11500, epsilon=0.00001
2025-06-25 21:40:53,957 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:40:53,957 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: False, TP triggered: False
2025-06-25 21:40:53,957 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 5493703625. Skipping.
2025-06-25 21:40:53,957 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 1 demo orders
2025-06-25 21:40:54,073 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:54,080 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:54,080 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:54,100 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:54,100 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:54,100 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:54,124 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:54,124 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:54,125 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:56,688 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:56,689 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:56,689 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:56,700 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:56,700 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:56,701 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:56,708 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:56,709 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:56,709 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:57,274 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:57,275 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:57,275 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:40:58,618 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:40:58,618 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:58,618 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:40:58,624 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:40:58,625 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:58,626 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:40:58,631 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:40:58,632 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:40:58,632 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:40:58,970 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:40:58,995 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=94.53100000, user_id=6
2025-06-25 21:40:59,025 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:40:59,025 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41500, stop_loss_n=None, adjusted_buy_price_n=94.52200, take_profit_n=94.53100
2025-06-25 21:40:59,026 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=94.41500, take_profit_n=94.53100, price_diff=0.11600, epsilon=0.00001
2025-06-25 21:40:59,026 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:40:59,026 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: False, TP triggered: False
2025-06-25 21:40:59,026 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 5493703625. Skipping.
2025-06-25 21:40:59,026 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 1 demo orders
2025-06-25 21:40:59,182 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:40:59,182 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:40:59,183 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:00,346 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:00,347 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:00,347 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:00,357 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:00,357 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:00,357 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:00,366 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:00,367 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:00,367 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:00,829 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:00,830 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:00,830 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:00,938 - INFO - orders - Add takeprofit request received - Order ID: 8568913187, User ID: 6
2025-06-25 21:41:00,963 - INFO - orders - Generated takeprofit_id: 4033498582 for order 8568913187
2025-06-25 21:41:00,972 - INFO - orders - User 6 is_barclays_live_user: False
2025-06-25 21:41:00,972 - INFO - orders - Non-Barclays user. Adding takeprofit to order 8568913187 immediately
2025-06-25 21:41:01,040 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:41:01,040 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:41:01,056 - INFO - orders - Fetched 2 open orders for user 6
2025-06-25 21:41:01,068 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:41:01,080 - INFO - orders - Updated static orders cache for user 6 with 2 open orders and 0 pending orders
2025-06-25 21:41:02,938 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:02,938 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:02,938 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:04,046 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:41:04,062 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=94.53100000, user_id=6
2025-06-25 21:41:04,082 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:41:04,082 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41600, stop_loss_n=None, adjusted_buy_price_n=94.52300, take_profit_n=94.53100
2025-06-25 21:41:04,083 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=94.41600, take_profit_n=94.53100, price_diff=0.11500, epsilon=0.00001
2025-06-25 21:41:04,083 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:41:04,084 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: False, TP triggered: False
2025-06-25 21:41:04,085 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 5493703625. Skipping.
2025-06-25 21:41:04,085 - INFO - orders - [SLTP_CHECK] Checking order 8568913187: symbol=AUDCAD, type=BUY, stop_loss=None, take_profit=0.89505000, user_id=6
2025-06-25 21:41:04,097 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:41:04,097 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=0.89503, stop_loss_n=None, adjusted_buy_price_n=0.89503, take_profit_n=0.89505
2025-06-25 21:41:04,097 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=0.89503, take_profit_n=0.89505, price_diff=0.00002, epsilon=0.00001
2025-06-25 21:41:04,097 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:41:04,098 - INFO - orders - [SLTP_CHECK] Order 8568913187 SL triggered: False, TP triggered: False
2025-06-25 21:41:04,098 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 8568913187. Skipping.
2025-06-25 21:41:04,098 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 2 demo orders
2025-06-25 21:41:04,690 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:04,690 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:04,690 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:04,698 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:04,698 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:04,698 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:04,708 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:04,708 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:04,708 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:05,025 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:05,026 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:05,026 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:07,151 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:07,151 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:07,151 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:07,157 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:07,157 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:07,157 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:07,165 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:07,165 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:07,165 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:07,539 - INFO - orders - Add stoploss request received - Order ID: 8568913187, User ID: 6
2025-06-25 21:41:07,559 - INFO - orders - Generated stoploss_id: 1762261028 for order 8568913187
2025-06-25 21:41:07,569 - INFO - orders - User 6 is_barclays_live_user: False
2025-06-25 21:41:07,569 - INFO - orders - Non-Barclays user. Adding stoploss to order 8568913187 immediately
2025-06-25 21:41:07,942 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:41:07,942 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:41:07,983 - INFO - orders - Fetched 2 open orders for user 6
2025-06-25 21:41:08,012 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:41:08,019 - INFO - orders - Updated static orders cache for user 6 with 2 open orders and 0 pending orders
2025-06-25 21:41:09,111 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:41:09,136 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=94.53100000, user_id=6
2025-06-25 21:41:09,155 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:41:09,155 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41600, stop_loss_n=None, adjusted_buy_price_n=94.52200, take_profit_n=94.53100
2025-06-25 21:41:09,155 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=94.41600, take_profit_n=94.53100, price_diff=0.11500, epsilon=0.00001
2025-06-25 21:41:09,156 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:41:09,156 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: False, TP triggered: False
2025-06-25 21:41:09,156 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 5493703625. Skipping.
2025-06-25 21:41:09,156 - INFO - orders - [SLTP_CHECK] Checking order 8568913187: symbol=AUDCAD, type=BUY, stop_loss=0.89501000, take_profit=0.89505000, user_id=6
2025-06-25 21:41:09,172 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'decimal.Decimal'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:41:09,174 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=0.89503, stop_loss_n=0.89501, adjusted_buy_price_n=0.89503, take_profit_n=0.89505
2025-06-25 21:41:09,174 - INFO - orders - [SLTP_DEBUG] BUY SL: adjusted_sell_price_n=0.89503, stop_loss_n=0.89501, price_diff=0.00002, epsilon=0.00001
2025-06-25 21:41:09,174 - INFO - orders - [SLTP_DEBUG] BUY SL triggered: (adjusted_sell_price_n <= stop_loss_n)=False, (price_diff < epsilon)=False, sl_triggered=False
2025-06-25 21:41:09,175 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=0.89503, take_profit_n=0.89505, price_diff=0.00002, epsilon=0.00001
2025-06-25 21:41:09,175 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:41:09,175 - INFO - orders - [SLTP_CHECK] Order 8568913187 SL triggered: False, TP triggered: False
2025-06-25 21:41:09,175 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 8568913187. Skipping.
2025-06-25 21:41:09,175 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 2 demo orders
2025-06-25 21:41:09,423 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:09,424 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:09,424 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:09,433 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:09,434 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:09,434 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:09,447 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:09,447 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:09,447 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:09,891 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:09,891 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:09,891 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:11,883 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:11,883 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:11,884 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:11,891 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:11,891 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:11,891 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:11,897 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:11,897 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:11,898 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:12,220 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:12,220 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:12,220 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:13,946 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:13,946 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:13,946 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:13,958 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:13,958 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:13,958 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:13,967 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:13,967 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:13,967 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:14,203 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:41:14,273 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=94.53100000, user_id=6
2025-06-25 21:41:14,300 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'NoneType'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:41:14,300 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41500, stop_loss_n=None, adjusted_buy_price_n=94.52100, take_profit_n=94.53100
2025-06-25 21:41:14,300 - INFO - orders - [SLTP_DEBUG] BUY TP: adjusted_sell_price_n=94.41500, take_profit_n=94.53100, price_diff=0.11600, epsilon=0.00001
2025-06-25 21:41:14,301 - INFO - orders - [SLTP_DEBUG] BUY TP triggered: (adjusted_sell_price_n >= take_profit_n)=False, (price_diff < epsilon)=False, tp_triggered=False
2025-06-25 21:41:14,301 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: False, TP triggered: False
2025-06-25 21:41:14,301 - INFO - orders - [SLTP_CHECK] No SL/TP trigger for order 5493703625. Skipping.
2025-06-25 21:41:14,301 - INFO - orders - [SLTP_CHECK] Checking order 8568913187: symbol=AUDCAD, type=BUY, stop_loss=0.89501000, take_profit=0.89505000, user_id=6
2025-06-25 21:41:14,319 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'decimal.Decimal'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:41:14,320 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=0.89501, stop_loss_n=0.89501, adjusted_buy_price_n=0.89501, take_profit_n=0.89505
2025-06-25 21:41:14,320 - INFO - orders - [SLTP_DEBUG] BUY SL: adjusted_sell_price_n=0.89501, stop_loss_n=0.89501, price_diff=0.00000, epsilon=0.00001
2025-06-25 21:41:14,320 - INFO - orders - [SLTP_DEBUG] BUY SL triggered: (adjusted_sell_price_n <= stop_loss_n)=True, (price_diff < epsilon)=True, sl_triggered=True
2025-06-25 21:41:14,320 - INFO - orders - [SLTP_CHECK] Order 8568913187 SL triggered: True, TP triggered: False
2025-06-25 21:41:14,320 - INFO - orders - [SLTP_TRIGGER] Triggering stop_loss for order 8568913187 (user 6, symbol AUDCAD, type BUY)
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDCAD, Positions count: 1
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDCAD, Pos 1 (ID: 355): Type=BUY, Qty=0.01000000, StoredMargin=6.52451248
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDCAD, Pos 1: MarginPerLot=652.451248
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDCAD: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDCAD: AllMarginsPerLot=[Decimal('652.451248')], HighestMarginPerLot=652.451248
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDCAD: CalculatedTotalMargin=6.52, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDCAD, Positions count: 0
2025-06-25 21:41:14,338 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDCAD. Returning zero margin.
2025-06-25 21:41:14,364 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -0.010000000000000000000000 CAD to USD for PnL on Close (user_id: 6, position: 8568913187)
2025-06-25 21:41:14,364 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CADUSD
2025-06-25 21:41:14,368 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:41:14,368 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CADUSD, trying inverse
2025-06-25 21:41:14,368 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCAD
2025-06-25 21:41:14,371 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('1.3717500000'), 'o': Decimal('1.3717100000')}
2025-06-25 21:41:14,371 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 1.3717500000
2025-06-25 21:41:14,371 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -0.010000000000000000000000 CAD / 1.3717500000 = -0.007289958082741024239110625114 USD
2025-06-25 21:41:14,531 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:41:14,532 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:41:14,565 - INFO - orders - Fetched 1 open orders for user 6
2025-06-25 21:41:14,577 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:41:14,579 - INFO - orders - Updated static orders cache for user 6 with 1 open orders and 0 pending orders
2025-06-25 21:41:14,603 - INFO - orders - [SLTP_TRIGGER] Successfully closed order 8568913187 due to stop_loss trigger with robust margin/wallet logic.
2025-06-25 21:41:14,604 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 2 demo orders
2025-06-25 21:41:14,632 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:14,633 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:14,633 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:16,090 - INFO - orders - Add stoploss request received - Order ID: 5493703625, User ID: 6
2025-06-25 21:41:16,128 - INFO - orders - Generated stoploss_id: 9339457322 for order 5493703625
2025-06-25 21:41:16,140 - INFO - orders - User 6 is_barclays_live_user: False
2025-06-25 21:41:16,140 - INFO - orders - Non-Barclays user. Adding stoploss to order 5493703625 immediately
2025-06-25 21:41:16,255 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:41:16,256 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:41:16,290 - INFO - orders - Fetched 1 open orders for user 6
2025-06-25 21:41:16,312 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:41:16,322 - INFO - orders - Updated static orders cache for user 6 with 1 open orders and 0 pending orders
2025-06-25 21:41:16,640 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:16,641 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:16,641 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:16,659 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:16,659 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:16,659 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:16,685 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:16,688 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:16,689 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:17,080 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:17,080 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:17,080 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:19,086 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:19,086 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:19,086 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:19,624 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:41:19,643 - INFO - orders - [SLTP_CHECK] Checking order 5493703625: symbol=AUDJPY, type=BUY, stop_loss=94.41500000, take_profit=94.53100000, user_id=6
2025-06-25 21:41:19,661 - INFO - orders - [SLTP_DEBUG] Types: adjusted_sell_price_n=<class 'decimal.Decimal'>, stop_loss_n=<class 'decimal.Decimal'>, adjusted_buy_price_n=<class 'decimal.Decimal'>, take_profit_n=<class 'decimal.Decimal'>
2025-06-25 21:41:19,661 - INFO - orders - [SLTP_DEBUG] Values: adjusted_sell_price_n=94.41300, stop_loss_n=94.41500, adjusted_buy_price_n=94.51900, take_profit_n=94.53100
2025-06-25 21:41:19,661 - INFO - orders - [SLTP_DEBUG] BUY SL: adjusted_sell_price_n=94.41300, stop_loss_n=94.41500, price_diff=0.00200, epsilon=0.00001
2025-06-25 21:41:19,661 - INFO - orders - [SLTP_DEBUG] BUY SL triggered: (adjusted_sell_price_n <= stop_loss_n)=True, (price_diff < epsilon)=False, sl_triggered=True
2025-06-25 21:41:19,661 - INFO - orders - [SLTP_CHECK] Order 5493703625 SL triggered: True, TP triggered: False
2025-06-25 21:41:19,661 - INFO - orders - [SLTP_TRIGGER] Triggering stop_loss for order 5493703625 (user 6, symbol AUDJPY, type BUY)
2025-06-25 21:41:19,692 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 1
2025-06-25 21:41:19,692 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1 (ID: 354): Type=BUY, Qty=0.01000000, StoredMargin=6.52939714
2025-06-25 21:41:19,692 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_POS_DETAIL] User 6, Symbol AUDJPY, Pos 1: MarginPerLot=652.939714
2025-06-25 21:41:19,693 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: TotalBuyQty=0.01000000, TotalSellQty=0, NetQty=0.01000000
2025-06-25 21:41:19,693 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_CALC] User 6, Symbol AUDJPY: AllMarginsPerLot=[Decimal('652.939714')], HighestMarginPerLot=652.939714
2025-06-25 21:41:19,694 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_EXIT] User 6, Symbol AUDJPY: CalculatedTotalMargin=6.53, ContributingOrders=1 (based on individual stored margins)
2025-06-25 21:41:19,694 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB_ENTRY] User 6, Symbol AUDJPY, Positions count: 0
2025-06-25 21:41:19,694 - app.services.order_processing - DEBUG - [MARGIN_TOTAL_CONTRIB] No open positions for User 6, Symbol AUDJPY. Returning zero margin.
2025-06-25 21:41:19,725 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of -117.000000000000000000000000 JPY to USD for PnL on Close (user_id: 6, position: 5493703625)
2025-06-25 21:41:19,725 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: JPYUSD
2025-06-25 21:41:19,730 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-06-25 21:41:19,731 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for JPYUSD, trying inverse
2025-06-25 21:41:19,731 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDJPY
2025-06-25 21:41:19,735 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('144.7780000000'), 'o': Decimal('144.7740000000')}
2025-06-25 21:41:19,735 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 144.7780000000
2025-06-25 21:41:19,736 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: -117.000000000000000000000000 JPY / 144.7780000000 = -0.8081338324883614913868129136 USD
2025-06-25 21:41:19,862 - INFO - orders - Starting update_user_static_orders for user 6, user_type demo
2025-06-25 21:41:19,864 - INFO - orders - Using order model: DemoUserOrder
2025-06-25 21:41:19,876 - INFO - orders - Fetched 0 open orders for user 6
2025-06-25 21:41:19,889 - INFO - orders - Fetched 0 pending orders for user 6
2025-06-25 21:41:19,896 - INFO - orders - Updated static orders cache for user 6 with 0 open orders and 0 pending orders
2025-06-25 21:41:19,953 - INFO - orders - [SLTP_TRIGGER] Successfully closed order 5493703625 due to stop_loss trigger with robust margin/wallet logic.
2025-06-25 21:41:19,954 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 1 demo orders
2025-06-25 21:41:21,143 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:21,144 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:21,144 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:21,155 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:21,155 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:21,155 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:21,169 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:21,170 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:21,170 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:22,056 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:22,056 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:22,056 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:23,094 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:23,095 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:23,095 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:23,104 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:23,105 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:23,105 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:23,121 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:23,122 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:23,122 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:23,639 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:23,639 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:23,639 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.
2025-06-25 21:41:24,990 - INFO - orders - Found 0 pending order keys in Redis
2025-06-25 21:41:25,014 - DEBUG - orders - Completed SL/TP check cycle for 0 live orders and 0 demo orders
2025-06-25 21:41:25,557 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:25,558 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:25,558 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:25,580 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:25,581 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:25,581 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:25,603 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:25,604 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:25,604 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:27,782 - INFO - orders - [SLTP_FLOW] After refresh: order 5733346643 stop_loss=None, take_profit=None
2025-06-25 21:41:27,782 - INFO - orders - [SLTP_CHECK] Checking order 5733346643: symbol=AUDJPY, type=SELL, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:27,782 - INFO - orders - [SLTP_CHECK] Order 5733346643 has no SL/TP set. Skipping.
2025-06-25 21:41:27,802 - INFO - orders - [SLTP_FLOW] After refresh: order 3584262638 stop_loss=None, take_profit=None
2025-06-25 21:41:27,804 - INFO - orders - [SLTP_CHECK] Checking order 3584262638: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:27,804 - INFO - orders - [SLTP_CHECK] Order 3584262638 has no SL/TP set. Skipping.
2025-06-25 21:41:27,823 - INFO - orders - [SLTP_FLOW] After refresh: order 2870742580 stop_loss=None, take_profit=None
2025-06-25 21:41:27,823 - INFO - orders - [SLTP_CHECK] Checking order 2870742580: symbol=AUDJPY, type=BUY, stop_loss=None, take_profit=None, user_id=6
2025-06-25 21:41:27,824 - INFO - orders - [SLTP_CHECK] Order 2870742580 has no SL/TP set. Skipping.
2025-06-25 21:41:29,105 - INFO - orders - [SLTP_FLOW] After refresh: order 8776888990 stop_loss=None, take_profit=None
2025-06-25 21:41:29,105 - INFO - orders - [SLTP_CHECK] Checking order 8776888990: symbol=AUDCHF, type=BUY, stop_loss=None, take_profit=None, user_id=9
2025-06-25 21:41:29,105 - INFO - orders - [SLTP_CHECK] Order 8776888990 has no SL/TP set. Skipping.

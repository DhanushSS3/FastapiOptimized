2025-07-04 03:06:19,349 - INFO - orders - Application starting up - Orders logging initialized
2025-07-04 03:06:19,349 - INFO - orders - SL/TP Epsilon accuracy configured: 0.00001
2025-07-04 03:06:26,607 - INFO - orders - Order placement request received - User: 4, Symbol: AUDCHF, Type: BUY
2025-07-04 03:06:49,212 - INFO - orders - Order placement request received - User: 4, Symbol: AUDCHF, Type: BUY
2025-07-04 03:09:51,346 - INFO - orders - Application starting up - Orders logging initialized
2025-07-04 03:09:51,346 - INFO - orders - SL/TP Epsilon accuracy configured: 0.00001
2025-07-04 03:09:55,476 - INFO - orders - Application starting up - Orders logging initialized
2025-07-04 03:09:55,476 - INFO - orders - SL/TP Epsilon accuracy configured: 0.00001
2025-07-04 03:09:57,412 - INFO - orders - Order placement request received - User: 4, Symbol: AUDCHF, Type: BUY
2025-07-04 03:09:57,781 - INFO - orders - [MARGIN_CALC] Market data for AUDCHF: {'b': '0.5205000000', 'o': '0.5204700000'}
2025-07-04 03:09:57,781 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDCHF, using bid price with spread: bid=0.5205000000, ask=0.52055205000000
2025-07-04 03:09:57,781 - INFO - orders - [MARGIN_CALC] Using prices for AUDCHF: bid=0.5205000000, ask=0.52055205000000
2025-07-04 03:09:57,782 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 5.21 CHF to USD for margin_calculation (user_id: 4, position: None)
2025-07-04 03:09:57,782 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CHFUSD
2025-07-04 03:09:57,783 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-04 03:09:57,783 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CHFUSD, trying inverse
2025-07-04 03:09:57,783 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCHF
2025-07-04 03:09:57,784 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('0.7935200000'), 'o': Decimal('0.7934800000')}
2025-07-04 03:09:57,784 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 0.7935200000
2025-07-04 03:09:57,784 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 5.21 CHF / 0.7935200000 = 6.565682024397620727895957254 USD
2025-07-04 03:09:57,784 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDCHF, Type: BUY, Qty: 0.01, Price: 0.52055205000000, Margin: 6.565682024397620727895957254, Commission: 0.10
2025-07-04 03:09:57,785 - INFO - orders - [PERF] Order processing: 0.3605s
2025-07-04 03:09:57,785 - DEBUG - orders - [DEBUG][create_user_order] Received order_data: {'order_id': '3101929268', 'order_status': 'PROCESSING', 'order_user_id': 4, 'order_company_name': 'AUDCHF', 'order_type': 'BUY', 'order_price': Decimal('0.52055205000000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('520.55'), 'margin': Decimal('6.565682024397620727895957254'), 'commission': Decimal('0.10'), 'status': None, 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'close_id': None}
2025-07-04 03:09:57,785 - DEBUG - orders - [DEBUG][create_user_order] Created OrderActionHistory record for order_id: 3101929268
2025-07-04 03:09:57,805 - INFO - orders - [PERF] Order creation: 0.0207s
2025-07-04 03:09:57,805 - INFO - orders - is_barclays_live_user in place_order: True
2025-07-04 03:09:57,806 - INFO - orders - [BARCLAYS] Scheduling barclays_push in place_order
2025-07-04 03:09:57,806 - INFO - orders - Publishing order update for user 4
2025-07-04 03:09:57,807 - INFO - orders - Publishing user data update for user 4
2025-07-04 03:09:57,807 - INFO - orders - Publishing market data trigger
2025-07-04 03:09:57,808 - INFO - orders - [PERF] TOTAL place_order: 0.3962s
2025-07-04 03:09:57,822 - app.api.v1.endpoints.orders - INFO - User 4: Updated static orders cache after order change - 6 open orders, 0 pending orders
2025-07-04 03:09:57,827 - ERROR - orders - Error updating portfolio: calculate_user_portfolio() missing 1 required positional argument: 'redis_client'
2025-07-04 03:09:57,828 - INFO - orders - [BARCLAYS] barclays_push called in place_order
2025-07-04 03:09:57,829 - DEBUG - orders - [BARCLAYS] Calling send_order_to_firebase with data: {'order_id': '3101929268', 'user_id': 4, 'symbol': 'AUDCHF', 'order_type': 'BUY', 'quantity': 0.01, 'price': 0.52055205, 'status': 'OPEN', 'contract_value': 520.55}
2025-07-04 03:10:06,833 - INFO - orders - Order placement request received - User: 4, Symbol: AUDCHF, Type: BUY
2025-07-04 03:10:07,243 - INFO - orders - [MARGIN_CALC] Market data for AUDCHF: {'b': '0.5205200000', 'o': '0.5204700000'}
2025-07-04 03:10:07,243 - WARNING - orders - [MARGIN_CALC] Missing ask price for AUDCHF, using bid price with spread: bid=0.5205200000, ask=0.52057205200000
2025-07-04 03:10:07,243 - INFO - orders - [MARGIN_CALC] Using prices for AUDCHF: bid=0.5205200000, ask=0.52057205200000
2025-07-04 03:10:07,250 - INFO - orders - [CURRENCY_CONVERT] Starting conversion of 5.21 CHF to USD for margin_calculation (user_id: 4, position: None)
2025-07-04 03:10:07,250 - INFO - orders - [CURRENCY_CONVERT] Trying direct conversion with symbol: CHFUSD
2025-07-04 03:10:07,257 - INFO - orders - [CURRENCY_CONVERT] Direct conversion prices from cache: None
2025-07-04 03:10:07,257 - INFO - orders - [CURRENCY_CONVERT] No direct conversion rate found for CHFUSD, trying inverse
2025-07-04 03:10:07,257 - INFO - orders - [CURRENCY_CONVERT] Trying inverse conversion with symbol: USDCHF
2025-07-04 03:10:07,260 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion prices from cache: {'b': Decimal('0.7935500000'), 'o': Decimal('0.7935200000')}
2025-07-04 03:10:07,260 - INFO - orders - [CURRENCY_CONVERT] Found inverse conversion rate (bid): 0.7935500000
2025-07-04 03:10:07,260 - INFO - orders - [CURRENCY_CONVERT] Inverse conversion successful: 5.21 CHF / 0.7935500000 = 6.565433810093881923004221536 USD
2025-07-04 03:10:07,260 - INFO - orders - [MARGIN_CALC_OPTIMIZED] Symbol: AUDCHF, Type: BUY, Qty: 0.01, Price: 0.52057205200000, Margin: 6.565433810093881923004221536, Commission: 0.10
2025-07-04 03:10:07,265 - INFO - orders - [PERF] Order processing: 0.4290s
2025-07-04 03:10:07,265 - DEBUG - orders - [DEBUG][create_user_order] Received order_data: {'order_id': '8916222505', 'order_status': 'PROCESSING', 'order_user_id': 4, 'order_company_name': 'AUDCHF', 'order_type': 'BUY', 'order_price': Decimal('0.52057205200000'), 'order_quantity': Decimal('0.01'), 'contract_value': Decimal('520.57'), 'margin': Decimal('6.565433810093881923004221536'), 'commission': Decimal('0.10'), 'status': None, 'stop_loss': None, 'take_profit': None, 'stoploss_id': None, 'takeprofit_id': None, 'close_id': None}
2025-07-04 03:10:07,266 - DEBUG - orders - [DEBUG][create_user_order] Created OrderActionHistory record for order_id: 8916222505
2025-07-04 03:10:07,301 - INFO - orders - [PERF] Order creation: 0.0354s
2025-07-04 03:10:07,301 - INFO - orders - is_barclays_live_user in place_order: True
2025-07-04 03:10:07,301 - INFO - orders - [BARCLAYS] Scheduling barclays_push in place_order
2025-07-04 03:10:07,301 - INFO - orders - Publishing order update for user 4
2025-07-04 03:10:07,306 - INFO - orders - Publishing user data update for user 4
2025-07-04 03:10:07,311 - INFO - orders - Publishing market data trigger
2025-07-04 03:10:07,314 - INFO - orders - [PERF] TOTAL place_order: 0.4823s
2025-07-04 03:10:07,389 - app.api.v1.endpoints.orders - INFO - User 4: Updated static orders cache after order change - 6 open orders, 0 pending orders
2025-07-04 03:10:07,398 - ERROR - orders - Error updating portfolio: calculate_user_portfolio() missing 1 required positional argument: 'redis_client'
2025-07-04 03:10:07,403 - INFO - orders - [BARCLAYS] barclays_push called in place_order
2025-07-04 03:10:07,406 - DEBUG - orders - [BARCLAYS] Calling send_order_to_firebase with data: {'order_id': '8916222505', 'user_id': 4, 'symbol': 'AUDCHF', 'order_type': 'BUY', 'quantity': 0.01, 'price': 0.520572052, 'status': 'OPEN', 'contract_value': 520.57}
2025-07-04 03:10:13,542 - INFO - orders - Order close request received - Order ID: 3649865209, User ID: 4, Close Price: 0.52037
2025-07-04 03:10:13,543 - INFO - orders - user_to_operate_on: <app.database.models.User object at 0x000002800B307750>, type: <class 'app.database.models.User'>, user_type: live, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'address_proof', 'address_proof_image', 'bank_account_number', 'bank_branch_name', 'bank_holder_name', 'bank_ifsc_code', 'city', 'country', 'created_at', 'email', 'fund_manager', 'group_name', 'hashed_password', 'id', 'id_proof', 'id_proof_image', 'isActive', 'is_self_trading', 'is_service_account', 'leverage', 'margin', 'metadata', 'money_requests', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'rock_orders', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_favorites', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-07-04 03:10:13,543 - INFO - orders - Using order model: user_orders for user 4 (user_type: live)
2025-07-04 03:10:13,543 - INFO - orders - Request to close order 3649865209 for user 4 (user_type: live) with price 0.52037. Frontend provided type: BUY, company: AUDCHF, status: CLOSED, frontend_status: CLOSED.
2025-07-04 03:10:13,546 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-04 03:10:13,546 - INFO - orders - Live user 4 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-04 03:10:13,547 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '3649865209', 'close_price': '0.52037', 'user_id': 4, 'order_type': 'BUY', 'order_company_name': 'AUDCHF', 'order_quantity': '0.01000000', 'contract_value': '520.31000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '3376757372'}
2025-07-04 03:10:14,086 - INFO - orders - Order close request received - Order ID: 7660709467, User ID: 4, Close Price: 0.89158
2025-07-04 03:10:14,086 - INFO - orders - user_to_operate_on: <app.database.models.User object at 0x000002800B307C50>, type: <class 'app.database.models.User'>, user_type: live, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'address_proof', 'address_proof_image', 'bank_account_number', 'bank_branch_name', 'bank_holder_name', 'bank_ifsc_code', 'city', 'country', 'created_at', 'email', 'fund_manager', 'group_name', 'hashed_password', 'id', 'id_proof', 'id_proof_image', 'isActive', 'is_self_trading', 'is_service_account', 'leverage', 'margin', 'metadata', 'money_requests', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'rock_orders', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_favorites', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-07-04 03:10:14,087 - INFO - orders - Using order model: user_orders for user 4 (user_type: live)
2025-07-04 03:10:14,087 - INFO - orders - Request to close order 7660709467 for user 4 (user_type: live) with price 0.89158. Frontend provided type: SELL, company: AUDCAD, status: CLOSED, frontend_status: CLOSED.
2025-07-04 03:10:14,089 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-04 03:10:14,089 - INFO - orders - Live user 4 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-04 03:10:14,090 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '7660709467', 'close_price': '0.89158', 'user_id': 4, 'order_type': 'SELL', 'order_company_name': 'AUDCAD', 'order_quantity': '0.01000000', 'contract_value': '891.31000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '1550095022'}
2025-07-04 03:10:14,859 - INFO - orders - Order close request received - Order ID: 9836469641, User ID: 4, Close Price: 0.89131
2025-07-04 03:10:14,859 - INFO - orders - user_to_operate_on: <app.database.models.User object at 0x000002800B307750>, type: <class 'app.database.models.User'>, user_type: live, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'address_proof', 'address_proof_image', 'bank_account_number', 'bank_branch_name', 'bank_holder_name', 'bank_ifsc_code', 'city', 'country', 'created_at', 'email', 'fund_manager', 'group_name', 'hashed_password', 'id', 'id_proof', 'id_proof_image', 'isActive', 'is_self_trading', 'is_service_account', 'leverage', 'margin', 'metadata', 'money_requests', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'rock_orders', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_favorites', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-07-04 03:10:14,859 - INFO - orders - Using order model: user_orders for user 4 (user_type: live)
2025-07-04 03:10:14,859 - INFO - orders - Request to close order 9836469641 for user 4 (user_type: live) with price 0.89131. Frontend provided type: BUY, company: AUDCAD, status: CLOSED, frontend_status: CLOSED.
2025-07-04 03:10:14,876 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-04 03:10:14,876 - INFO - orders - Live user 4 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-04 03:10:14,879 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '9836469641', 'close_price': '0.89131', 'user_id': 4, 'order_type': 'BUY', 'order_company_name': 'AUDCAD', 'order_quantity': '0.01000000', 'contract_value': '891.40000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '2797501321'}
2025-07-04 03:10:15,428 - INFO - orders - Order close request received - Order ID: 5338478143, User ID: 4, Close Price: 0.89133
2025-07-04 03:10:15,428 - INFO - orders - user_to_operate_on: <app.database.models.User object at 0x000002800B306490>, type: <class 'app.database.models.User'>, user_type: live, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'address_proof', 'address_proof_image', 'bank_account_number', 'bank_branch_name', 'bank_holder_name', 'bank_ifsc_code', 'city', 'country', 'created_at', 'email', 'fund_manager', 'group_name', 'hashed_password', 'id', 'id_proof', 'id_proof_image', 'isActive', 'is_self_trading', 'is_service_account', 'leverage', 'margin', 'metadata', 'money_requests', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'rock_orders', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_favorites', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-07-04 03:10:15,428 - INFO - orders - Using order model: user_orders for user 4 (user_type: live)
2025-07-04 03:10:15,428 - INFO - orders - Request to close order 5338478143 for user 4 (user_type: live) with price 0.89133. Frontend provided type: BUY, company: AUDCAD, status: CLOSED, frontend_status: CLOSED.
2025-07-04 03:10:15,430 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-04 03:10:15,430 - INFO - orders - Live user 4 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-04 03:10:15,431 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '5338478143', 'close_price': '0.89133', 'user_id': 4, 'order_type': 'BUY', 'order_company_name': 'AUDCAD', 'order_quantity': '0.01000000', 'contract_value': '891.41000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '3408824136'}
2025-07-04 03:10:15,972 - INFO - orders - Order close request received - Order ID: 6253049859, User ID: 4, Close Price: 0.89158
2025-07-04 03:10:15,972 - INFO - orders - user_to_operate_on: <app.database.models.User object at 0x000002800B307750>, type: <class 'app.database.models.User'>, user_type: live, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'address_proof', 'address_proof_image', 'bank_account_number', 'bank_branch_name', 'bank_holder_name', 'bank_ifsc_code', 'city', 'country', 'created_at', 'email', 'fund_manager', 'group_name', 'hashed_password', 'id', 'id_proof', 'id_proof_image', 'isActive', 'is_self_trading', 'is_service_account', 'leverage', 'margin', 'metadata', 'money_requests', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'rock_orders', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_favorites', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-07-04 03:10:15,972 - INFO - orders - Using order model: user_orders for user 4 (user_type: live)
2025-07-04 03:10:15,972 - INFO - orders - Request to close order 6253049859 for user 4 (user_type: live) with price 0.89158. Frontend provided type: SELL, company: AUDCAD, status: CLOSED, frontend_status: CLOSED.
2025-07-04 03:10:15,977 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-04 03:10:15,977 - INFO - orders - Live user 4 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-04 03:10:15,979 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '6253049859', 'close_price': '0.89158', 'user_id': 4, 'order_type': 'SELL', 'order_company_name': 'AUDCAD', 'order_quantity': '0.01000000', 'contract_value': '891.22000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '9498801186'}
2025-07-04 03:10:16,550 - INFO - orders - Order close request received - Order ID: 5239114834, User ID: 4, Close Price: 0.89133
2025-07-04 03:10:16,550 - INFO - orders - user_to_operate_on: <app.database.models.User object at 0x000002800B307C50>, type: <class 'app.database.models.User'>, user_type: live, attrs: ['__abstract__', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__mapper__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__table__', '__table_args__', '__tablename__', '__weakref__', '_sa_class_manager', '_sa_instance_state', '_sa_registry', 'account_number', 'address_proof', 'address_proof_image', 'bank_account_number', 'bank_branch_name', 'bank_holder_name', 'bank_ifsc_code', 'city', 'country', 'created_at', 'email', 'fund_manager', 'group_name', 'hashed_password', 'id', 'id_proof', 'id_proof_image', 'isActive', 'is_self_trading', 'is_service_account', 'leverage', 'margin', 'metadata', 'money_requests', 'name', 'net_profit', 'orders', 'otps', 'phone_number', 'pincode', 'referred_by_id', 'reffered_code', 'registry', 'rock_orders', 'security_answer', 'security_question', 'state', 'status', 'updated_at', 'user_favorites', 'user_type', 'wallet_balance', 'wallet_transactions']
2025-07-04 03:10:16,550 - INFO - orders - Using order model: user_orders for user 4 (user_type: live)
2025-07-04 03:10:16,550 - INFO - orders - Request to close order 5239114834 for user 4 (user_type: live) with price 0.89133. Frontend provided type: BUY, company: AUDCAD, status: CLOSED, frontend_status: CLOSED.
2025-07-04 03:10:16,555 - INFO - orders - User group: Standard, sending_orders setting: barclays
2025-07-04 03:10:16,555 - INFO - orders - Live user 4 from group 'Standard' has 'sending_orders' set to 'barclays'. Pushing close request to Firebase and skipping local DB update.
2025-07-04 03:10:16,556 - INFO - orders - [FIREBASE_CLOSE_REQUEST] Preparing to send payload for user-initiated close: {'order_id': '5239114834', 'close_price': '0.89133', 'user_id': 4, 'order_type': 'BUY', 'order_company_name': 'AUDCAD', 'order_quantity': '0.01000000', 'contract_value': '891.32000000', 'order_status': 'CLOSED', 'status': 'CLOSED', 'action': 'close_order', 'close_id': '2243829083'}
2025-07-04 03:10:49,313 - INFO - orders - Add stoploss request received - Order ID: 3649865209, User ID: 4
2025-07-04 03:10:49,319 - INFO - orders - Generated stoploss_id: 4103632827 for order 3649865209
2025-07-04 03:10:49,320 - INFO - orders - User 4 is_barclays_live_user: True
2025-07-04 03:10:49,320 - INFO - orders - Barclays user detected. Sending stoploss request to Firebase for order 3649865209
2025-07-04 03:10:49,614 - INFO - orders - Stoploss request sent to Firebase for order 3649865209
2025-07-04 03:10:58,286 - INFO - orders - Add takeprofit request received - Order ID: 3649865209, User ID: 4
2025-07-04 03:10:58,294 - INFO - orders - Generated takeprofit_id: 2556910970 for order 3649865209
2025-07-04 03:10:58,296 - INFO - orders - User 4 is_barclays_live_user: True
2025-07-04 03:10:58,297 - INFO - orders - Barclays user detected. Sending takeprofit request to Firebase for order 3649865209
2025-07-04 03:10:58,611 - INFO - orders - Takeprofit request sent to Firebase for order 3649865209

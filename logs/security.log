2025-06-25 05:17:42,702 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:17:42,702 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:17:42,712 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:17:42,713 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:17:42,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:17:42,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:17:42,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:17:42,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 12, 52, 42, 723775), 'iat': datetime.datetime(2025, 6, 25, 12, 17, 42, 723780)}
2025-06-25 05:17:42,724 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:17:44,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:17:44,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:17:44,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:17:46,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:17:46,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,886 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:17:46,907 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:17:46,907 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,556 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,558 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,558 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,564 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,564 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,564 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,595 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,595 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,596 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,616 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,617 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,618 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,657 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,699 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,700 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:16,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:16,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:16,952 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:16,952 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:16,952 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:16,973 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:16,973 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:16,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:17,001 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:17,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:17,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:17,639 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,639 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,639 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:17,957 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:17,958 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:19,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:19,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:19,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:19,846 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:19,846 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:19,880 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:19,881 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:40,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:40,966 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:40,982 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:40,983 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:48,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:48,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:48,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:48,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:48,215 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:48,229 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:48,229 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:19:17,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:19:17,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:19:17,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:17,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:17,438 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:19:17,448 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:19:17,448 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:19:40,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:19:40,950 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:19:40,951 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:40,951 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:40,952 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:19:40,993 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:19:40,994 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:03,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:20:03,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:20:03,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:03,567 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:03,567 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:20:03,580 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:20:03,581 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:17,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:20:17,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:20:17,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:17,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:17,752 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:20:17,759 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:20:17,760 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:33,499 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:20:33,499 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:27:34,803 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:27:34,804 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:27:34,831 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:27:34,832 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:27:34,847 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:27:34,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:27:34,847 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:27:34,848 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 2, 34, 847575), 'iat': datetime.datetime(2025, 6, 25, 12, 27, 34, 847580)}
2025-06-25 05:27:34,848 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:27:40,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:40,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:40,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:40,817 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:40,817 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:40,837 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:40,838 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,189 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,189 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,191 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,191 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:42,203 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:42,204 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,204 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:42,778 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:42,778 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,420 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:53,428 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:53,428 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,937 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,937 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:27:53,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,943 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,945 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:53,979 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:53,980 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,980 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:10,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:10,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,912 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:10,928 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:10,929 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:14,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:14,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:14,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:14,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:14,734 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:14,753 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:14,753 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:17,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:17,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:17,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:17,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:17,630 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:17,638 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:17,638 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:21,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:21,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:21,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:21,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:21,025 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:21,097 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:21,097 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:28,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:28,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:28,960 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:28,960 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:28,961 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:28,982 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:28,987 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:52,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:52,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:52,990 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:52,990 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:52,990 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:53,006 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:53,006 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:56,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:56,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:56,735 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:56,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:56,736 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:56,749 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:56,750 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:29:32,314 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:29:32,315 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:36:55,622 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:36:55,622 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:36:55,641 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:36:55,641 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:36:55,657 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:36:55,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:36:55,657 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:36:55,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 11, 55, 657819), 'iat': datetime.datetime(2025, 6, 25, 12, 36, 55, 657826)}
2025-06-25 05:36:55,659 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:37:01,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:01,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:01,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:01,780 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:01,780 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,794 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:01,801 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:01,801 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:03,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:03,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:03,349 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:03,349 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:03,349 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:05,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:05,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:05,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:05,294 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:05,294 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:05,302 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:05,303 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,134 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,134 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,135 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,135 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:06,141 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:06,142 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:06,142 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,015 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,015 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,016 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:07,023 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:07,023 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:07,023 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:10,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:10,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:10,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:10,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:10,138 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:10,144 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:10,145 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:19,355 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:19,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,356 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,357 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:19,368 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:19,369 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:25,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:25,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,093 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,093 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:25,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,094 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,095 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:25,102 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:25,103 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:25,103 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:38,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:38,500 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:38,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:38,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:38,501 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:38,508 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:38,509 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:47,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:47,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:47,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:47,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:47,171 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:47,196 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:47,199 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:51,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:51,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:51,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:51,022 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:51,023 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:51,056 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:51,057 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:53,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:53,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:53,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:53,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:53,243 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:53,251 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:53,251 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:54,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:54,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:54,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:54,610 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:54,610 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:54,642 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:54,643 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:05,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:05,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:05,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:05,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:05,046 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:05,081 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:05,081 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:10,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:10,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:10,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:10,158 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:10,158 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:10,175 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:10,175 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:17,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:17,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:17,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:17,440 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:17,441 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:17,478 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:17,478 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:21,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:21,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:21,719 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:21,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:21,720 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:21,742 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:21,743 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:32,117 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:32,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:32,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:32,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:32,120 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:32,137 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:32,138 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:53,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:53,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:53,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:53,460 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:53,460 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:53,480 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:53,481 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:39:12,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:39:12,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:39:12,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:39:12,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:39:12,897 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:39:12,904 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:39:12,904 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:39:14,240 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:39:14,240 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:45:53,395 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:45:53,395 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:45:53,408 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:45:53,409 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:45:53,417 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:45:53,417 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 20, 53, 417133), 'iat': datetime.datetime(2025, 6, 25, 12, 45, 53, 417136)}
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:45:57,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:57,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:57,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:45:57,909 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 05:45:58,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:58,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:58,429 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:45:58,431 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 05:45:58,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:58,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:58,631 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:46:05,201 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:46:05,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:46:05,202 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:46:05,202 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 25, 13, 16, 5, 201548), 'iat': datetime.datetime(2025, 6, 25, 12, 46, 5, 201571)}
2025-06-25 05:46:05,202 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:46:05,202 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE0NjAzNjUsImlhdCI6MTc1MDg1NTU2NX0.nTsRIyyyl0BRDJbFZvzy3H9uOH5qq0KbaabiFbpJEM0, Expiry (seconds): 604800
2025-06-25 05:46:05,208 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 05:46:06,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,674 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,674 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,675 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,685 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,685 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,685 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,700 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,700 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,701 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,701 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,712 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,713 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,713 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,731 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,731 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,763 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,763 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:07,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:07,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:07,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:07,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:07,417 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:07,425 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:07,425 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:07,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:07,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:07,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:09,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:09,347 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,347 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,347 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:09,361 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:09,362 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:09,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:09,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:09,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,387 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,387 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:09,484 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:09,485 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:47:09,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:47:09,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:47:09,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:47:09,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:47:09,523 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:47:09,532 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:47:09,533 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:48:09,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:48:09,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:48:09,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:48:09,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:48:09,530 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:48:09,545 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:48:09,546 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:52:31,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:52:31,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:52:31,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:52:31,554 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:52:31,554 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:52:31,566 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:52:31,566 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:53:57,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:53:57,593 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:53:57,600 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:53:57,601 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:54:02,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:54:02,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:54:02,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:02,866 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:02,866 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:54:02,874 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:54:02,874 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:54:09,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:54:09,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:54:09,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:09,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:09,517 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:54:09,522 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:54:09,522 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:55:03,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:55:03,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:55:03,531 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:03,531 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:03,531 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:55:03,544 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:55:03,545 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:09,601 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:09,601 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:55:09,605 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:55:09,606 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:03,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:03,732 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:56:03,738 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:56:03,738 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:25,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:25,845 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:56:25,849 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:56:25,849 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:14:05,406 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:05,407 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:07,489 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:14:07,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:14:07,489 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:14:07,489 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 4, 49, 7, 489333), 'iat': datetime.datetime(2025, 6, 26, 4, 14, 7, 489337)}
2025-06-25 21:14:07,490 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:14:25,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,232 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,234 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,244 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,246 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,276 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,284 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,347 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,347 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,348 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,352 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:28,907 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:28,907 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:59,122 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:59,123 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:59,146 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-06-25 21:14:59,154 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-06-25 21:14:59,155 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:15:00,287 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:15:00,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:15:00,288 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:15:00,288 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 4, 45, 0, 287909), 'iat': datetime.datetime(2025, 6, 26, 4, 15, 0, 287917)}
2025-06-25 21:15:00,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:15:00,291 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MTYxMDAsImlhdCI6MTc1MDkxMTMwMH0.CXeMYmz-n8w8EUA68tjEEBa3pQYM6H6vxNpSBj-wHKQ, Expiry (seconds): 604800
2025-06-25 21:15:00,294 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,408 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,408 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,409 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,418 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,418 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,418 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,570 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,571 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:15:01,571 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,571 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,572 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,572 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,575 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,605 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,605 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,639 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,639 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,639 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,666 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,667 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:02,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:02,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:02,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:02,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:02,848 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:02,863 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:02,863 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:02,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:02,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:02,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:03,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,271 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:03,421 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:03,421 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:04,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:04,808 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:04,833 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:04,833 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:46,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:46,919 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:46,924 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:46,924 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:03,685 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:03,685 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:03,692 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:03,692 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,775 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,775 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,782 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,782 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,835 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,835 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,837 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,850 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,850 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,850 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,864 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,864 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,865 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,875 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,876 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,876 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,186 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,186 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,186 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:15,192 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:15,192 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,863 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:15,869 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:15,869 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:17,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:17,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,007 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:17,016 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:17,016 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:17:16,534 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:17:16,534 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:17:16,541 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:17:16,541 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:17:51,872 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:17:51,872 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:17:51,887 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:17:51,887 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:17:51,897 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:17:51,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:17:51,897 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:17:51,897 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 4, 52, 51, 897837), 'iat': datetime.datetime(2025, 6, 26, 4, 17, 51, 897840)}
2025-06-25 21:17:51,898 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:18:08,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:08,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:08,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,820 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:14,825 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:14,825 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:28,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:28,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:28,604 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:28,604 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:28,605 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,373 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,373 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,374 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:33,380 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:33,380 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:33,380 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:08,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:08,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:08,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:08,176 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:08,176 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:08,180 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:08,180 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:14,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:14,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:14,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:14,770 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:14,770 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:14,774 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:14,774 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:18,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:18,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:18,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:18,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:18,401 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:18,414 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:18,415 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:20:15,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:20:15,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:20:15,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:15,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:15,872 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:20:15,877 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:20:15,878 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:20:52,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:20:52,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:20:52,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:52,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:52,150 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:20:52,162 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:20:52,162 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:21:17,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:21:17,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:21:17,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:21:17,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:21:17,513 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:21:17,533 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:21:17,534 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:10,287 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:10,287 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:10,309 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:10,313 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:14,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:14,776 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:14,792 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:14,793 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:26,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:26,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:26,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:26,190 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:26,190 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:26,235 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:26,235 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:23:16,427 - INFO - app.core.security - Closing Redis connection...
2025-06-25 21:23:16,427 - INFO - app.core.security - Redis connection closed.
2025-06-25 21:31:36,649 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:31:36,649 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:31:36,665 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:31:36,665 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:31:36,676 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:31:36,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:31:36,676 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:31:36,676 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 6, 36, 676612), 'iat': datetime.datetime(2025, 6, 26, 4, 31, 36, 676614)}
2025-06-25 21:31:36,677 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:31:38,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:38,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:38,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:47,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:47,973 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,974 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,974 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:31:47,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:47,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:47,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,975 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,975 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:31:47,999 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:31:48,001 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:48,005 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:52,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,431 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,431 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:52,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:52,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,432 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,433 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:31:52,443 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:31:52,444 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:52,444 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:01,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:01,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:01,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:01,490 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:01,491 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:01,506 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:01,507 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:05,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:05,612 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:05,615 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:05,615 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,119 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,119 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:06,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,120 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:06,130 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:06,130 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:06,130 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:15,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:15,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:15,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:15,676 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:15,676 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:15,680 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:15,680 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:34,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:34,528 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:34,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:34,529 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:34,529 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:34,531 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:34,531 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:45,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:45,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:45,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:45,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:45,472 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:45,483 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:45,484 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:53,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:53,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:53,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:53,786 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:53,786 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:53,791 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:53,791 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:54,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:54,071 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:54,082 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:54,083 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:00,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:00,565 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:00,568 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:00,568 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:05,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:05,053 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:05,055 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:05,055 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:14,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:14,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:14,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:14,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:14,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:14,781 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:14,782 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:45,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:45,783 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:45,789 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:45,789 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:54,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:54,299 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:54,302 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:54,302 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,051 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,051 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:05,055 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:05,055 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,102 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,102 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:05,106 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:05,106 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:14,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:14,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:14,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:14,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:14,772 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:14,779 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:14,779 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:15,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:15,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:15,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:15,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:15,371 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:15,391 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:15,391 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:19,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:19,777 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:19,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:19,778 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:19,778 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:19,794 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:19,795 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:23,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:23,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:23,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:23,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:23,036 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:23,048 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:23,048 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:27,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:27,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:27,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:27,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:27,017 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:27,027 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:27,028 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:33,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:33,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:33,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:33,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:33,179 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:33,193 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:33,193 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:39,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:39,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,784 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,784 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:39,785 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,785 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,785 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:40,092 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:40,092 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,092 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:40,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,846 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,846 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:40,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,847 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,847 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:40,857 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:40,857 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,857 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:42,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:42,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:42,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,290 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,291 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:42,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:42,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:42,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,292 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,292 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:42,300 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:42,300 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:42,300 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,216 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,216 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:43,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:43,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:43,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,217 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,217 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:43,230 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:43,230 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:43,231 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,963 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,963 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:44,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:44,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,964 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,964 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:44,975 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:44,977 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:44,977 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,078 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,078 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,079 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,079 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,094 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,095 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,095 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,104 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,104 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,106 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,106 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,106 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,122 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,122 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,907 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,908 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,908 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:46,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,908 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,909 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,909 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,920 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,920 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,921 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,740 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:48,748 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:48,748 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:48,748 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,865 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:50,873 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:50,873 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:50,874 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:54,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:54,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:54,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:54,579 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:54,579 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:54,588 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:54,589 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:05,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:05,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:05,127 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:05,127 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:05,127 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:05,140 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:05,143 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:14,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:14,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:14,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:14,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:14,776 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:14,783 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:14,783 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:45,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:45,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:45,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:45,481 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:45,481 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:45,494 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:45,494 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:54,068 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:54,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:54,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:54,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:54,071 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:54,090 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:54,090 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:36:05,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:36:05,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:36:05,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:05,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:05,065 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:36:05,091 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:36:05,092 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:36:14,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:36:14,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:36:14,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:14,801 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:14,801 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:36:14,817 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:36:14,817 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:37:17,822 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:37:17,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:37:17,823 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:37:17,823 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:37:17,823 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:37:17,878 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:37:17,879 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:02,406 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:02,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:02,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:02,412 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:02,412 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:02,443 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:02,443 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:04,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:04,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:04,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:04,552 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:04,552 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:04,566 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:04,567 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:48,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:48,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:48,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:48,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:48,295 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:48,337 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:48,343 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:50,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:50,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:50,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:50,354 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:50,354 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:50,390 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:50,390 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:57,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:57,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:57,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,242 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,243 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:57,259 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:57,260 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:57,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:57,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:57,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,318 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:57,342 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:57,342 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:02,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:02,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:02,539 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:02,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:02,540 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:02,552 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:02,553 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:05,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:05,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:05,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:05,059 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:05,059 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:05,077 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:05,077 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:14,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:14,783 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:14,796 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:14,797 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:45,468 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:45,469 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:45,487 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:45,487 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:54,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:54,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:54,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:54,084 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:54,084 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:54,140 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:54,140 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:02,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:02,539 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:02,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:02,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:02,541 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:02,558 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:02,558 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:05,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:05,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:05,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:05,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:05,064 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:05,088 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:05,088 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:14,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:14,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:14,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:14,782 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:14,782 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:14,793 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:14,793 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:16,112 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:16,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:16,113 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:16,113 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:16,113 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:16,123 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:16,123 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:27,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:27,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:27,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:27,683 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:27,683 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:27,769 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:27,771 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:39,514 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:39,514 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:39,528 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:39,528 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:45,548 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:45,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:45,549 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:45,550 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:45,552 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:45,560 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:45,560 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:51,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:51,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:51,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:51,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:51,523 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:51,547 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:51,547 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:54,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:54,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:54,089 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:54,089 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:54,089 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:54,111 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:54,111 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:00,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:00,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:00,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:00,893 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:00,893 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:00,936 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:00,937 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:02,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:02,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:02,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:02,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:02,555 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:02,568 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:02,568 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:05,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:05,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:05,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:05,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:05,057 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:05,073 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:05,074 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:07,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:07,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:07,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:07,515 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:07,515 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:07,538 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:07,539 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:14,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:14,863 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:14,922 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:14,923 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:16,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:16,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:16,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:16,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:16,065 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:16,089 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:16,090 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser

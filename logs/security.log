2025-06-29 21:41:10,791 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:41:10,792 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:46,983 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:46,989 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,035 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,038 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,091 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,094 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,127 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,131 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:51,250 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:41:51,250 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 11, 51, 250235), 'iat': datetime.datetime(2025, 6, 30, 4, 41, 51, 250318)}
2025-06-29 21:41:51,251 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:41:51,251 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODYzMzExLCJpYXQiOjE3NTEyNTg1MTF9.txlYB-GgOelNHVtqQfIPVXb8d4MxNkXP7enR6SPHDO8, Expiry (seconds): 604800
2025-06-29 21:41:51,253 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,382 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,383 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,383 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,424 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,456 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,458 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,459 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,473 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,474 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,474 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,515 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,515 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,761 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,761 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:54,084 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:54,085 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:56,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:56,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:56,276 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:56,276 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:42:55,106 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:42:55,106 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:42:55,117 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:42:55,117 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 17, 55, 117158), 'iat': datetime.datetime(2025, 6, 30, 4, 42, 55, 117162)}
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:42:58,672 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,686 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:42:58,689 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:42:58,713 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:43:01,539 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:43:01,539 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:43:01,544 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:43:01,545 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:43:01,554 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:43:01,554 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 18, 1, 554568), 'iat': datetime.datetime(2025, 6, 30, 4, 43, 1, 554572)}
2025-06-29 21:43:01,555 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:43:03,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,497 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,497 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,498 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,506 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,507 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,535 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,535 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,535 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,617 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,617 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,152 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,153 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,702 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,702 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:17,077 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:43:17,080 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:50:42,682 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:50:42,682 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:50:42,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:50:42,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 25, 42, 695996), 'iat': datetime.datetime(2025, 6, 30, 4, 50, 42, 695998)}
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:50:43,705 - INFO - app.core.security - Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:50:44,572 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:50:44,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:51:03,436 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:51:03,436 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:52:01,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:52:01,798 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:52:01,798 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:52:40,338 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:52:40,339 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:58:45,854 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:58:45,854 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:58:45,867 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:58:45,867 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 33, 45, 867752), 'iat': datetime.datetime(2025, 6, 30, 4, 58, 45, 867756)}
2025-06-29 21:58:45,868 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:58:49,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,821 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:58:50,823 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:14,618 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:59:14,619 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:59:31,031 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:59:31,031 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:59:31,047 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:59:31,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:59:31,048 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:59:31,048 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 34, 31, 47709), 'iat': datetime.datetime(2025, 6, 30, 4, 59, 31, 47714)}
2025-06-29 21:59:31,049 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:59:34,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:34,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:34,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:42,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:59:42,578 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:59:42,579 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:56,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:56,373 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:56,377 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:00:43,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:00:43,407 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:00:43,408 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:01:18,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:01:18,500 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:01:18,500 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:02:02,376 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:02:02,376 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:10,525 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:02:10,526 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:04:18,643 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:04:18,643 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:04:18,659 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:04:18,660 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 39, 18, 659907), 'iat': datetime.datetime(2025, 6, 30, 5, 4, 18, 659912)}
2025-06-29 22:04:18,661 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:04:23,383 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:23,383 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:23,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:25,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,782 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:25,792 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:35,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:35,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:35,113 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:04:35,155 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:04:35,156 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:08,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:08,652 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:08,652 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:22,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:22,231 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:22,232 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:31,657 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:31,658 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:44,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:44,477 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:44,478 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:50,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:50,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:50,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,497 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:50,653 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:50,654 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:26,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,871 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,872 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:26,889 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:26,890 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:41,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:41,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:41,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:41,464 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:41,478 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:49,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:49,610 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:49,611 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:54,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:54,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:54,510 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:54,581 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:54,583 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:09,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:09,542 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:09,543 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:24,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:24,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:24,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:24,701 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:24,723 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:26,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:26,646 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:26,721 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:26,721 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:26,722 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,745 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:29,452 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:07:29,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:07:29,453 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:07:29,454 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 6, 30, 5, 37, 29, 452744), 'iat': datetime.datetime(2025, 6, 30, 5, 7, 29, 452770)}
2025-06-29 22:07:29,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:07:29,456 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTE4NjQ4NDksImlhdCI6MTc1MTI2MDA0OX0.BJWdBaaEjNDcqGX3XKkcKerLslg6xu14nQIYbpXugO0, Expiry (seconds): 604800
2025-06-29 22:07:29,466 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-06-29 22:07:30,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,684 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,697 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,701 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,741 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,742 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,742 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,840 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,841 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,868 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,908 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,913 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,965 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,967 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:32,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:32,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:32,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,986 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,991 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,352 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,353 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:37,397 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:37,398 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,817 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,818 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,870 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:08:00,951 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:08:00,959 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:14:04,296 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:14:04,297 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:14:04,307 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:04,307 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 49, 4, 307545), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 4, 307548)}
2025-06-29 22:14:04,308 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:06,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:06,618 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:06,619 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:10,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,789 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:11,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:12,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,629 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:12,737 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:12,739 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:12,740 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:27,833 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:27,834 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 44, 27, 833747), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 27, 833765)}
2025-06-29 22:14:27,835 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:27,836 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY1MjY3LCJpYXQiOjE3NTEyNjA0Njd9.AmWi-IiaMfpzb7qlzBNIsNlURySrS4MSAm4Hg0JNqBU, Expiry (seconds): 604800
2025-06-29 22:14:27,839 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,529 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,529 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,529 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,556 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,724 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,725 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,854 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,855 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,855 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,966 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,966 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:30,931 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:30,932 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:30,933 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,933 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,934 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:30,964 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:30,965 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:32,001 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:32,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:32,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:32,015 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:32,015 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:34,894 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:34,897 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:34,897 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:35,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,363 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,364 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:42,411 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:42,411 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:42,412 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,898 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,898 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,899 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:43,930 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:43,931 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,931 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:45,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,912 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,913 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,921 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:46,044 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:46,044 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:46,045 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,902 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,903 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,906 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,907 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:47,945 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:47,945 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,946 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:09,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:09,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:09,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:09,114 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:09,114 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,211 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,225 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,226 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,226 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,274 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,274 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,275 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,276 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,279 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,305 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,306 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,307 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,337 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,338 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,338 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,374 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,375 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,459 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,467 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:25,408 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:25,409 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:28,932 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:28,958 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:28,959 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:22,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:22,535 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:22,537 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:36,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:36,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:36,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:16:36,778 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:16:36,778 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:17:09,462 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:17:09,463 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:53:36,498 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:53:36,498 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:53:36,501 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:53:36,502 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:53:36,511 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:53:36,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:53:36,511 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:53:36,511 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 28, 36, 511227), 'iat': datetime.datetime(2025, 6, 30, 5, 53, 36, 511236)}
2025-06-29 22:53:36,512 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:54:24,746 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:54:24,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:54:24,746 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:54:24,746 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 6, 24, 24, 745972), 'iat': datetime.datetime(2025, 6, 30, 5, 54, 24, 745984)}
2025-06-29 22:54:24,748 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:54:24,749 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY3NjY0LCJpYXQiOjE3NTEyNjI4NjR9.XKgibxFBwq4I4Px6SWgDIkMwDh6E0ST4I02CAx2nJzo, Expiry (seconds): 604800
2025-06-29 22:54:24,763 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 22:54:25,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,910 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,910 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,911 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:25,925 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:25,926 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:25,931 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:25,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,968 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,968 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:54:25,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,980 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,014 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,014 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,014 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,033 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,045 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,046 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:26,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:26,352 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,353 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,353 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,372 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,372 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:27,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:27,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:27,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:27,259 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:27,259 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:27,267 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:27,267 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:28,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:28,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,179 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:28,195 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:28,195 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:58,918 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:54:58,919 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:19:13,212 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:19:13,212 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:19:13,215 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:19:13,215 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:19:13,221 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:19:13,221 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 54, 13, 221092), 'iat': datetime.datetime(2025, 6, 30, 6, 19, 13, 221094)}
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:19:16,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:16,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:16,397 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:20,547 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:19:20,549 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:19:27,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:27,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:27,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,909 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,910 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,911 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:27,923 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:27,924 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:27,924 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:28,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:28,742 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:28,742 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,742 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,743 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,744 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,744 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:28,773 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:28,774 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:28,775 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:29,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:29,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,557 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,558 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,558 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:29,571 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:29,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:29,572 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:30,382 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:30,382 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:30,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,383 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,384 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,385 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,385 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:30,406 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:30,407 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:30,407 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:31,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:31,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:31,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:31,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:31,687 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:31,706 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:31,707 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:33,246 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:33,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:33,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:33,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:33,247 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:33,261 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:33,261 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:38,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:38,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:38,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:38,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:38,865 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:38,872 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:38,872 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:48,343 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:48,343 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:48,350 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:48,350 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:05,948 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:05,949 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:05,959 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:05,959 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:20,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:20,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:20,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:20,361 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:20:20,364 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:20:47,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:47,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:47,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:47,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:47,067 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:47,069 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:47,070 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:51,060 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:51,060 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:51,063 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:51,063 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:53,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:53,330 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:53,332 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:53,332 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:56,367 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:20:56,369 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:21:20,419 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:21:20,419 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:21:20,423 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:21:20,424 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:21:20,433 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:21:20,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:21:20,433 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:21:20,433 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 56, 20, 433664), 'iat': datetime.datetime(2025, 6, 30, 6, 21, 20, 433667)}
2025-06-29 23:21:20,434 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:21:25,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:21:25,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:21:25,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:06,384 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:06,384 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:08,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:08,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:08,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:08,165 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:08,165 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:08,169 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:08,169 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:09,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:09,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:09,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:09,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:09,263 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:09,269 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:09,269 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:58,069 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:22:58,070 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:23:00,251 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:23:00,252 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:23:00,255 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:23:00,255 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:23:00,263 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:23:00,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:23:00,263 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:23:00,263 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 58, 0, 263413), 'iat': datetime.datetime(2025, 6, 30, 6, 23, 0, 263416)}
2025-06-29 23:23:00,264 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:23:02,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:02,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:02,392 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:23,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:23,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,441 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:23:23,449 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:23:23,449 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:23:23,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:23,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:23,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,471 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:23:23,476 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:23:23,476 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:23:25,304 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:23:25,304 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:26:26,218 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:26:26,219 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:26:26,228 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:26:26,228 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:26:26,234 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:26:26,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:26:26,234 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:26:26,234 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 1, 26, 234581), 'iat': datetime.datetime(2025, 6, 30, 6, 26, 26, 234588)}
2025-06-29 23:26:26,235 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:26:27,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:27,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:27,934 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 23:26:30,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:30,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:30,735 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 23:26:34,241 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:26:34,241 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 6, 56, 34, 241070), 'iat': datetime.datetime(2025, 6, 30, 6, 26, 34, 241075)}
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:26:34,241 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY5NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.1CI2M3SnTBh7ncTGY0-jr7cE89v3CV49yWPVTL2PHHE, Expiry (seconds): 604800
2025-06-29 23:26:34,242 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 23:26:35,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,352 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,353 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,353 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:26:35,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,354 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,355 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,390 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,390 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,390 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,465 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,465 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,519 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,519 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:26:35,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,524 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,524 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,524 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,536 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,537 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,727 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,727 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,804 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,809 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,809 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,826 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,827 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:38,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:38,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:38,280 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:38,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:38,280 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:38,301 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:38,306 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:38,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:38,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:38,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:44,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:44,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,064 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:44,119 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:44,120 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:27:50,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:27:50,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:27:50,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:27:50,481 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:27:50,481 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:27:50,483 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:27:50,483 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:28:25,509 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:28:25,509 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:28:27,793 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:28:27,794 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:28:27,797 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:28:27,797 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:28:27,802 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:28:27,802 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 3, 27, 802230), 'iat': datetime.datetime(2025, 6, 30, 6, 28, 27, 802233)}
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:28:29,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:28:29,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:28:29,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:28:39,238 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:28:39,238 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:29:52,727 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:29:52,727 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:29:52,730 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:29:52,730 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:29:52,738 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:29:52,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:29:52,738 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:29:52,738 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 4, 52, 738636), 'iat': datetime.datetime(2025, 6, 30, 6, 29, 52, 738642)}
2025-06-29 23:29:52,739 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:29:55,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:29:55,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:29:55,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:07,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:07,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:07,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:07,850 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:30:07,851 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:30:13,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:13,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:13,861 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,862 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,862 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:30:13,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:13,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:13,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,863 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:13,880 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:13,880 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:13,880 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:17,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:17,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:17,096 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,096 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,096 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:30:17,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:17,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:17,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,097 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,097 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:17,130 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:17,131 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:17,131 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:20,494 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:20,494 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:20,572 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:20,573 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:31:13,398 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:31:13,399 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:32:36,293 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:32:36,294 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:32:36,296 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:32:36,296 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:32:36,303 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:32:36,303 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 7, 36, 303491), 'iat': datetime.datetime(2025, 6, 30, 6, 32, 36, 303494)}
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:32:38,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:38,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:38,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:45,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:45,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:45,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:45,601 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:32:45,602 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:32:48,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:48,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:48,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:48,241 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:48,241 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:32:48,246 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:32:48,247 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:33:03,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:33:03,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:33:03,183 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:33:03,183 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:33:03,183 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:33:03,197 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:33:03,197 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:33:42,283 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:33:42,283 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:34:20,907 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:34:20,907 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:34:20,911 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:34:20,911 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:34:20,917 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:34:20,917 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:34:20,917 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:34:20,917 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 9, 20, 917420), 'iat': datetime.datetime(2025, 6, 30, 6, 34, 20, 917425)}
2025-06-29 23:34:20,918 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:34:49,111 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:34:49,111 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:34:49,115 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:34:49,116 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:34:49,124 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:34:49,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:34:49,124 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:34:49,124 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 9, 49, 124562), 'iat': datetime.datetime(2025, 6, 30, 6, 34, 49, 124566)}
2025-06-29 23:34:49,125 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:34:50,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:34:50,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:34:50,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:35:06,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:35:06,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,713 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:35:06,715 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:35:06,716 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:22,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:22,694 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:36:22,697 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:36:22,697 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:32,940 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:36:32,941 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:36:35,803 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:36:35,803 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:36:35,806 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:36:35,806 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:36:35,810 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:36:35,811 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 11, 35, 810972), 'iat': datetime.datetime(2025, 6, 30, 6, 36, 35, 810974)}
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:36:37,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:37,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:37,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:37,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:37,258 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:36:37,403 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:36:37,403 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:11,923 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:37:11,923 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:37:13,946 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:37:13,946 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:37:13,950 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:37:13,950 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:37:13,955 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:37:13,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:37:13,955 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:37:13,955 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 12, 13, 955721), 'iat': datetime.datetime(2025, 6, 30, 6, 37, 13, 955723)}
2025-06-29 23:37:13,956 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:37:15,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:15,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:15,385 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:17,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:17,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:17,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:17,725 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:37:17,726 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:37:38,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:38,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:38,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:38,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:38,255 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:37:38,264 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:37:38,264 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:40,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:40,120 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:37:40,127 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:37:40,128 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:37:50,881 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:37:50,882 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:09:17,034 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:09:17,035 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:09:17,044 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:09:17,044 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:09:17,053 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:09:17,053 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 44, 17, 53285), 'iat': datetime.datetime(2025, 6, 30, 10, 9, 17, 53289)}
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:09:21,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:09:21,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:09:21,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:09:24,421 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:09:24,422 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:12:07,652 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:12:07,652 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:12:07,657 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:12:07,657 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:12:07,663 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:12:07,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 47, 7, 663952), 'iat': datetime.datetime(2025, 6, 30, 10, 12, 7, 663957)}
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:12:09,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:12:09,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:12:09,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:12:13,358 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:12:13,358 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:15:03,223 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:15:03,223 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:15:03,226 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:15:03,226 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:15:03,230 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:15:03,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:15:03,231 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:15:03,231 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 50, 3, 230913), 'iat': datetime.datetime(2025, 6, 30, 10, 15, 3, 230917)}
2025-06-30 03:15:03,231 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:15:05,129 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:15:05,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:15:05,130 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,827 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:15:06,841 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:15:06,842 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:15:18,495 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:15:18,497 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:16:56,590 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:16:56,590 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:16:56,593 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:16:56,593 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:16:56,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:16:56,600 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 51, 56, 599923), 'iat': datetime.datetime(2025, 6, 30, 10, 16, 56, 599928)}
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:18:08,451 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:18:08,452 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:18:12,334 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:18:12,334 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:18:12,338 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:18:12,339 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:18:12,344 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:18:12,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:18:12,344 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:18:12,344 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 53, 12, 344260), 'iat': datetime.datetime(2025, 6, 30, 10, 18, 12, 344266)}
2025-06-30 03:18:12,345 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:18:49,639 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:18:49,641 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:18:55,731 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:18:55,731 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:18:55,735 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:18:55,736 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:18:55,740 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:18:55,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:18:55,740 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:18:55,741 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 53, 55, 740872), 'iat': datetime.datetime(2025, 6, 30, 10, 18, 55, 740875)}
2025-06-30 03:18:55,741 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:19:33,375 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:19:33,377 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:20:51,140 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:20:51,140 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:20:51,144 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:20:51,144 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:20:51,148 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:20:51,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:20:51,149 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:20:51,149 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 55, 51, 148915), 'iat': datetime.datetime(2025, 6, 30, 10, 20, 51, 148919)}
2025-06-30 03:20:51,149 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:21:33,717 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,719 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,722 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,722 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,744 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,744 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyNzg5MDMsImlhdCI6MTc1MTI3NzEwM30.7N8ihtaJZm5ZqIZBpgn5J56mNN36n3A_uJhAX_45Txw
2025-06-30 03:21:33,745 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyNzg5MDMsImlhdCI6MTc1MTI3NzEwM30.7N8ihtaJZm5ZqIZBpgn5J56mNN36n3A_uJhAX_45Txw
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,761 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,765 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,766 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,823 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,825 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,838 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,888 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,889 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,914 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,914 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,918 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,918 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,947 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,947 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,953 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,953 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,993 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,993 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,993 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:34,001 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:34,002 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:34,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:34,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:34,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:34,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:34,033 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:34,039 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:34,039 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:36,853 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:36,853 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:36,854 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:36,854 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:36,854 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:36,858 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:36,858 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:18,307 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:18,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:18,308 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 03:22:18,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:18,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:18,493 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 03:22:18,497 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 03:22:31,196 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:22:31,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:22:31,197 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:22:31,197 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 10, 52, 31, 196175), 'iat': datetime.datetime(2025, 6, 30, 10, 22, 31, 196259)}
2025-06-30 03:22:31,199 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:22:31,200 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODM3NTEsImlhdCI6MTc1MTI3ODk1MX0.pacNe5osQIpSmhN_r7qeka1nsmPKH3_FCUK62R1-h0Q, Expiry (seconds): 604800
2025-06-30 03:22:31,204 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:22:32,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,435 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,435 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:22:32,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,436 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,436 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,443 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,443 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,443 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,466 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,467 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:22:32,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,468 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,468 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,475 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,476 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,476 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,487 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,495 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,496 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,668 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,668 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,684 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,684 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,087 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,088 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:33,100 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:33,101 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,762 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:33,770 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:33,770 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:23:48,868 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:23:48,868 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:07,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:07,003 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:25:07,005 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:25:07,006 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:25:13,342 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:25:13,344 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:25:17,822 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:25:17,823 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:25:17,829 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:25:17,830 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:25:17,836 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:25:17,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:25:17,836 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:25:17,836 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 0, 17, 836691), 'iat': datetime.datetime(2025, 6, 30, 10, 25, 17, 836696)}
2025-06-30 03:25:17,837 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:25:19,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:19,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:19,799 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:24,689 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:25:24,690 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:25:28,941 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:25:28,942 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:25:28,947 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:25:28,947 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:25:28,955 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:25:28,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:25:28,955 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:25:28,955 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 0, 28, 955146), 'iat': datetime.datetime(2025, 6, 30, 10, 25, 28, 955150)}
2025-06-30 03:25:28,956 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:25:30,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:30,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:30,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:48,674 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:27:48,675 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:27:48,679 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:27:48,679 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:27:48,689 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:27:48,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:27:48,689 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:27:48,689 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 2, 48, 689090), 'iat': datetime.datetime(2025, 6, 30, 10, 27, 48, 689097)}
2025-06-30 03:27:48,690 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:27:53,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:27:53,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:27:53,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:55,834 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:27:55,835 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:05,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:28:05,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:28:05,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:28:05,330 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:05,332 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:32,283 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:28:32,284 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:41:34,224 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:41:34,225 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:41:34,229 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:41:34,229 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:41:34,236 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:41:34,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:41:34,236 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:41:34,236 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 16, 34, 236308), 'iat': datetime.datetime(2025, 6, 30, 10, 41, 34, 236312)}
2025-06-30 03:41:34,237 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:41:39,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:39,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:39,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:41:52,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:52,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:52,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:41:52,518 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:41:52,518 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:41:56,537 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:41:56,537 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 11, 56, 537116), 'iat': datetime.datetime(2025, 6, 30, 10, 41, 56, 537123)}
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:41:56,538 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODQ5MTYsImlhdCI6MTc1MTI4MDExNn0.eDmFMTxpQhAQCZmjlcF9Yucbaee8maMn9kT-tPQVT_I, Expiry (seconds): 604800
2025-06-30 03:41:56,538 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:41:57,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,606 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,613 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,613 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,613 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,626 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,630 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,632 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,633 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,633 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,636 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,636 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,813 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,813 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,817 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,817 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,949 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:00,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:00,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,064 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:00,073 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:00,073 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:03,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:03,581 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:03,585 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:03,585 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:09,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:09,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:09,999 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:09,999 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:09,999 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:10,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,599 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,599 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:10,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:10,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,600 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,600 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:10,605 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:10,606 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:10,606 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:20,582 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:42:20,583 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:43:17,179 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:43:17,180 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:43:17,184 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:43:17,184 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:43:17,188 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:43:17,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:43:17,188 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:43:17,188 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 18, 17, 188723), 'iat': datetime.datetime(2025, 6, 30, 10, 43, 17, 188731)}
2025-06-30 03:43:17,189 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:43:20,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:20,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:20,606 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:23,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:23,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:23,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:23,758 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:23,759 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:27,579 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:27,580 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:31,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:31,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:31,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:31,072 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:31,072 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:40,759 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:43:40,760 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:44:21,112 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:44:21,113 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:44:21,117 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:44:21,117 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:44:21,120 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:44:21,120 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 19, 21, 120122), 'iat': datetime.datetime(2025, 6, 30, 10, 44, 21, 120123)}
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:44:24,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:24,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:24,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:25,858 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:44:25,859 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:29,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:29,299 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:44:29,302 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:44:29,302 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:44:38,131 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:44:38,132 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:58:04,860 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:58:04,860 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:58:04,864 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:58:04,864 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:58:04,871 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:58:04,871 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 33, 4, 871496), 'iat': datetime.datetime(2025, 6, 30, 10, 58, 4, 871499)}
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:58:07,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:07,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:07,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:58:09,544 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:58:09,544 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:58:13,829 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:58:13,829 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:58:13,829 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:58:13,829 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 28, 13, 829516), 'iat': datetime.datetime(2025, 6, 30, 10, 58, 13, 829523)}
2025-06-30 03:58:13,830 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:58:13,830 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODU4OTMsImlhdCI6MTc1MTI4MTA5M30.tC1mQFEFGzlRyCKqAdjjyw30RLGuU8z2moF3iu5pzv4, Expiry (seconds): 604800
2025-06-30 03:58:13,832 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:58:14,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,934 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,934 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,935 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,935 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,939 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,939 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,939 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,945 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,945 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,946 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,952 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,956 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,956 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,956 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,961 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,961 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,207 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,211 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,211 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,245 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,245 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,245 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,262 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,262 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,466 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,466 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,471 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,471 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:26,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:26,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,967 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,967 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:26,970 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:26,971 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:45,556 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:58:45,558 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:59:45,600 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:59:45,600 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:59:45,605 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:59:45,605 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:59:45,612 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:59:45,612 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 34, 45, 612486), 'iat': datetime.datetime(2025, 6, 30, 10, 59, 45, 612489)}
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:59:47,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:47,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:47,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:47,201 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:47,204 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 03:59:53,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:53,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:53,473 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:53,473 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:53,474 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:53,480 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:53,480 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:59:57,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:57,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:57,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:57,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:57,033 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:57,037 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:57,037 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:59:59,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:59,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:59,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:59,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:59,379 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:59,383 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:59,383 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:00:33,343 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:00:33,343 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:02:15,690 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:02:15,690 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:02:15,693 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:02:15,693 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:02:15,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:02:15,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 37, 15, 696499), 'iat': datetime.datetime(2025, 6, 30, 11, 2, 15, 696501)}
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:02:20,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,916 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,916 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:20,917 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,917 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,917 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:20,930 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:20,930 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:20,930 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,601 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,601 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,602 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,602 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:21,608 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:21,608 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,608 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,208 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,208 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,209 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,209 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:22,227 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:22,227 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,227 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,861 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,862 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,862 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:22,875 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:22,876 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,876 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:59,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:59,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:59,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:59,696 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:02:59,698 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,017 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,017 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,018 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:04,021 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:04,021 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,021 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,040 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,040 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,041 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,041 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,041 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:04,046 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:04,046 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,046 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:12,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:12,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:12,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:12,842 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:12,846 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:22,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:22,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:22,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:22,388 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:22,388 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:22,396 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:22,397 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:26,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:26,404 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:26,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:26,405 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:26,405 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:26,411 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:26,411 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:29,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:29,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:29,316 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:29,316 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:29,316 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:29,322 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:29,322 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:35,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:35,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:35,391 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:35,392 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:35,392 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:40,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:40,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:40,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,376 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:40,382 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:40,382 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:40,382 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:42,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:42,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,888 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,888 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,889 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:42,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:42,892 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:42,892 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:53,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:53,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:53,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:53,883 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:53,883 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:53,888 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:53,889 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:56,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:56,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:56,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:56,774 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:56,774 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:56,779 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:56,779 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:59,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:59,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:59,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:59,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:59,694 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:59,701 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:59,701 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:04:13,948 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:04:13,948 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:04:15,942 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:04:15,942 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:04:15,945 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:04:15,945 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:04:15,948 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:04:15,948 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 39, 15, 948296), 'iat': datetime.datetime(2025, 6, 30, 11, 4, 15, 948298)}
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:04:19,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:04:19,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:04:19,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:04:27,674 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:04:27,675 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:17:30,358 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:17:30,358 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:17:30,361 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:17:30,361 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:17:30,368 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:17:30,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:17:30,368 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:17:30,368 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 52, 30, 368877), 'iat': datetime.datetime(2025, 6, 30, 11, 17, 30, 368879)}
2025-06-30 04:17:30,369 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:17:32,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:32,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:32,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:17:32,297 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:17:32,298 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:17:33,969 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:33,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:33,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:17:37,492 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:17:37,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:17:37,492 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:17:37,492 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 47, 37, 492308), 'iat': datetime.datetime(2025, 6, 30, 11, 17, 37, 492318)}
2025-06-30 04:17:37,493 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:17:37,493 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODcwNTcsImlhdCI6MTc1MTI4MjI1N30.n3Lsq3ifbl0jCqu10AB1rPD0ouNXeX--HIIDRXrjvEo, Expiry (seconds): 604800
2025-06-30 04:17:37,503 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,767 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,767 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,768 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,768 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,772 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,772 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,772 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,784 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,784 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,785 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,785 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,791 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,791 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,791 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,796 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,814 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,814 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,072 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,072 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:39,075 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:39,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,300 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,300 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:39,304 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:39,304 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:41,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:41,047 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,047 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,047 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:41,057 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:41,057 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:46,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:46,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:46,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:46,666 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:46,667 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:46,676 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:46,676 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:53,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:53,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:53,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:53,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:53,471 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:53,476 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:53,476 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:18:15,659 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:18:15,660 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:18:15,662 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:18:15,663 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:18:39,306 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:18:39,307 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:20:57,896 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:20:57,897 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:20:57,900 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:20:57,900 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:20:57,903 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:20:57,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:20:57,903 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:20:57,903 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 55, 57, 903693), 'iat': datetime.datetime(2025, 6, 30, 11, 20, 57, 903695)}
2025-06-30 04:20:57,904 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:20:59,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:20:59,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:20:59,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:20:59,791 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:20:59,792 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:20:59,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:20:59,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:20:59,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:06,243 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:06,243 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:11,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,006 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,006 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:11,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:11,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,007 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:11,020 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:11,021 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:11,021 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:13,642 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:13,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:13,643 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:19,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:19,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:19,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:19,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:19,919 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:19,926 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:19,926 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:24,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:24,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:24,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:24,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:24,453 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:24,461 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:24,461 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:34,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:34,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:34,317 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:34,317 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:34,317 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:34,324 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:34,325 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:46,993 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:46,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:46,994 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:46,994 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:21:46,996 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:22:22,123 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:22:22,123 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:26:11,842 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:26:11,842 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:26:11,846 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:26:11,846 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:26:11,852 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:26:11,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:26:11,852 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:26:11,852 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 1, 11, 852541), 'iat': datetime.datetime(2025, 6, 30, 12, 26, 11, 852543)}
2025-06-30 05:26:11,857 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:26:14,075 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:26:14,075 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:26:23,129 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:26:23,129 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:26:23,135 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:26:23,135 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:26:23,140 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:26:23,140 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 1, 23, 140353), 'iat': datetime.datetime(2025, 6, 30, 12, 26, 23, 140355)}
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:26:29,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:29,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:29,632 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:30,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:30,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:30,599 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:30,600 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:31,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:31,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:31,687 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:31,688 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:35,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:35,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:35,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:38,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:38,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:38,301 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:38,301 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:41,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:41,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:41,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:47,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:47,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:47,615 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:52,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:52,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:52,598 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:52,599 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:53,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:53,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:53,605 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:59,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:59,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:59,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:03,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:03,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:03,291 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:03,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:05,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:05,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:05,619 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:11,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:11,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:11,613 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:11,613 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:11,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:11,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:11,616 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:17,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:17,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:17,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:23,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:23,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:23,816 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:29,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:29,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:29,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:35,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:35,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:35,651 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:41,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:41,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:41,654 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:44,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:44,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:44,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:44,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:47,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:47,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:47,746 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:48,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:48,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:48,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:48,688 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:48,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,689 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:49,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:49,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:49,284 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:49,285 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:53,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:53,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:53,290 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:53,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:53,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:53,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:53,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:59,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:59,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:59,608 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:05,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:05,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:05,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:10,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:10,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:10,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:10,614 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:11,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:11,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:11,615 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:17,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:17,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:17,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:18,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:18,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:18,288 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:18,290 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:23,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:23,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:23,784 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:29,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:29,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:29,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:29,606 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:29,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:29,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:29,654 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:35,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:35,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:35,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:41,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:41,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:41,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:47,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:47,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:47,683 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:53,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:53,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:53,635 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:59,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:59,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:59,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:59,294 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:59,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:59,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:59,658 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:04,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:04,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:04,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:04,293 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:05,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:05,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:05,675 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:05,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:05,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:05,692 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:05,694 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:10,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:10,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:10,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:10,289 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:11,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:11,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:11,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,773 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,774 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:16,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,782 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,955 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:22,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:22,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:22,656 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:26,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:26,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:26,298 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:26,300 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:28,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:28,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:28,620 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:34,620 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:34,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:34,621 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:36,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:36,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:36,627 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:36,635 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:40,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:40,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:40,622 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:44,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:44,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:44,618 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:44,620 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:46,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:46,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:46,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:52,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:52,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:52,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:58,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:58,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:58,626 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:04,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:04,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:04,612 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:10,643 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:10,643 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:10,644 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:16,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:16,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:16,599 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:16,601 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:16,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:16,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:16,619 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:19,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:19,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:19,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:19,295 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:21,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:21,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:21,708 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:21,711 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:22,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:22,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:22,633 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:28,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:28,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:28,298 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:28,300 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:28,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:28,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:28,628 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:34,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:34,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:34,649 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:40,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:40,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:40,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:42,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:42,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:42,601 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:42,603 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:46,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:46,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:46,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:51,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:51,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:51,588 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:51,590 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:52,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:52,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:52,639 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:58,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:58,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:58,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:59,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:59,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:59,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:59,605 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:04,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:04,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:04,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:10,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:10,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:10,661 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:16,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:16,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:16,685 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:21,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:21,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:21,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:21,611 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:22,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:22,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:22,629 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:28,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:28,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:28,629 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:30,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:30,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:30,637 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:30,639 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:34,770 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:34,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:34,771 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:35,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:35,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:35,291 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:35,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:39,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:39,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:39,462 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:39,463 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:40,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:40,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:40,829 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:44,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:44,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:44,286 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:44,286 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:46,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:46,610 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:46,610 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:52,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:52,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:52,605 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:58,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:58,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:58,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:59,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:59,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:59,295 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:59,298 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:04,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:04,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:04,624 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:07,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:07,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:07,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:07,611 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:10,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:10,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:10,628 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:14,596 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:14,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:14,596 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:14,598 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:16,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:16,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:16,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:22,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:22,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:22,653 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:28,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:28,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:28,640 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:34,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:34,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:34,636 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:40,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:40,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:40,689 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:45,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:45,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:45,602 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:45,603 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:46,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:46,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:46,681 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:51,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:51,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:51,301 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:51,302 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:52,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:52,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:52,712 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:55,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:55,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:55,938 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:55,939 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:56,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:56,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:56,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:56,288 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:59,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:59,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:59,713 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:00,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:00,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:00,297 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:00,298 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:05,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:05,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:05,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:11,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:11,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:11,656 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:15,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:15,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:15,603 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:15,605 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:17,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:17,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:17,658 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:23,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:23,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:23,638 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,428 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,429 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,441 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,442 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,456 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,456 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,457 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,468 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,469 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,480 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,481 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,489 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,491 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,504 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,505 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:32,713 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:33:32,713 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 13, 3, 32, 713218), 'iat': datetime.datetime(2025, 6, 30, 12, 33, 32, 713222)}
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:33:32,713 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4OTE2MTIsImlhdCI6MTc1MTI4NjgxMn0.olIogoWFAl1IuD11BFWa6RNtA1MCy-53wW4Uezuvz4c, Expiry (seconds): 604800
2025-06-30 05:33:32,717 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,811 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,811 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,812 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,822 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,822 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,822 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,834 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,837 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,837 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,934 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,934 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,937 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,937 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,024 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,024 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:34,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:34,026 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,086 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:34,091 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:34,091 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:35,237 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:35,237 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,719 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,722 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,722 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,802 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,802 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,804 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,804 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,897 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,899 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,899 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:53,045 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:53,045 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,584 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,584 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,584 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,589 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,589 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,589 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,611 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,613 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,613 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,679 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,679 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,680 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,680 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,754 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,756 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,756 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:07,117 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:07,117 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:07,994 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:07,994 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,994 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,999 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,999 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,000 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,000 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,003 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,004 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,004 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,005 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,008 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,008 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,092 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,092 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,095 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,095 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,119 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,119 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,122 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,123 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,368 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,368 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,371 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,372 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:12,078 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:12,078 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:41,250 - WARNING - app.core.security - Access token is missing.
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:35:35,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:35:35,710 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:35:35,713 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:35:35,713 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:38:36,837 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:38:36,838 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:38:39,686 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:38:39,686 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:38:39,716 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:38:39,716 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:38:39,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:38:39,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 13, 39, 723125), 'iat': datetime.datetime(2025, 6, 30, 12, 38, 39, 723128)}
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:38:57,767 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:38:57,767 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:38:59,716 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:38:59,716 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:38:59,719 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:38:59,719 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:38:59,722 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:38:59,722 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 13, 59, 722508), 'iat': datetime.datetime(2025, 6, 30, 12, 38, 59, 722511)}
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:39:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:39:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:39:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:03,270 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:39:03,281 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:39:03,281 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:19,030 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:19,031 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:39:19,036 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:39:19,037 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:43:55,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:43:55,294 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:43:55,295 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:43:55,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:43:55,295 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:43:55,300 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:43:55,300 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:49:49,371 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:49:49,372 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:56:14,549 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:56:14,550 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:56:14,554 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:56:14,554 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:56:14,558 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:56:14,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:56:14,558 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:56:14,558 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 31, 14, 558602), 'iat': datetime.datetime(2025, 6, 30, 12, 56, 14, 558604)}
2025-06-30 05:56:14,559 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:56:19,929 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:56:19,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:56:19,930 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:56:19,930 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 13, 26, 19, 929588), 'iat': datetime.datetime(2025, 6, 30, 12, 56, 19, 929606)}
2025-06-30 05:56:19,931 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:56:19,932 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4OTI5NzksImlhdCI6MTc1MTI4ODE3OX0.VM3n-D9ue1RNX-JrZ0S4S9shmNZWyHAAO6_YmsDcMVs, Expiry (seconds): 604800
2025-06-30 05:56:19,936 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,027 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,027 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,028 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,028 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,033 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,034 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,034 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,046 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,050 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,050 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,051 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,053 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,053 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,068 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,069 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,229 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,229 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,236 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,236 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,448 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,449 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,449 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,449 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,456 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,456 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,698 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,698 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,706 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,707 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:26,620 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:26,621 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:48,850 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:56:48,855 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:15:53,880 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:15:53,881 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:15:53,886 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:15:53,886 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:15:53,898 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:15:53,898 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 50, 53, 898073), 'iat': datetime.datetime(2025, 6, 30, 13, 15, 53, 898076)}
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:18:05,890 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:18:05,891 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:18:16,106 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:18:16,107 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:18:16,109 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:18:16,109 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:18:16,112 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:18:16,112 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 53, 16, 112079), 'iat': datetime.datetime(2025, 6, 30, 13, 18, 16, 112082)}
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:26,650 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:26,650 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:29,079 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:29,079 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:29,082 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:29,082 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:29,089 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:29,089 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 29, 89091), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 29, 89093)}
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:33,559 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:33,560 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:35,990 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:35,990 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:36,017 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:36,018 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:36,022 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:36,022 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 36, 22257), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 36, 22260)}
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:38,170 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:38,171 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:40,592 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:40,592 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:40,595 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:40,595 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:40,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:40,599 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 40, 599366), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 40, 599368)}
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:00,964 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:23:00,965 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:23:03,289 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:23:03,290 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:23:03,302 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:23:03,302 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:23:03,306 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:03,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:03,306 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:03,306 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 58, 3, 306478), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 3, 306481)}
2025-06-30 06:23:03,307 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:10,180 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:23:10,181 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:23:12,531 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:23:12,531 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:23:12,546 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:23:12,547 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:23:12,550 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:12,550 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 58, 12, 550477), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 12, 550479)}
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:54,736 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:54,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:54,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:54,737 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 30, 13, 53, 54, 736563), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 54, 736571)}
2025-06-30 06:23:54,737 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:54,737 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTg5NDYzNCwiaWF0IjoxNzUxMjg5ODM0fQ.L1QZ-kEEtVNvsTgImE9x6FGFGL5yapYPdJhUGhGGrUU, Expiry (seconds): 604800
2025-06-30 06:23:54,738 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-30 06:26:15,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:26:15,142 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:26:15,173 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:26:15,174 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:26:15,174 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:26:15,182 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:26:15,182 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:27:15,878 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:15,879 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:18,741 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:18,741 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:18,765 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:18,766 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:18,773 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:18,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:18,773 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:18,773 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 18, 773464), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 18, 773469)}
2025-06-30 06:27:18,774 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:34,266 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:34,266 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:36,426 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:36,426 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:36,431 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:36,432 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:36,435 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:36,435 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 36, 435459), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 36, 435461)}
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:41,174 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:41,175 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:48,286 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:48,286 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:48,290 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:48,290 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:48,295 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:48,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:48,295 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:48,295 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 48, 295881), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 48, 295884)}
2025-06-30 06:27:48,296 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:54,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:27:54,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:27:54,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:27:54,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:27:54,773 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:27:54,786 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:27:54,786 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:28:13,285 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:28:13,286 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:28:15,548 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:28:15,548 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:28:15,557 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:28:15,557 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:28:15,561 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:28:15,561 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 3, 15, 561070), 'iat': datetime.datetime(2025, 6, 30, 13, 28, 15, 561072)}
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:28:19,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:28:19,952 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:28:19,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:28:19,953 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:28:19,953 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:28:19,964 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:28:19,965 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:30:10,282 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:10,284 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:12,823 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:12,823 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:12,828 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:12,829 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:12,833 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:12,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:12,833 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:12,833 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 12, 833749), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 12, 833752)}
2025-06-30 06:30:12,834 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:26,293 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:26,293 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:28,608 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:28,608 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:28,617 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:28,617 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:28,620 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:28,620 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 28, 620033), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 28, 620035)}
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:33,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:30:33,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:30:33,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:33,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:33,540 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:30:33,552 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:30:33,552 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:30:51,590 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:51,590 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:53,913 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:53,913 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:53,918 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:53,918 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:53,921 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:53,921 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 53, 921237), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 53, 921239)}
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:58,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:30:58,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:30:58,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:58,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:58,912 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:30:58,922 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:30:58,922 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:31:07,664 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:31:07,665 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:31:09,961 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:31:09,961 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:31:09,963 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:31:09,964 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:31:09,967 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:31:09,967 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 6, 9, 967208), 'iat': datetime.datetime(2025, 6, 30, 13, 31, 9, 967211)}
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:31:11,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:31:11,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:31:11,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:31:11,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:31:11,568 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:31:11,666 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:31:11,666 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:34:09,827 - WARNING - app.core.security - Access token is missing.
2025-06-30 06:34:27,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:34:27,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:34:27,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:34:27,310 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:34:27,310 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:34:27,314 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:34:27,314 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:35:36,042 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:35:36,043 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:35:38,913 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:35:38,913 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:35:38,919 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:35:38,919 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:35:38,923 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:35:38,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 10, 38, 923497), 'iat': datetime.datetime(2025, 6, 30, 13, 35, 38, 923499)}
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:35:49,776 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:35:49,776 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:35:52,552 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:35:52,552 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:35:52,565 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:35:52,565 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:35:52,568 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:35:52,569 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 10, 52, 568967), 'iat': datetime.datetime(2025, 6, 30, 13, 35, 52, 568970)}
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:35:54,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:35:54,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:35:54,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:35:54,198 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:35:54,198 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:35:54,312 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:35:54,312 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:36:13,537 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:36:13,538 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:36:19,651 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:36:19,651 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:36:19,655 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:36:19,655 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:36:19,658 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:36:19,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:36:19,658 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:36:19,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 11, 19, 658609), 'iat': datetime.datetime(2025, 6, 30, 13, 36, 19, 658612)}
2025-06-30 06:36:19,659 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:37:41,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:37:41,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:37:41,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:37:41,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:37:41,304 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:37:41,309 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:37:41,309 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:39:17,449 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:39:17,450 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:39:20,253 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:39:20,253 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:39:20,257 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:39:20,257 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:39:20,262 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:39:20,262 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 14, 20, 262567), 'iat': datetime.datetime(2025, 6, 30, 13, 39, 20, 262569)}
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:39:21,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:39:21,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:39:21,969 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:21,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:21,969 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:39:22,113 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:39:22,113 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:39:33,413 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:39:33,414 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:39:35,982 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:39:35,982 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:39:35,986 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:39:35,986 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:39:35,989 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:39:35,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:39:35,989 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:39:35,989 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 14, 35, 989840), 'iat': datetime.datetime(2025, 6, 30, 13, 39, 35, 989843)}
2025-06-30 06:39:35,990 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:39:37,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:39:37,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:39:37,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:37,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:37,912 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:39:37,921 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:39:37,921 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:40:41,696 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:40:41,696 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:40:44,656 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:40:44,657 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:40:44,662 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:40:44,662 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:40:44,668 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:40:44,668 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 15, 44, 668468), 'iat': datetime.datetime(2025, 6, 30, 13, 40, 44, 668471)}
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:40:50,814 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:40:50,815 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:40:53,519 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:40:53,519 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:40:53,522 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:40:53,522 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:40:53,525 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:40:53,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:40:53,526 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:40:53,526 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 15, 53, 525914), 'iat': datetime.datetime(2025, 6, 30, 13, 40, 53, 525917)}
2025-06-30 06:40:53,526 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:40:57,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:40:57,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:40:57,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:40:57,941 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:40:57,941 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:40:57,953 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:40:57,953 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:41:10,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:41:10,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:41:10,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:41:10,608 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:41:10,608 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:41:10,611 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:41:10,612 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 10:08:56,700 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:08:56,700 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:08:56,726 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:08:56,726 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:08:56,735 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:08:56,735 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:08:56,735 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:08:56,735 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 17, 43, 56, 735561), 'iat': datetime.datetime(2025, 6, 30, 17, 8, 56, 735564)}
2025-06-30 10:08:56,736 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:09:22,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,226 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,231 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,250 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,263 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,265 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,275 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,277 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,286 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:26,922 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:09:26,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:09:26,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:09:26,923 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 39, 26, 922787), 'iat': datetime.datetime(2025, 6, 30, 17, 9, 26, 922804)}
2025-06-30 10:09:26,924 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:09:26,924 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDgxNjYsImlhdCI6MTc1MTMwMzM2Nn0.LdJC1RHvG8ovE30L4qIdsCeQFn5R-nuh-9eRSWggkMQ, Expiry (seconds): 604800
2025-06-30 10:09:26,929 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:09:28,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,033 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,033 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,034 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,034 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,039 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,040 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,040 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,057 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,063 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,064 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,077 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,383 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,383 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,394 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,394 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,397 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,397 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,397 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,411 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,411 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,744 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,749 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,749 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:10:43,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:10:43,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:10:43,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:10:43,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:10:43,581 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:10:43,585 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:10:43,585 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:11:04,788 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:11:04,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:11:04,788 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:11:04,789 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 41, 4, 788643), 'iat': datetime.datetime(2025, 6, 30, 17, 11, 4, 788651)}
2025-06-30 10:11:04,789 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:11:04,789 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDgyNjQsImlhdCI6MTc1MTMwMzQ2NH0.Lr9BetCnlMtk2-mI8eWlOIWGgwLRwCjzvwhqrFLHn_g, Expiry (seconds): 604800
2025-06-30 10:11:04,791 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:11:16,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:11:16,658 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:11:16,664 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:11:16,665 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:11:30,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:30,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:30,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:30,242 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:11:30,244 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:59,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:59,563 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:11:59,567 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:11:59,567 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:12:02,526 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:12:02,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:12:02,526 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:12:02,526 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 30, 17, 42, 2, 526364), 'iat': datetime.datetime(2025, 6, 30, 17, 12, 2, 526373)}
2025-06-30 10:12:02,527 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:12:02,527 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTkwODMyMiwiaWF0IjoxNzUxMzAzNTIyfQ.7ZA6zo6bZJL04fMUoeVc6DUIS6R7Y0Gwpn7hpmlGsHU, Expiry (seconds): 604800
2025-06-30 10:12:02,529 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751305322, 'iat': 1751303522}
2025-06-30 10:12:22,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751305322, 'iat': 1751303522}
2025-06-30 10:12:22,629 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 10:12:22,633 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 10:12:22,633 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 10:12:29,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:12:29,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:12:29,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:12:29,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:12:29,486 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:12:29,490 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:12:29,490 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:13:00,471 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:13:00,471 - INFO - app.core.security - Redis connection closed.

2025-06-28 04:34:38,028 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-28 04:34:38,028 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-28 04:34:38,052 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-28 04:34:38,052 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-28 04:34:38,067 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-28 04:34:38,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-28 04:34:38,067 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-28 04:34:38,067 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 28, 12, 9, 38, 67295), 'iat': datetime.datetime(2025, 6, 28, 11, 34, 38, 67305)}
2025-06-28 04:34:38,069 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-28 04:37:11,723 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:11,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:11,738 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:11,768 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:11,830 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:11,831 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:11,841 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:11,848 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:11,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:11,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:11,924 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:11,936 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:11,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:11,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:11,987 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:11,990 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:31,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:31,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:31,793 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:31,795 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:31,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:31,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:31,886 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:31,889 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:31,920 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:31,920 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:31,924 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:31,947 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:32,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:32,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:32,024 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:32,035 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-28 04:37:32,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:32,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:32,129 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:32,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:32,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:32,231 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-28 04:37:39,375 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-28 04:37:39,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-28 04:37:39,375 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-28 04:37:39,375 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 28, 12, 7, 39, 374939), 'iat': datetime.datetime(2025, 6, 28, 11, 37, 39, 374955)}
2025-06-28 04:37:39,375 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-28 04:37:39,376 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNzE1NDU5LCJpYXQiOjE3NTExMTA2NTl9.EslLf3oIzzfe1QNel7lbDd4lodGx8veFrSsvpz_o0uI, Expiry (seconds): 604800
2025-06-28 04:37:39,396 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-28 04:37:40,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:40,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:40,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,763 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,763 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-28 04:37:40,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:40,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:40,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,764 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,764 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:37:40,836 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:37:40,836 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:37:40,836 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:37:40,875 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:40,876 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:40,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,878 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,878 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:37:40,977 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:40,977 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:40,982 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,983 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,984 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-28 04:37:40,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:40,984 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:40,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,989 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:40,989 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:37:41,070 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:37:41,070 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:37:41,071 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:37:41,374 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:37:41,375 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:37:41,475 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:41,476 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:41,484 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:41,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:41,487 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:37:41,543 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:37:41,543 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:37:44,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:44,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:44,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:44,618 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:44,618 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:37:44,646 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:37:44,647 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:37:44,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:44,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:44,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:49,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:37:49,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:37:49,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:49,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:37:49,444 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:37:49,502 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:37:49,508 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:38:14,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:38:14,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:38:14,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:38:14,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:38:14,582 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:38:14,605 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:38:14,606 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:38:40,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:38:40,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:38:40,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:38:40,892 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTEyNDU5LCJpYXQiOjE3NTExMTA2NTl9.OyMvCT6AnFx0dqqp_bl5tDlx0aGBprASXav9sdQpONg
2025-06-28 04:38:40,899 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTEyNDU5LCJpYXQiOjE3NTExMTA2NTl9.OyMvCT6AnFx0dqqp_bl5tDlx0aGBprASXav9sdQpONg
2025-06-28 04:38:57,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:38:57,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:38:57,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:38:57,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:38:57,659 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:38:57,689 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:38:57,691 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:39:19,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:39:19,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:39:19,619 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:19,620 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:19,620 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:39:19,635 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:39:19,635 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:39:20,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:39:20,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:39:20,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:20,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:20,772 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:39:20,790 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:39:20,790 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:39:25,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:39:25,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:39:25,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:25,593 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:25,594 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:39:25,615 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:39:25,615 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:39:34,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 04:39:34,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 04:39:34,233 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:34,233 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751112459, 'iat': 1751110659}
2025-06-28 04:39:34,234 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 04:39:34,250 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 04:39:34,250 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 04:39:34,250 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTEyNDU5LCJpYXQiOjE3NTExMTA2NTl9.OyMvCT6AnFx0dqqp_bl5tDlx0aGBprASXav9sdQpONg
2025-06-28 04:39:34,263 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTEyNDU5LCJpYXQiOjE3NTExMTA2NTl9.OyMvCT6AnFx0dqqp_bl5tDlx0aGBprASXav9sdQpONg
2025-06-28 04:40:11,572 - INFO - app.core.security - Closing Redis connection...
2025-06-28 04:40:11,573 - INFO - app.core.security - Redis connection closed.
2025-06-28 23:31:17,633 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-28 23:31:17,633 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-28 23:31:17,639 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-06-28 23:31:17,656 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-06-28 23:31:17,656 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-28 23:31:17,665 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-28 23:31:17,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-28 23:31:17,665 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-28 23:31:17,665 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 29, 7, 6, 17, 665304), 'iat': datetime.datetime(2025, 6, 29, 6, 31, 17, 665307)}
2025-06-28 23:31:17,666 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-28 23:31:47,346 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-28 23:31:47,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-28 23:31:47,346 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-28 23:31:47,346 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 29, 7, 1, 47, 345997), 'iat': datetime.datetime(2025, 6, 29, 6, 31, 47, 346008)}
2025-06-28 23:31:47,347 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-28 23:31:47,347 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNzgzNTA3LCJpYXQiOjE3NTExNzg3MDd9.WOgemNHzousd48wk6kLLWYthFOZKxJi-L8nAi7hxfmc, Expiry (seconds): 604800
2025-06-28 23:31:47,355 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-28 23:31:48,453 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:48,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:48,454 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,454 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,454 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-28 23:31:48,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:48,454 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:48,454 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,455 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,455 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:31:48,478 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:31:48,479 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:48,479 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:48,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:48,539 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:48,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,540 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,540 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-28 23:31:48,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:48,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:48,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,541 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:31:48,579 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:31:48,579 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:48,580 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:48,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:48,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:48,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,604 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:48,604 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:31:48,652 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:31:48,652 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:50,271 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:50,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:50,272 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:50,273 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:50,273 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:31:50,302 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:31:50,303 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:50,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:50,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:50,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:51,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:51,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:51,037 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:51,037 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:51,037 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:31:51,245 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:31:51,246 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:53,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:53,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:53,430 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:53,430 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:53,431 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:31:53,464 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:31:53,464 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:31:59,833 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:31:59,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:31:59,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:59,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:31:59,837 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:31:59,910 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:31:59,910 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:49,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:49,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:49,627 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:49,627 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTgwNTA3LCJpYXQiOjE3NTExNzg3MDd9.kg4owWna_Wk47RBWJh7vKvm0hArCXk6Z-kWPDsmtLf8
2025-06-28 23:32:49,628 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTgwNTA3LCJpYXQiOjE3NTExNzg3MDd9.kg4owWna_Wk47RBWJh7vKvm0hArCXk6Z-kWPDsmtLf8
2025-06-28 23:32:52,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:52,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:52,731 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,731 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,731 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-28 23:32:52,731 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:52,731 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:52,731 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,731 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,731 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:32:52,743 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:32:52,743 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:52,743 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:52,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:52,770 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:52,771 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,772 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,772 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-28 23:32:52,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:52,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:52,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,774 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,774 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:32:52,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:52,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:52,798 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,800 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:52,801 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:32:52,811 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:32:52,812 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:52,812 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:52,826 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:32:52,826 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:53,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:53,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:53,244 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:53,245 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:53,245 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:32:53,303 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:32:53,304 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:53,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:53,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:53,640 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:53,640 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:53,640 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:32:53,647 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:32:53,647 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:32:54,271 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:54,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:54,272 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:54,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:32:54,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:32:54,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:54,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:32:54,299 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:32:54,309 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:32:54,309 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:33:09,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:33:09,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:33:09,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:09,268 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:09,268 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-28 23:33:09,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:33:09,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:33:09,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:09,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:09,269 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:33:09,280 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:33:09,280 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:33:09,280 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:33:13,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:33:13,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:33:13,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:13,450 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:13,450 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:33:13,470 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:33:13,470 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:33:18,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:33:18,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:33:18,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:18,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:18,086 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:33:18,098 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:33:18,098 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:33:22,545 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:33:22,546 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:33:22,546 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:22,546 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:33:22,546 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:33:22,665 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:33:22,665 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:34:10,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:34:10,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:34:10,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:34:10,554 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:34:10,555 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:34:10,562 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:34:10,562 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:34:28,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:34:28,952 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:34:28,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:34:28,953 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTgwNTA3LCJpYXQiOjE3NTExNzg3MDd9.kg4owWna_Wk47RBWJh7vKvm0hArCXk6Z-kWPDsmtLf8
2025-06-28 23:34:28,954 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTgwNTA3LCJpYXQiOjE3NTExNzg3MDd9.kg4owWna_Wk47RBWJh7vKvm0hArCXk6Z-kWPDsmtLf8
2025-06-28 23:35:25,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:35:25,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:35:25,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:35:25,662 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:35:25,662 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:35:25,668 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:35:25,668 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:36:42,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:36:42,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:36:42,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:36:42,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:36:42,520 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:36:42,526 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:36:42,526 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:37:58,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:37:58,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:37:58,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:37:58,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:37:58,776 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:37:58,782 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:37:58,782 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:39:15,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:39:15,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:39:15,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:39:15,696 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:39:15,696 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:39:15,702 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:39:15,702 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:40:31,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:40:31,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:40:31,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:40:31,428 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:40:31,428 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:40:31,435 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:40:31,436 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:41:48,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:41:48,165 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:41:48,166 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:41:48,166 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:41:48,166 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:41:48,179 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:41:48,179 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:42:54,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:42:54,298 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:42:54,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:42:54,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:42:54,299 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:42:54,312 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:42:54,312 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:43:05,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:43:05,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:43:05,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:43:05,875 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:43:05,875 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:43:05,883 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:43:05,883 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:44:11,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:44:11,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:44:11,285 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:44:11,285 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:44:11,285 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:44:11,290 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:44:11,291 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:44:22,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:44:22,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:44:22,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:44:22,762 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:44:22,763 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:44:22,768 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:44:22,769 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:45:26,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:45:26,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:45:26,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:45:26,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:45:26,291 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:45:26,298 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:45:26,298 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:45:39,803 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:45:39,803 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:45:39,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:45:39,804 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:45:39,804 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:45:39,813 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:45:39,813 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:46:43,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:46:43,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:46:43,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:46:43,292 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:46:43,292 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:46:43,297 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:46:43,297 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:46:58,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:46:58,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:46:58,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:46:58,436 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:46:58,436 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:46:58,440 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:46:58,440 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:47:59,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:47:59,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:47:59,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:47:59,300 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:47:59,300 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:47:59,309 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:47:59,310 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:48:14,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:48:14,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:48:14,204 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:48:14,205 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:48:14,205 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-28 23:48:14,214 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-28 23:48:14,214 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-28 23:48:45,967 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-28 23:48:45,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-28 23:48:45,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751180507, 'iat': 1751178707}
2025-06-28 23:48:45,968 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTgwNTA3LCJpYXQiOjE3NTExNzg3MDd9.kg4owWna_Wk47RBWJh7vKvm0hArCXk6Z-kWPDsmtLf8
2025-06-28 23:48:45,970 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMTgwNTA3LCJpYXQiOjE3NTExNzg3MDd9.kg4owWna_Wk47RBWJh7vKvm0hArCXk6Z-kWPDsmtLf8
2025-06-28 23:48:55,555 - INFO - app.core.security - Closing Redis connection...
2025-06-28 23:48:55,556 - INFO - app.core.security - Redis connection closed.

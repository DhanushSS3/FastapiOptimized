2025-06-29 21:41:10,791 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:41:10,792 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:46,983 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:46,989 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,035 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,038 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,091 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,094 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,127 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,131 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:51,250 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:41:51,250 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 11, 51, 250235), 'iat': datetime.datetime(2025, 6, 30, 4, 41, 51, 250318)}
2025-06-29 21:41:51,251 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:41:51,251 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODYzMzExLCJpYXQiOjE3NTEyNTg1MTF9.txlYB-GgOelNHVtqQfIPVXb8d4MxNkXP7enR6SPHDO8, Expiry (seconds): 604800
2025-06-29 21:41:51,253 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,382 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,383 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,383 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,424 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,456 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,458 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,459 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,473 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,474 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,474 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,515 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,515 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,761 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,761 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:54,084 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:54,085 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:56,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:56,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:56,276 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:56,276 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:42:55,106 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:42:55,106 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:42:55,117 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:42:55,117 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 17, 55, 117158), 'iat': datetime.datetime(2025, 6, 30, 4, 42, 55, 117162)}
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:42:58,672 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,686 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:42:58,689 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:42:58,713 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:43:01,539 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:43:01,539 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:43:01,544 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:43:01,545 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:43:01,554 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:43:01,554 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 18, 1, 554568), 'iat': datetime.datetime(2025, 6, 30, 4, 43, 1, 554572)}
2025-06-29 21:43:01,555 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:43:03,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,497 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,497 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,498 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,506 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,507 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,535 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,535 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,535 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,617 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,617 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,152 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,153 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,702 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,702 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:17,077 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:43:17,080 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:50:42,682 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:50:42,682 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:50:42,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:50:42,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 25, 42, 695996), 'iat': datetime.datetime(2025, 6, 30, 4, 50, 42, 695998)}
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:50:43,705 - INFO - app.core.security - Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:50:44,572 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:50:44,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:51:03,436 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:51:03,436 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:52:01,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:52:01,798 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:52:01,798 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:52:40,338 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:52:40,339 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:58:45,854 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:58:45,854 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:58:45,867 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:58:45,867 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 33, 45, 867752), 'iat': datetime.datetime(2025, 6, 30, 4, 58, 45, 867756)}
2025-06-29 21:58:45,868 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:58:49,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,821 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:58:50,823 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:14,618 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:59:14,619 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:59:31,031 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:59:31,031 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:59:31,047 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:59:31,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:59:31,048 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:59:31,048 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 34, 31, 47709), 'iat': datetime.datetime(2025, 6, 30, 4, 59, 31, 47714)}
2025-06-29 21:59:31,049 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:59:34,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:34,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:34,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:42,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:59:42,578 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:59:42,579 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:56,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:56,373 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:56,377 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:00:43,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:00:43,407 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:00:43,408 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:01:18,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:01:18,500 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:01:18,500 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:02:02,376 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:02:02,376 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:10,525 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:02:10,526 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:04:18,643 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:04:18,643 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:04:18,659 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:04:18,660 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 39, 18, 659907), 'iat': datetime.datetime(2025, 6, 30, 5, 4, 18, 659912)}
2025-06-29 22:04:18,661 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:04:23,383 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:23,383 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:23,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:25,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,782 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:25,792 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:35,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:35,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:35,113 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:04:35,155 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:04:35,156 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:08,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:08,652 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:08,652 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:22,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:22,231 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:22,232 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:31,657 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:31,658 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:44,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:44,477 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:44,478 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:50,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:50,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:50,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,497 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:50,653 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:50,654 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:26,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,871 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,872 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:26,889 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:26,890 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:41,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:41,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:41,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:41,464 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:41,478 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:49,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:49,610 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:49,611 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:54,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:54,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:54,510 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:54,581 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:54,583 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:09,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:09,542 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:09,543 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:24,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:24,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:24,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:24,701 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:24,723 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:26,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:26,646 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:26,721 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:26,721 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:26,722 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,745 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:29,452 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:07:29,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:07:29,453 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:07:29,454 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 6, 30, 5, 37, 29, 452744), 'iat': datetime.datetime(2025, 6, 30, 5, 7, 29, 452770)}
2025-06-29 22:07:29,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:07:29,456 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTE4NjQ4NDksImlhdCI6MTc1MTI2MDA0OX0.BJWdBaaEjNDcqGX3XKkcKerLslg6xu14nQIYbpXugO0, Expiry (seconds): 604800
2025-06-29 22:07:29,466 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-06-29 22:07:30,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,684 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,697 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,701 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,741 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,742 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,742 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,840 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,841 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,868 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,908 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,913 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,965 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,967 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:32,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:32,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:32,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,986 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,991 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,352 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,353 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:37,397 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:37,398 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,817 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,818 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,870 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:08:00,951 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:08:00,959 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:14:04,296 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:14:04,297 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:14:04,307 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:04,307 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 49, 4, 307545), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 4, 307548)}
2025-06-29 22:14:04,308 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:06,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:06,618 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:06,619 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:10,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,789 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:11,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:12,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,629 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:12,737 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:12,739 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:12,740 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:27,833 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:27,834 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 44, 27, 833747), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 27, 833765)}
2025-06-29 22:14:27,835 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:27,836 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY1MjY3LCJpYXQiOjE3NTEyNjA0Njd9.AmWi-IiaMfpzb7qlzBNIsNlURySrS4MSAm4Hg0JNqBU, Expiry (seconds): 604800
2025-06-29 22:14:27,839 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,529 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,529 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,529 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,556 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,724 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,725 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,854 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,855 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,855 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,966 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,966 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:30,931 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:30,932 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:30,933 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,933 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,934 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:30,964 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:30,965 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:32,001 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:32,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:32,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:32,015 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:32,015 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:34,894 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:34,897 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:34,897 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:35,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,363 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,364 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:42,411 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:42,411 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:42,412 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,898 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,898 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,899 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:43,930 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:43,931 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,931 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:45,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,912 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,913 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,921 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:46,044 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:46,044 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:46,045 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,902 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,903 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,906 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,907 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:47,945 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:47,945 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,946 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:09,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:09,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:09,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:09,114 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:09,114 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,211 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,225 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,226 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,226 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,274 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,274 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,275 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,276 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,279 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,305 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,306 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,307 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,337 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,338 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,338 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,374 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,375 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,459 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,467 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:25,408 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:25,409 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:28,932 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:28,958 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:28,959 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:22,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:22,535 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:22,537 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:36,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:36,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:36,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:16:36,778 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:16:36,778 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:17:09,462 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:17:09,463 - INFO - app.core.security - Redis connection closed.

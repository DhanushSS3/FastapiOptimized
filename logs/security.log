2025-06-25 05:17:42,702 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:17:42,702 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:17:42,712 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:17:42,713 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:17:42,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:17:42,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:17:42,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:17:42,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 12, 52, 42, 723775), 'iat': datetime.datetime(2025, 6, 25, 12, 17, 42, 723780)}
2025-06-25 05:17:42,724 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:17:44,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:17:44,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:17:44,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:17:46,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:17:46,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:17:46,886 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:17:46,907 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:17:46,907 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,556 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,556 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,558 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,558 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,564 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,564 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,564 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,595 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,595 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,596 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,616 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,617 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,618 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:15,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:15,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:15,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:15,657 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:15,699 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:15,700 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:16,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:16,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:16,952 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:16,952 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:16,952 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:16,973 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:16,973 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:16,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:17,001 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:17,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:17,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:17,639 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,639 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:17,639 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:17,957 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:17,958 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:19,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:19,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:19,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:19,846 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:19,846 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:19,880 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:19,881 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:40,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:40,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:40,966 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:40,982 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:40,983 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:18:48,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:18:48,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:18:48,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:48,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:18:48,215 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:18:48,229 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:18:48,229 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:19:17,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:19:17,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:19:17,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:17,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:17,438 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:19:17,448 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:19:17,448 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:19:40,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:19:40,950 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:19:40,951 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:40,951 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:19:40,952 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:19:40,993 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:19:40,994 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:03,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:20:03,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:20:03,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:03,567 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:03,567 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:20:03,580 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:20:03,581 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:17,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:20:17,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:20:17,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:17,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:20:17,752 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:20:17,759 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:20:17,760 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:20:33,499 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:20:33,499 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:27:34,803 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:27:34,804 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:27:34,831 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:27:34,832 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:27:34,847 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:27:34,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:27:34,847 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:27:34,848 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 2, 34, 847575), 'iat': datetime.datetime(2025, 6, 25, 12, 27, 34, 847580)}
2025-06-25 05:27:34,848 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:27:40,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:40,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:40,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:40,817 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:40,817 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:40,837 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:40,838 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,189 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,189 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,191 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,191 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:42,203 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:42,204 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,204 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:42,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:42,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:42,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:42,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:42,778 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:42,778 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,420 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:53,428 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:53,428 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,937 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,937 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:27:53,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:53,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:53,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,943 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:27:53,945 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:27:53,979 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:27:53,980 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:53,980 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:27:58,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:10,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:10,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:10,912 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:10,928 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:10,929 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:14,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:14,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:14,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:14,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:14,734 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:14,753 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:14,753 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:17,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:17,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:17,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:17,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:17,630 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:17,638 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:17,638 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:21,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:21,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:21,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:21,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:21,025 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:21,097 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:21,097 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:28,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:28,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:28,960 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:28,960 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:28,961 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:28,982 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:28,987 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:52,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:52,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:52,990 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:52,990 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:52,990 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:53,006 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:53,006 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:28:56,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:28:56,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:28:56,735 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:56,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:28:56,736 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:28:56,749 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:28:56,750 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:29:32,314 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:29:32,315 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:36:55,622 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:36:55,622 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:36:55,641 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:36:55,641 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:36:55,657 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:36:55,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:36:55,657 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:36:55,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 11, 55, 657819), 'iat': datetime.datetime(2025, 6, 25, 12, 36, 55, 657826)}
2025-06-25 05:36:55,659 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:37:01,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:01,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:01,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:01,780 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:01,780 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:01,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:01,794 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:01,801 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:01,801 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:03,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:03,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:03,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:03,344 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:03,349 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:03,349 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:03,349 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:05,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:05,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:05,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:05,294 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:05,294 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:05,302 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:05,303 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:06,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,134 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,134 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:06,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,135 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:06,135 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:06,141 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:06,142 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:06,142 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:07,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,015 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,015 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:07,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:07,016 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:07,023 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:07,023 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:07,023 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:10,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:10,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:10,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:10,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:10,138 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:10,144 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:10,145 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:10,393 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:19,355 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:19,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,356 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:19,357 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:19,368 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:19,369 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:25,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:25,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,093 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,093 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:25,093 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:25,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,094 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:25,095 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:25,102 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:25,103 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:25,103 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:38,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:38,500 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:38,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:38,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:38,501 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:38,508 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:38,509 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:47,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:47,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:47,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:47,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:47,171 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:47,196 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:47,199 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:51,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:51,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:51,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:51,022 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:51,023 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:51,056 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:51,057 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:53,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:53,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:53,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:53,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:53,243 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:53,251 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:53,251 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:37:54,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:37:54,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:37:54,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:54,610 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:37:54,610 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:37:54,642 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:37:54,643 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:05,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:05,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:05,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:05,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:05,046 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:05,081 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:05,081 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:10,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:10,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:10,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:10,158 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:10,158 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:10,175 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:10,175 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:17,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:17,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:17,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:17,440 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:17,441 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:17,478 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:17,478 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:21,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:21,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:21,719 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:21,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:21,720 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:21,742 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:21,743 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:32,117 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:32,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:32,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:32,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:32,120 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:32,137 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:32,138 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:38:53,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:38:53,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:38:53,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:53,460 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:38:53,460 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:38:53,480 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:38:53,481 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:39:12,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:39:12,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:39:12,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:39:12,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750855454, 'iat': 1750853654}
2025-06-25 05:39:12,897 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:39:12,904 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:39:12,904 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:39:14,240 - INFO - app.core.security - Closing Redis connection...
2025-06-25 05:39:14,240 - INFO - app.core.security - Redis connection closed.
2025-06-25 05:45:53,395 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 05:45:53,395 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 05:45:53,408 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 05:45:53,409 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 05:45:53,417 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:45:53,417 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 25, 13, 20, 53, 417133), 'iat': datetime.datetime(2025, 6, 25, 12, 45, 53, 417136)}
2025-06-25 05:45:53,417 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:45:57,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:57,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:57,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:45:57,909 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 05:45:58,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:58,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:58,429 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:45:58,431 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 05:45:58,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:45:58,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:45:58,631 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 05:46:05,201 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 05:46:05,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 05:46:05,202 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 05:46:05,202 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 25, 13, 16, 5, 201548), 'iat': datetime.datetime(2025, 6, 25, 12, 46, 5, 201571)}
2025-06-25 05:46:05,202 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 05:46:05,202 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE0NjAzNjUsImlhdCI6MTc1MDg1NTU2NX0.nTsRIyyyl0BRDJbFZvzy3H9uOH5qq0KbaabiFbpJEM0, Expiry (seconds): 604800
2025-06-25 05:46:05,208 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 05:46:06,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,674 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,674 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,675 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,685 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,685 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,685 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,699 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,700 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,700 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,701 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,701 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,712 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,713 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,713 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:06,730 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,731 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:06,731 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:06,763 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:06,763 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:07,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:07,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:07,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:07,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:07,417 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:07,425 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:07,425 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:07,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:07,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:07,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:09,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:09,347 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,347 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,347 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:09,361 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:09,362 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:46:09,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:46:09,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:46:09,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,387 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:46:09,387 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:46:09,484 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:46:09,485 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:47:09,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:47:09,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:47:09,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:47:09,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:47:09,523 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:47:09,532 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:47:09,533 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:48:09,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:48:09,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:48:09,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:48:09,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:48:09,530 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:48:09,545 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:48:09,546 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:52:31,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:52:31,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:52:31,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:52:31,554 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:52:31,554 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:52:31,566 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:52:31,566 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:53:57,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:53:57,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:53:57,593 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:53:57,600 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:53:57,601 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:54:02,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:54:02,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:54:02,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:02,866 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:02,866 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:54:02,874 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:54:02,874 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:54:09,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:54:09,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:54:09,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:09,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:54:09,517 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:54:09,522 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:54:09,522 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:55:03,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:55:03,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:55:03,531 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:03,531 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:03,531 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:55:03,544 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:55:03,545 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:55:09,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:09,601 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:55:09,601 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:55:09,605 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:55:09,606 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:56:03,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:03,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:03,732 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:56:03,738 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:56:03,738 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 05:56:25,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:25,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750857365, 'iat': 1750855565}
2025-06-25 05:56:25,845 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 05:56:25,849 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 05:56:25,849 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:14:05,406 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:05,407 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:07,489 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:14:07,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:14:07,489 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:14:07,489 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 4, 49, 7, 489333), 'iat': datetime.datetime(2025, 6, 26, 4, 14, 7, 489337)}
2025-06-25 21:14:07,490 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:14:25,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,232 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,234 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,244 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,246 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,276 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,284 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:25,347 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:14:25,347 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:14:25,348 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:14:25,352 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:14:28,907 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:28,907 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:59,122 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:14:59,123 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:14:59,146 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-06-25 21:14:59,154 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-06-25 21:14:59,155 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:15:00,287 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:15:00,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:15:00,288 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:15:00,288 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 4, 45, 0, 287909), 'iat': datetime.datetime(2025, 6, 26, 4, 15, 0, 287917)}
2025-06-25 21:15:00,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:15:00,291 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MTYxMDAsImlhdCI6MTc1MDkxMTMwMH0.CXeMYmz-n8w8EUA68tjEEBa3pQYM6H6vxNpSBj-wHKQ, Expiry (seconds): 604800
2025-06-25 21:15:00,294 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,407 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,408 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,408 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,409 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,418 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,418 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,418 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,570 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,571 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:15:01,571 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,571 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,572 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,572 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,575 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:01,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:01,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,605 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:01,605 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:01,639 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,639 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,639 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:01,666 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:01,667 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:02,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:02,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:02,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:02,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:02,848 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:02,863 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:02,863 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:02,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:02,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:02,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:03,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:03,271 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:03,421 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:03,421 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:04,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:04,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:04,808 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:04,833 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:04,833 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:15:46,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:46,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:15:46,919 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:15:46,924 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:15:46,924 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:03,685 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:03,685 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:03,685 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:03,692 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:03,692 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,775 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,775 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,782 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,782 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,835 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,835 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,837 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,850 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,850 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,850 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,864 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,864 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:14,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:14,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:14,865 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:14,875 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:14,876 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:14,876 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,186 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,186 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,186 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:15,192 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:15,192 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:15,863 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:15,869 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:15,869 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:16:15,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:15,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:15,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:16:17,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:16:17,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:16:17,007 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:16:17,016 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:16:17,016 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:17:16,534 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:17:16,534 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:17:16,534 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:17:16,541 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:17:16,541 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:17:51,872 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:17:51,872 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:17:51,887 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:17:51,887 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:17:51,897 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:17:51,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:17:51,897 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:17:51,897 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 4, 52, 51, 897837), 'iat': datetime.datetime(2025, 6, 26, 4, 17, 51, 897840)}
2025-06-25 21:17:51,898 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:18:08,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:08,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:08,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:14,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:14,820 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:14,825 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:14,825 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:28,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:28,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:28,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:28,594 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:28,604 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:28,604 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:28,605 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:33,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,373 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,373 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:18:33,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:18:33,374 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:18:33,380 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:18:33,380 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:18:33,380 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:08,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:08,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:08,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:08,176 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:08,176 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:08,180 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:08,180 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:14,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:14,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:14,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:14,770 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:14,770 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:14,774 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:14,774 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:19:18,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:19:18,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:19:18,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:18,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:19:18,401 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:19:18,414 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:19:18,415 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:20:15,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:20:15,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:20:15,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:15,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:15,872 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:20:15,877 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:20:15,878 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:20:52,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:20:52,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:20:52,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:52,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:20:52,150 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:20:52,162 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:20:52,162 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:21:17,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:21:17,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:21:17,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:21:17,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:21:17,513 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:21:17,533 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:21:17,534 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:10,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:10,287 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:10,287 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:10,309 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:10,313 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:14,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:14,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:14,776 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:14,792 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:14,793 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:22:26,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:22:26,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:22:26,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:26,190 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:22:26,190 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:22:26,235 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:22:26,235 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:23:16,427 - INFO - app.core.security - Closing Redis connection...
2025-06-25 21:23:16,427 - INFO - app.core.security - Redis connection closed.
2025-06-25 21:31:36,649 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:31:36,649 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:31:36,665 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:31:36,665 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:31:36,676 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:31:36,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:31:36,676 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:31:36,676 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 6, 36, 676612), 'iat': datetime.datetime(2025, 6, 26, 4, 31, 36, 676614)}
2025-06-25 21:31:36,677 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:31:38,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:38,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:38,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:47,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:47,973 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,974 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,974 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:31:47,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:47,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:47,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,975 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:47,975 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:31:47,999 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:31:48,001 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:48,005 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:52,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,431 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,431 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:31:52,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:31:52,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:31:52,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,432 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:31:52,433 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:31:52,443 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:31:52,444 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:31:52,444 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:01,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:01,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:01,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:01,490 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:01,491 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:01,506 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:01,507 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:05,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:05,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:05,612 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:05,615 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:05,615 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,119 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,119 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:06,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:06,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:06,120 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:06,130 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:06,130 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:06,130 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:15,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:15,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:15,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:15,676 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:15,676 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:15,680 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:15,680 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:34,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:34,528 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:34,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:34,529 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:34,529 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:34,531 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:34,531 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:45,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:45,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:45,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:45,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:45,472 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:45,483 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:45,484 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:53,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:53,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:53,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:53,786 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:53,786 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:53,791 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:53,791 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:32:54,069 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:54,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:32:54,071 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:32:54,082 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:32:54,083 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:00,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:00,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:00,565 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:00,568 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:00,568 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:05,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:05,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:05,053 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:05,055 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:05,055 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:14,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:14,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:14,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:14,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:14,773 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:14,781 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:14,782 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:45,783 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:45,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:45,783 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:45,789 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:45,789 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:33:54,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:54,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:33:54,299 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:33:54,302 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:33:54,302 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:05,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,051 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,051 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:05,055 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:05,055 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:05,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,102 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:05,102 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:05,106 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:05,106 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:14,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:14,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:14,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:14,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:14,772 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:14,779 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:14,779 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:15,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:15,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:15,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:15,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:15,371 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:15,391 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:15,391 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:19,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:19,777 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:19,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:19,778 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:19,778 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:19,794 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:19,795 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:23,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:23,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:23,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:23,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:23,036 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:23,048 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:23,048 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:27,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:27,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:27,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:27,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:27,017 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:27,027 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:27,028 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:33,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:33,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:33,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:33,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:33,179 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:33,193 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:33,193 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:39,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:39,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,784 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,784 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:39,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:39,785 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,785 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:39,785 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:40,092 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:40,092 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,092 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:40,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,846 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,846 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:40,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:40,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,847 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:40,847 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:40,857 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:40,857 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:40,857 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:42,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:42,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:42,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,290 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,291 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:42,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:42,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:42,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,292 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:42,292 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:42,300 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:42,300 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:42,300 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:43,215 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,216 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,216 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:43,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:43,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:43,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,217 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:43,217 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:43,230 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:43,230 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:43,231 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,963 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,963 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:44,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:44,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:44,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,964 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:44,964 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:44,975 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:44,977 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:44,977 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,078 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,078 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,078 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,079 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,079 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,094 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,095 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,095 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,104 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,104 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,106 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,106 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,106 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,122 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,122 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,907 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,908 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,908 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:46,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:46,908 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:46,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,909 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:46,909 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:46,920 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:46,920 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:46,921 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:48,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,740 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:48,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:48,741 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:48,748 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:48,748 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:48,748 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:50,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,865 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:50,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:50,866 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:50,873 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:50,873 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:50,874 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:34:54,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:34:54,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:34:54,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:54,579 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:34:54,579 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:34:54,588 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:34:54,589 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:05,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:05,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:05,127 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:05,127 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:05,127 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:05,140 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:05,143 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:14,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:14,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:14,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:14,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:14,776 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:14,783 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:14,783 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:45,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:45,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:45,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:45,481 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:45,481 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:45,494 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:45,494 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:35:54,068 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:35:54,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:35:54,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:54,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:35:54,071 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:35:54,090 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:35:54,090 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:36:05,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:36:05,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:36:05,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:05,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:05,065 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:36:05,091 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:36:05,092 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:36:14,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:36:14,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:36:14,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:14,801 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:36:14,801 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:36:14,817 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:36:14,817 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:37:17,822 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:37:17,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:37:17,823 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:37:17,823 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:37:17,823 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:37:17,878 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:37:17,879 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:02,406 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:02,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:02,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:02,412 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:02,412 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:02,443 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:02,443 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:04,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:04,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:04,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:04,552 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:04,552 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:04,566 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:04,567 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:48,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:48,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:48,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:48,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:48,295 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:48,337 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:48,343 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:50,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:50,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:50,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:50,354 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:50,354 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:50,390 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:50,390 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:57,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:57,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:57,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,242 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,243 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:57,259 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:57,260 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:38:57,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:38:57,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:38:57,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:38:57,318 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:38:57,342 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:38:57,342 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:02,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:02,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:02,539 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:02,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:02,540 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:02,552 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:02,553 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:05,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:05,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:05,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:05,059 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:05,059 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:05,077 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:05,077 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:14,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:14,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:14,783 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:14,796 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:14,797 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:45,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:45,468 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:45,469 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:45,487 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:45,487 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:39:54,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:39:54,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:39:54,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:54,084 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:39:54,084 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:39:54,140 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:39:54,140 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:02,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:02,539 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:02,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:02,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:02,541 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:02,558 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:02,558 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:05,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:05,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:05,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:05,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:05,064 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:05,088 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:05,088 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:14,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:14,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:14,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:14,782 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:14,782 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:14,793 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:14,793 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:16,112 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:16,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:16,113 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:16,113 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:16,113 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:16,123 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:16,123 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:27,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:27,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:27,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:27,683 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:27,683 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:27,769 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:27,771 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:39,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:39,514 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:39,514 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:39,528 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:39,528 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:45,548 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:45,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:45,549 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:45,550 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:45,552 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:45,560 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:45,560 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:51,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:51,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:51,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:51,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:51,523 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:51,547 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:51,547 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:40:54,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:40:54,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:40:54,089 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:54,089 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:40:54,089 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:40:54,111 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:40:54,111 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:00,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:00,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:00,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:00,893 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:00,893 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:00,936 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:00,937 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:02,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:02,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:02,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:02,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:02,555 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:02,568 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:02,568 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:05,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:05,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:05,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:05,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:05,057 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:05,073 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:05,074 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:07,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:07,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:07,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:07,515 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:07,515 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:07,538 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:07,539 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:14,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:14,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:14,863 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:14,922 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:14,923 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:41:16,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:41:16,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:41:16,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:16,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750913100, 'iat': 1750911300}
2025-06-25 21:41:16,065 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:41:16,089 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:41:16,090 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:43,173 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:46:43,173 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:46:43,188 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:46:43,188 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:46:43,203 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:46:43,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:46:43,203 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:46:43,203 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 21, 43, 203237), 'iat': datetime.datetime(2025, 6, 26, 4, 46, 43, 203240)}
2025-06-25 21:46:43,203 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:46:50,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:50,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:50,655 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:50,658 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:50,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:50,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:50,669 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:50,671 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:50,939 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:50,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:50,939 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:50,940 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:54,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:54,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:54,464 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:54,466 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:54,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:54,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:54,514 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:54,516 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 21:46:54,526 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:54,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:54,526 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 21:46:57,995 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:46:57,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:46:57,995 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:46:57,995 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 5, 16, 57, 995121), 'iat': datetime.datetime(2025, 6, 26, 4, 46, 57, 995134)}
2025-06-25 21:46:57,996 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:46:57,996 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MTgwMTcsImlhdCI6MTc1MDkxMzIxN30.bDfW65EZoEdKvXoN9lWyP6d8EMpIR0YWv0jZ3_qua0g, Expiry (seconds): 604800
2025-06-25 21:46:58,000 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-25 21:46:59,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,140 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,140 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:46:59,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,141 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,150 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,151 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,151 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,167 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,168 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,168 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:46:59,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,174 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,178 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,178 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,205 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,206 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,206 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,231 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,231 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,278 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,279 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:46:59,507 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:46:59,507 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:46:59,508 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:46:59,509 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:46:59,559 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:46:59,559 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:01,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:01,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:01,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:01,442 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:01,442 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:01,469 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:01,469 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:01,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:01,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:01,494 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:04,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:04,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:04,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:04,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:04,438 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:04,487 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:04,487 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:18,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,964 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:18,972 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:18,972 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,972 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:18,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:18,983 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:18,998 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:18,998 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:18,998 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:19,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:19,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:19,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:19,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:19,018 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:19,038 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:19,038 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:20,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:20,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:20,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:20,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:20,269 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:20,286 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:20,286 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:20,305 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:20,305 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:20,306 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:21,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:21,298 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:21,298 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:21,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:21,299 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:21,378 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:21,378 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:23,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:23,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:23,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:23,450 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:23,450 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:23,503 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:23,503 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,690 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,690 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:37,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,691 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,691 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:37,699 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:37,700 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,700 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,716 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,716 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:47:37,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,728 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,743 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:37,763 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:37,763 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,764 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:37,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:37,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:37,795 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,795 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:37,795 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:37,871 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:37,872 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:38,041 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:38,041 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:38,041 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:38,042 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:38,042 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:38,210 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:38,211 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:39,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:39,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:39,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:39,779 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:39,779 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:39,796 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:39,796 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:47:39,805 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:39,805 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:39,805 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:42,466 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:47:42,466 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:47:42,467 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:42,467 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:47:42,467 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:47:42,498 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:47:42,498 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:48:37,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:48:37,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:48:37,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:48:37,870 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:48:37,870 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:48:37,884 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:48:37,885 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:48:51,174 - INFO - app.core.security - Closing Redis connection...
2025-06-25 21:48:51,175 - INFO - app.core.security - Redis connection closed.
2025-06-25 21:54:00,676 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 21:54:00,676 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 21:54:00,689 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 21:54:00,689 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 21:54:00,699 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 21:54:00,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 21:54:00,699 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 21:54:00,699 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 29, 0, 699634), 'iat': datetime.datetime(2025, 6, 26, 4, 54, 0, 699640)}
2025-06-25 21:54:00,700 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 21:54:11,537 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,538 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,538 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,538 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:11,547 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:11,547 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:11,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,886 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:11,890 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:11,890 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:11,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:11,979 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:11,985 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:11,985 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:11,985 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,016 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:12,024 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:12,024 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,025 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,163 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,163 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,164 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,164 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,164 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:12,169 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:12,169 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:12,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,732 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:12,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:12,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:12,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:12,758 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:12,758 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:14,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:14,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:14,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:14,144 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:14,144 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:14,154 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:14,154 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,037 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,037 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:19,037 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,037 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,037 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,038 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,038 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:19,046 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:19,046 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,046 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,081 - INFO - app.core.security - Token payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,082 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 21:54:19,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,083 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:19,160 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:19,161 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,161 - INFO - app.core.security - Authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:19,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:19,195 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:19,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,196 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:19,197 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:19,224 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:19,224 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:20,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:20,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:20,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:20,744 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:20,744 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:20,768 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:20,769 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:20,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:20,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:20,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:21,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:21,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:21,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:21,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:21,648 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:22,019 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:22,020 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:24,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:24,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:24,020 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:24,021 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:24,021 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:24,072 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:24,073 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:43,838 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:43,838 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:43,839 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:43,839 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:43,839 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:43,901 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:43,902 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:48,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:48,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:48,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:48,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:48,827 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:48,845 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:48,847 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:54:52,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 21:54:52,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 21:54:52,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:52,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 21:54:52,612 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 21:54:52,630 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 21:54:52,632 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 21:55:00,000 - INFO - app.core.security - Closing Redis connection...
2025-06-25 21:55:00,001 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:03:30,000 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:03:30,000 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:03:30,007 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:03:30,007 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:03:30,024 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:03:30,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:03:30,024 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:03:30,024 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 38, 30, 24096), 'iat': datetime.datetime(2025, 6, 26, 5, 3, 30, 24099)}
2025-06-25 22:03:30,024 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:03:36,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:36,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:36,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:36,905 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:36,906 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 22:03:36,943 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 22:03:36,943 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 22:03:36,944 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTA5MTUwMTcsImlhdCI6MTc1MDkxMzIxN30.b-ZMTFc_Ja_sEW_GKrYGuaX25uII5cwEAB4bDpM20yA
2025-06-25 22:03:36,949 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTA5MTUwMTcsImlhdCI6MTc1MDkxMzIxN30.b-ZMTFc_Ja_sEW_GKrYGuaX25uII5cwEAB4bDpM20yA
2025-06-25 22:03:38,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:38,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:38,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,028 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,028 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 22:03:38,032 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 22:03:38,033 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 22:03:38,086 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:38,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:38,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': 1750915017, 'iat': 1750913217}
2025-06-25 22:03:38,088 - INFO - app.core.security - Looking up demo user with ID: 6
2025-06-25 22:03:38,102 - INFO - app.core.security - Found demo user - ID: 6, Type: demo
2025-06-25 22:03:38,103 - INFO - app.core.security - Successfully authenticated user - ID: 6, Type: demo, Class: DemoUser
2025-06-25 22:03:40,551 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:03:40,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:03:40,551 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:03:40,551 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 6, 26, 5, 33, 40, 551046), 'iat': datetime.datetime(2025, 6, 26, 5, 3, 40, 551057)}
2025-06-25 22:03:40,552 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:03:40,552 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTE1MTkwMjAsImlhdCI6MTc1MDkxNDIyMH0.EqCA7daInEDIx9tdDbvttmAtGlsX-O_qOg4dJ5OmCSY, Expiry (seconds): 604800
2025-06-25 22:03:40,557 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-06-25 22:03:41,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:41,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:41,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,951 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,953 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:03:41,953 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:41,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:41,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:41,971 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:42,054 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:42,054 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,054 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:42,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:42,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,083 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,083 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:03:42,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:42,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:42,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,088 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:42,148 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:42,152 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,152 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:42,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:42,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:42,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,168 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:42,168 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:42,199 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:42,199 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:43,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:43,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:43,391 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:43,395 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:43,395 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:43,418 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:43,421 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:43,468 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:43,468 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:43,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:44,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:44,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:44,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:44,567 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:44,567 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:44,836 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:44,837 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:03:46,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:03:46,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:03:46,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:46,443 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:03:46,444 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:03:46,461 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:03:46,462 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:04:02,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:04:02,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:04:02,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:02,890 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:02,891 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:04:02,938 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:04:02,941 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:04:05,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:04:05,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:04:05,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:05,686 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:05,686 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:04:05,721 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:04:05,722 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:04:10,382 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:04:10,382 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:04:10,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:10,382 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:04:10,382 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:04:10,396 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:04:10,399 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:07,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:07,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:07,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,160 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,160 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:07,175 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:07,176 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:07,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:07,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:07,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:07,282 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:07,289 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:07,289 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:08,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:08,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:08,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:08,433 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:08,433 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:08,442 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:08,443 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:08,473 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:08,474 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:08,475 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:09,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:09,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:09,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:09,786 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:09,787 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:09,806 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:09,807 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:05:49,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:05:49,318 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:05:49,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:49,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:05:49,318 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:05:49,323 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:05:49,324 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:06:07,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:06:07,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:06:07,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:07,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:07,687 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:06:07,696 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:06:07,696 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:06:49,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:06:49,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:06:49,020 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:49,020 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:49,020 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:06:49,026 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:06:49,026 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:06:50,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:06:50,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:06:50,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:50,653 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:06:50,653 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:06:50,660 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:06:50,660 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:07,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:07,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:07,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:07,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:07,675 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:07,681 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:07,681 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:49,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:49,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:49,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,838 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,838 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:49,848 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:49,848 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:49,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:49,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:49,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,897 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:49,911 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:49,911 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:07:49,943 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:07:49,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:07:49,944 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,944 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1750916020, 'iat': 1750914220}
2025-06-25 22:07:49,945 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-25 22:07:49,958 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-25 22:07:49,958 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-25 22:08:02,868 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:08:02,869 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:11:42,943 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:11:42,944 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:11:42,962 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:11:42,963 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:11:42,978 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:11:42,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:11:42,978 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:11:42,978 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 46, 42, 978617), 'iat': datetime.datetime(2025, 6, 26, 5, 11, 42, 978621)}
2025-06-25 22:11:42,982 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:18:23,995 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:18:23,995 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:18:27,420 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:18:27,420 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:18:27,431 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:18:27,431 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:18:27,438 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:18:27,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:18:27,438 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:18:27,438 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 5, 53, 27, 438339), 'iat': datetime.datetime(2025, 6, 26, 5, 18, 27, 438341)}
2025-06-25 22:18:27,438 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:21:27,927 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:21:27,928 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:30:37,529 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:30:37,529 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:30:37,541 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:30:37,541 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:30:37,549 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:30:37,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:30:37,549 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:30:37,549 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 5, 37, 549394), 'iat': datetime.datetime(2025, 6, 26, 5, 30, 37, 549397)}
2025-06-25 22:30:37,549 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:32:38,655 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:32:38,671 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:40:05,609 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:40:05,609 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:40:05,631 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:40:05,631 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:40:05,650 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:40:05,650 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:40:05,650 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:40:05,650 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 15, 5, 650571), 'iat': datetime.datetime(2025, 6, 26, 5, 40, 5, 650576)}
2025-06-25 22:40:05,652 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:40:21,342 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:40:21,343 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:40:24,702 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:40:24,702 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:40:24,714 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:40:24,715 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:40:24,727 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:40:24,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:40:24,727 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:40:24,727 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 15, 24, 727453), 'iat': datetime.datetime(2025, 6, 26, 5, 40, 24, 727458)}
2025-06-25 22:40:24,728 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:40:41,922 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:40:41,922 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:40:44,483 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:40:44,483 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:40:44,499 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:40:44,499 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:40:44,506 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:40:44,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:40:44,506 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:40:44,506 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 15, 44, 506550), 'iat': datetime.datetime(2025, 6, 26, 5, 40, 44, 506552)}
2025-06-25 22:40:44,507 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:42:35,470 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:42:35,471 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:42:38,771 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:42:38,772 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:42:38,783 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:42:38,783 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:42:38,794 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:42:38,794 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:42:38,794 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:42:38,794 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 17, 38, 794548), 'iat': datetime.datetime(2025, 6, 26, 5, 42, 38, 794556)}
2025-06-25 22:42:38,795 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:43:01,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:43:01,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:43:01,643 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-25 22:43:01,648 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 22:43:23,689 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:43:23,691 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:43:26,464 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:43:26,464 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:43:26,473 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:43:26,474 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:43:26,481 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:43:26,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:43:26,481 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:43:26,481 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 18, 26, 481386), 'iat': datetime.datetime(2025, 6, 26, 5, 43, 26, 481389)}
2025-06-25 22:43:26,482 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:43:28,768 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:43:28,768 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:43:31,684 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:43:31,684 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:43:31,697 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:43:31,697 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:43:31,706 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:43:31,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:43:31,707 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:43:31,707 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 18, 31, 706891), 'iat': datetime.datetime(2025, 6, 26, 5, 43, 31, 706896)}
2025-06-25 22:43:31,707 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:44:12,560 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:44:12,563 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:44:16,023 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:44:16,023 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:44:16,029 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:44:16,030 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:44:16,035 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:44:16,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:44:16,035 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:44:16,035 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 19, 16, 35509), 'iat': datetime.datetime(2025, 6, 26, 5, 44, 16, 35512)}
2025-06-25 22:44:16,035 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:44:19,419 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:44:19,419 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:44:23,061 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:44:23,061 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:44:23,077 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:44:23,077 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:44:23,090 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:44:23,090 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:44:23,090 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:44:23,090 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 19, 23, 90471), 'iat': datetime.datetime(2025, 6, 26, 5, 44, 23, 90475)}
2025-06-25 22:44:23,091 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:44:24,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:44:24,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:44:24,902 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-25 22:44:24,909 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 22:45:12,244 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:45:12,246 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:45:15,389 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:45:15,389 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:45:15,403 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:45:15,403 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:45:15,414 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:45:15,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:45:15,414 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:45:15,414 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 20, 15, 414051), 'iat': datetime.datetime(2025, 6, 26, 5, 45, 15, 414056)}
2025-06-25 22:45:15,414 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:45:19,095 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:45:19,095 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:45:21,343 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:45:21,343 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:45:21,349 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:45:21,349 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:45:21,357 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:45:21,357 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:45:21,357 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:45:21,357 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 20, 21, 357623), 'iat': datetime.datetime(2025, 6, 26, 5, 45, 21, 357626)}
2025-06-25 22:45:21,358 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:45:34,328 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:45:34,328 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:45:34,328 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:45:34,328 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:45:34,328 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:45:34,342 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:45:34,342 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:45:53,497 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:45:53,498 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:45:56,649 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:45:56,649 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:45:56,677 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:45:56,677 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:45:56,690 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:45:56,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:45:56,690 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:45:56,690 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 20, 56, 690111), 'iat': datetime.datetime(2025, 6, 26, 5, 45, 56, 690113)}
2025-06-25 22:45:56,690 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:46:14,210 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:46:14,211 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:46:14,216 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:46:14,216 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:46:14,225 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:46:14,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:46:14,226 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:46:14,226 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 21, 14, 225929), 'iat': datetime.datetime(2025, 6, 26, 5, 46, 14, 225933)}
2025-06-25 22:46:14,227 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:47:35,550 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:47:35,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:47:35,551 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:47:35,551 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750918473, 'iat': 1750916673}
2025-06-25 22:47:35,551 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:47:35,555 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:47:35,556 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,555 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,559 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,561 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:57:58,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,563 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:58,571 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:58,572 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,572 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,611 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,612 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:57:58,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,612 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:58,620 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:58,620 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,620 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:58,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:58,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:58,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:58,628 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:58,674 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:58,674 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:59,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:59,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:59,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,131 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,131 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:59,136 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:59,137 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:57:59,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:59,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:59,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:57:59,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:57:59,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:57:59,584 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:57:59,592 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:57:59,592 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:00,962 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:00,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:00,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:00,963 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:00,963 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:01,031 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:01,031 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:04,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:04,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:04,240 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:04,240 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:04,240 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:04,245 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:04,245 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:16,990 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,991 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,991 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:16,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:16,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:16,992 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:16,999 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:16,999 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:17,000 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:58:38,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:58:38,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:58:38,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:38,049 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 22:58:38,050 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 22:58:38,059 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 22:58:38,059 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 22:59:16,870 - INFO - app.core.security - Closing Redis connection...
2025-06-25 22:59:16,872 - INFO - app.core.security - Redis connection closed.
2025-06-25 22:59:20,592 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 22:59:20,592 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 22:59:20,605 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 22:59:20,605 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 22:59:20,614 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 22:59:20,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 22:59:20,614 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 22:59:20,614 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 34, 20, 614224), 'iat': datetime.datetime(2025, 6, 26, 5, 59, 20, 614227)}
2025-06-25 22:59:20,614 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 22:59:22,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 22:59:22,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 22:59:22,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:01:24,723 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:01:24,724 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:05:41,071 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:05:41,071 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:05:41,088 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:05:41,088 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:05:41,103 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:05:41,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:05:41,103 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:05:41,103 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 40, 41, 103302), 'iat': datetime.datetime(2025, 6, 26, 6, 5, 41, 103306)}
2025-06-25 23:05:41,104 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:05:43,731 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:43,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:43,762 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:44,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:44,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:44,716 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:44,719 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:05:45,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:45,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:45,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:05:49,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:49,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:49,697 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:50,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:50,667 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:50,668 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:50,670 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:05:53,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:53,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:53,684 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:05:53,688 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:05:55,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:05:55,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:05:55,691 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:01,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:01,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:01,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:07,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:07,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:07,706 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:09,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:09,729 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,733 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:09,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:09,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:09,769 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,773 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:09,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:09,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:09,810 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:09,812 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:13,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:13,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:13,707 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:19,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:19,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:19,733 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:25,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:25,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:25,773 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:28,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:28,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:28,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:28,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:28,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:06:28,293 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:06:28,293 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:06:31,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:31,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:31,755 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:37,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:37,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:37,857 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:43,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:43,917 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:43,917 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:44,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:44,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:44,711 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:44,712 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:49,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:49,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:49,844 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:52,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:52,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:52,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:52,206 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:06:52,206 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:06:52,209 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:06:52,210 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:06:53,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:53,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:53,774 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:06:53,776 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:06:55,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:06:55,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:06:55,890 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:02,041 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:02,041 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:02,042 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:08,161 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:08,161 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:08,161 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,676 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,676 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,678 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:10,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,689 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,691 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:10,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,702 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,704 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:10,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:10,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:10,712 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:07:10,713 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:07:16,754 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:16,755 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:07:20,007 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:07:20,007 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:07:20,018 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:07:20,018 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:07:20,027 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:07:20,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:07:20,028 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:07:20,028 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 42, 20, 27923), 'iat': datetime.datetime(2025, 6, 26, 6, 7, 20, 27927)}
2025-06-25 23:07:20,028 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:07:23,642 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:23,643 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:07:26,667 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:07:26,668 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:07:26,677 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:07:26,677 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:07:26,692 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:07:26,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:07:26,692 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:07:26,692 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 42, 26, 692654), 'iat': datetime.datetime(2025, 6, 26, 6, 7, 26, 692658)}
2025-06-25 23:07:26,693 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:07:30,499 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:30,500 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:07:33,533 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:07:33,534 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:07:33,548 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:07:33,548 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:07:33,559 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:07:33,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:07:33,559 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:07:33,559 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 42, 33, 559465), 'iat': datetime.datetime(2025, 6, 26, 6, 7, 33, 559468)}
2025-06-25 23:07:33,560 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:07:35,978 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:07:35,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:07:35,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:07:58,251 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:07:58,251 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:08:01,515 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:08:01,515 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:08:01,526 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:08:01,526 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:08:01,533 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:08:01,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:08:01,534 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:08:01,534 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 43, 1, 533962), 'iat': datetime.datetime(2025, 6, 26, 6, 8, 1, 533965)}
2025-06-25 23:08:01,534 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:08:04,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:08:04,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:08:04,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:08:04,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:08:04,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:08:04,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:08:04,763 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:08:04,763 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:08:04,784 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:08:04,784 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:08:40,025 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:08:40,026 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:15:11,152 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:15:11,152 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:15:11,171 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:15:11,171 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:15:11,185 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:15:11,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:15:11,185 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:15:11,185 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 50, 11, 184979), 'iat': datetime.datetime(2025, 6, 26, 6, 15, 11, 184983)}
2025-06-25 23:15:11,186 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:15:13,572 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:15:13,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:15:13,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:15:20,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:15:20,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:15:20,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:15:20,463 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:15:20,463 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:15:20,474 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:15:20,475 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:15:59,440 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:15:59,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:15:59,441 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:15:59,441 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 26, 6, 45, 59, 440748), 'iat': datetime.datetime(2025, 6, 26, 6, 15, 59, 440756)}
2025-06-25 23:15:59,441 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:15:59,441 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTUyMzM1OSwiaWF0IjoxNzUwOTE4NTU5fQ.nEPxuTBKd4cEljInaOljF8BSWYFcQx-PnPFlRmYbkCE, Expiry (seconds): 604800
2025-06-25 23:15:59,446 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-25 23:16:49,898 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:16:49,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:16:49,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:16:49,899 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:16:49,899 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:16:49,905 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:16:49,905 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:16:59,718 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:16:59,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:16:59,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:16:59,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:16:59,719 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:16:59,722 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:16:59,723 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:17:20,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:17:20,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:17:20,596 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:17:20,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750919275, 'iat': 1750917475}
2025-06-25 23:17:20,596 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:17:20,601 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:17:20,601 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:17:53,079 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:17:53,079 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:21:46,082 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:21:46,083 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:21:46,107 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:21:46,107 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:21:46,117 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:21:46,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:21:46,117 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:21:46,117 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 56, 46, 117730), 'iat': datetime.datetime(2025, 6, 26, 6, 21, 46, 117734)}
2025-06-25 23:21:46,119 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:22:01,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,453 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,453 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:22:01,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,454 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,454 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,454 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,454 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,468 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,468 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,468 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:22:01,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,501 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,513 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,514 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,514 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,522 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,543 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,543 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:01,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:01,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:01,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:01,966 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:01,976 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:01,977 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:02,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:02,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:02,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,018 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:02,033 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:02,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:02,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:02,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:02,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:02,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:02,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,883 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:02,883 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:02,897 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:02,897 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:05,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:05,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:05,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:05,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:05,803 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:05,813 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:05,813 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:12,549 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:12,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:12,549 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,549 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,550 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:22:12,550 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:12,550 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:12,551 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,551 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:12,551 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:12,558 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:12,558 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:12,559 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:19,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:19,952 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:19,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:19,953 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:19,953 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:19,967 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:19,967 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:22:37,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:22:37,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:22:37,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:37,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:22:37,291 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:22:37,300 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:22:37,301 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:23:20,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:23:20,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:23:20,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:20,955 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:20,955 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:23:20,978 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:23:20,979 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:23:33,268 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:23:33,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:23:33,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:23:33,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:23:33,269 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:23:33,272 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:23:33,273 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:23:35,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:23:35,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:23:35,577 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:35,577 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:23:35,577 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:23:35,582 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:23:35,582 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:24:03,552 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:24:03,552 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:24:06,728 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:24:06,728 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:24:06,738 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:24:06,738 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:24:06,748 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:24:06,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:24:06,749 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:24:06,749 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 6, 59, 6, 748922), 'iat': datetime.datetime(2025, 6, 26, 6, 24, 6, 748926)}
2025-06-25 23:24:06,749 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:24:08,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:24:08,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:24:08,809 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:25:09,599 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:25:09,599 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:25:12,867 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:25:12,867 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:25:12,879 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:25:12,879 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:25:12,886 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:25:12,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:25:12,886 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:25:12,886 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 0, 12, 886077), 'iat': datetime.datetime(2025, 6, 26, 6, 25, 12, 886080)}
2025-06-25 23:25:12,886 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:25:16,574 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:25:16,575 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:25:19,794 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:25:19,795 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:25:19,806 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:25:19,806 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:25:19,820 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:25:19,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:25:19,820 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:25:19,820 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 0, 19, 820036), 'iat': datetime.datetime(2025, 6, 26, 6, 25, 19, 820043)}
2025-06-25 23:25:19,821 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:25:51,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:25:51,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:25:51,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:02,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:26:02,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:26:02,969 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:02,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:02,969 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:26:02,974 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:26:02,974 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:26:26,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:26:26,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:26:26,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:26,695 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:26,695 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:26:26,726 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:26:26,728 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:26:49,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:26:49,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:26:49,252 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:49,252 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:26:49,252 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:26:49,261 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:26:49,261 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:27:09,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:09,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:09,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:09,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:09,386 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:27:09,395 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:27:09,396 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:27:13,816 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:13,816 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:17,050 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:17,051 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:17,061 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:17,061 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:17,073 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:17,073 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:17,073 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:17,073 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 17, 73689), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 17, 73694)}
2025-06-25 23:27:17,074 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:18,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:18,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:18,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:25,278 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:25,279 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:27,963 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:27,964 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:27,975 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:27,975 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:27,986 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:27,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:27,986 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:27,986 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 27, 986642), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 27, 986647)}
2025-06-25 23:27:27,987 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:29,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:29,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:29,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:30,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:30,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:30,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:30,427 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:30,427 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:27:30,437 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:27:30,437 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:27:34,521 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:34,522 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:37,207 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:37,207 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:37,220 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:37,220 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:37,228 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:37,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:37,228 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:37,228 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 37, 228180), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 37, 228182)}
2025-06-25 23:27:37,228 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:39,209 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:27:39,210 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:27:45,596 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:27:45,597 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:27:45,625 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:27:45,625 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:27:45,642 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:27:45,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:27:45,642 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:27:45,642 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 2, 45, 642199), 'iat': datetime.datetime(2025, 6, 26, 6, 27, 45, 642206)}
2025-06-25 23:27:45,642 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:27:47,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:47,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:47,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:49,922 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:27:49,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:27:49,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:49,924 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:27:49,930 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:27:50,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:27:50,079 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:21,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:21,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:21,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:21,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:21,522 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:21,539 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:21,540 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,430 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,430 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:28:38,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,431 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,432 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,457 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,457 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,457 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,528 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,547 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,552 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,649 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,649 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:28:38,650 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,650 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,651 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,651 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,652 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,678 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,680 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,682 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:38,936 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:38,936 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:38,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:38,937 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:38,957 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:38,958 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:41,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:41,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:41,783 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:41,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:41,788 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:41,830 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:41,831 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:44,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:44,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:44,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:44,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:44,280 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:44,294 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:44,295 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:28:44,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:44,576 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:44,576 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:52,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:28:52,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:28:52,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:52,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:28:52,919 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:28:53,018 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:28:53,019 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:12,672 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:12,672 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:12,673 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:12,674 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:12,674 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:12,693 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:12,694 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:19,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:19,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:19,891 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:19,892 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:19,892 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:19,917 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:19,917 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:28,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:28,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:28,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,785 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,785 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:29:28,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:28,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:28,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,787 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:28,787 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:28,809 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:28,810 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:28,810 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:32,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:32,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:32,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:32,227 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:32,228 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:32,289 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:32,289 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:29:57,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:29:57,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:29:57,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:57,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:29:57,508 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:29:57,649 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:29:57,649 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:01,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:30:01,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:30:01,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:01,085 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:01,085 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:30:01,094 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:30:01,094 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:14,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:30:14,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:30:14,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:14,081 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:14,081 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:30:14,100 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:30:14,100 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:36,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:30:36,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:30:36,421 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:36,421 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:30:36,421 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:30:36,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:30:36,428 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:30:56,943 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:30:56,948 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:31:02,422 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:31:02,422 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:31:02,437 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:31:02,438 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:31:02,453 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:31:02,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:31:02,453 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:31:02,453 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 6, 2, 452967), 'iat': datetime.datetime(2025, 6, 26, 6, 31, 2, 452976)}
2025-06-25 23:31:02,454 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:31:04,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:04,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:04,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:04,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:04,243 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:04,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:04,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:04,248 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:31:04,249 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:31:04,249 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:31:04,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:04,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:04,254 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:04,456 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:04,456 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:04,465 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:31:04,465 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:31:27,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:27,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:27,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:27,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:27,202 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:27,212 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:27,213 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,111 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,111 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:31:33,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,112 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,112 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,112 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,159 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,160 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,184 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,199 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,199 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,199 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,222 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,222 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,222 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,238 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,238 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,535 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,536 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,553 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,554 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:33,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:33,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:33,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,905 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:33,905 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:33,913 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:33,914 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:34,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:34,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:34,233 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:34,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:34,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:34,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:34,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:31:34,581 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:31:34,600 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:31:34,601 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:31:40,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,062 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,081 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,162 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,162 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,163 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,167 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,204 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,213 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,274 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,275 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,297 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,299 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:40,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:40,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:40,320 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:40,323 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:43,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:43,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:43,115 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:43,117 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:44,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:44,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:44,706 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:44,708 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:45,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:45,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:45,674 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:49,792 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:49,792 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:49,793 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:49,795 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:49,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:49,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:49,836 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:49,838 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:53,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:53,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:53,201 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:53,203 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:53,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:53,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:53,235 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:53,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:53,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:53,535 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:31:53,537 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:31:59,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:31:59,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:31:59,669 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:01,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:01,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:01,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:01,100 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:01,100 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:32:01,109 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:32:01,109 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:32:05,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:05,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:05,754 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:07,973 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:07,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:07,973 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:07,975 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:32:11,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:11,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:11,726 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:17,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:17,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:17,676 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:23,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:23,670 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:23,670 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:27,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:27,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:27,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:27,682 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:27,682 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:32:27,686 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:32:27,686 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:32:29,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:29,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:29,666 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:35,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:35,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:35,682 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:41,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:41,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:41,680 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:43,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:43,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:43,685 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:43,686 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:32:44,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:44,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:44,678 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:44,679 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:32:45,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:45,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:45,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:45,289 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:32:45,289 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:32:45,292 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:32:45,292 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:32:47,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:47,667 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:47,668 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:53,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:53,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:53,679 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:32:59,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:32:59,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:32:59,700 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:05,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:05,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:05,697 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:06,508 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:06,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:06,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:06,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:06,509 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:33:06,517 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:33:06,517 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:33:08,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,673 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,675 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,696 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,697 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,709 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,710 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,731 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,732 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:08,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:08,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:08,749 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:08,751 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:11,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:11,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:11,696 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:17,842 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:17,842 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:20,896 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:20,896 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:20,909 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:20,910 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:20,923 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:20,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:20,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:20,923 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 20, 923014), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 20, 923018)}
2025-06-25 23:33:20,923 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:22,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:22,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:22,596 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:22,990 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:22,990 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:22,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:25,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:25,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:25,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:25,107 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:25,108 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:33:25,128 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:33:25,129 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:33:27,692 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:27,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:27,693 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:29,296 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:29,297 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:34,070 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:34,070 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:34,096 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:34,097 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:34,112 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:34,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:34,112 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:34,112 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 34, 112420), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 34, 112423)}
2025-06-25 23:33:34,112 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:36,172 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:36,173 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:41,393 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:41,394 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:41,425 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:41,425 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:41,443 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:41,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:41,444 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:41,444 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 41, 443852), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 41, 443866)}
2025-06-25 23:33:41,445 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:43,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:43,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:43,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:43,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:43,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:43,687 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:43,691 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:33:45,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:45,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:45,045 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:52,246 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:33:52,246 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:33:58,082 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:33:58,082 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:33:58,090 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:33:58,090 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:33:58,103 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:33:58,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:33:58,103 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:33:58,103 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 8, 58, 103140), 'iat': datetime.datetime(2025, 6, 26, 6, 33, 58, 103143)}
2025-06-25 23:33:58,103 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:33:59,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:59,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:59,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:59,844 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:33:59,845 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:33:59,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:59,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:59,848 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:33:59,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:33:59,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:33:59,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:00,243 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:00,244 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:09,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:09,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:09,969 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:09,969 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:09,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:09,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:09,980 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,234 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,236 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,247 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,249 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,265 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,266 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,267 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,280 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,283 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:10,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:10,298 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:10,299 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:10,301 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:18,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:18,031 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:18,032 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,032 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,032 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:18,046 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:18,068 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:18,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:18,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:18,182 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,183 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:18,183 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:18,221 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:18,222 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:20,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:20,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:20,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:27,333 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:27,334 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:27,334 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:27,334 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:27,335 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:27,361 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:27,361 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:28,491 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:28,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:28,498 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:28,498 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:34:28,501 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:34:28,518 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:34:28,519 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:34:30,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:30,786 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:30,786 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:40,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:40,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:40,662 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:43,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:43,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:43,675 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:34:43,677 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-25 23:34:51,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:34:51,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:34:51,439 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:35:00,146 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:00,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:00,147 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-25 23:35:03,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:03,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:03,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,213 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,213 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:35:03,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:03,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:03,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:03,214 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:03,227 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:03,227 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:03,227 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:18,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:18,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:18,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:18,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:18,149 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:18,156 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:18,157 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:24,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:24,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:24,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:24,936 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:24,936 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:24,946 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:24,947 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:37,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:37,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:37,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:37,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:37,886 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:37,890 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:37,890 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:35:42,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:42,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:42,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:35:42,066 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:35:42,066 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:35:42,072 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:35:42,072 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:35:59,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:35:59,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:35:59,430 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:59,430 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:35:59,430 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:35:59,435 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:35:59,436 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:36:20,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:36:20,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:36:20,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:20,319 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:20,319 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:36:20,324 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:36:20,324 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:36:24,610 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:36:24,611 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:36:27,704 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:36:27,704 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:36:27,716 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:36:27,716 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:36:27,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:36:27,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:36:27,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:36:27,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 11, 27, 723321), 'iat': datetime.datetime(2025, 6, 26, 6, 36, 27, 723323)}
2025-06-25 23:36:27,723 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:36:29,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:36:29,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:36:29,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:41,113 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:36:41,113 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:36:41,114 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:41,114 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:36:41,114 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:36:41,122 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:36:41,123 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:37:00,925 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:37:00,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:37:00,926 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:37:00,926 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:37:00,926 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:37:00,945 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:37:00,946 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:37:07,127 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:37:07,129 - INFO - app.core.security - Redis connection closed.
2025-06-25 23:39:28,454 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:39:28,454 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:39:28,499 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:39:28,499 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:39:30,154 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-25 23:39:30,154 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-25 23:39:30,167 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-25 23:39:30,167 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-25 23:39:30,180 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-25 23:39:30,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-25 23:39:30,180 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-25 23:39:30,180 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 14, 30, 180155), 'iat': datetime.datetime(2025, 6, 26, 6, 39, 30, 180161)}
2025-06-25 23:39:30,181 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-25 23:39:37,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:37,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:37,351 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:39:37,727 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:37,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:37,729 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:39:37,729 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750920718, 'iat': 1750918918}
2025-06-25 23:39:37,730 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:37,824 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:37,825 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,658 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,658 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:39:50,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,659 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,659 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:50,688 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:50,688 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,691 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,766 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,766 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:39:50,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,769 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,770 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:50,844 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:50,845 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,852 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:50,922 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:50,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:50,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,923 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:50,923 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:50,993 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:50,997 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:53,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:53,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:53,574 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:53,623 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:53,623 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:54,232 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:54,233 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:55,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:55,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:55,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:55,145 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:39:55,145 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:39:55,213 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:39:55,214 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:39:55,510 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:39:55,510 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:39:55,511 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:03,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:03,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:03,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:03,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:03,526 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:03,586 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:03,587 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:10,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:10,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:10,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:11,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:11,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:11,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:11,436 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:11,436 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:11,651 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:11,665 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:20,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:20,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:20,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:20,726 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:20,726 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:20,739 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:20,740 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:30,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:30,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:30,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,095 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,095 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-25 23:40:30,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:30,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:30,096 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,096 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:30,096 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:30,104 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:30,105 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:30,105 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:32,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:32,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:32,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:32,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:32,541 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:32,599 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:32,600 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:40:54,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:40:54,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:40:54,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:54,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:40:54,635 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:40:54,648 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:40:54,649 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:41:19,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:41:19,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:41:19,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:19,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:19,972 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:41:19,980 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:41:19,980 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:41:23,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:41:23,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:41:23,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:41:23,413 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750920359, 'iat': 1750918559}
2025-06-25 23:41:23,413 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-25 23:41:23,439 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-25 23:41:23,440 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-25 23:41:50,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:41:50,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:41:50,145 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:50,146 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:41:50,146 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:41:50,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:41:50,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:10,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:10,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:10,639 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:10,639 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:10,639 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:10,648 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:10,648 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:32,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:32,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:32,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:32,857 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:32,857 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:32,880 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:32,882 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:34,482 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:34,483 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:34,483 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:34,484 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:34,484 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:34,495 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:34,496 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:42:53,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:42:53,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:42:53,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:53,279 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:42:53,279 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:42:53,286 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:42:53,287 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:43:22,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:43:22,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:43:22,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:22,835 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:22,835 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:43:22,841 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:43:22,841 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:43:40,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:43:40,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:43:40,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:40,205 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:43:40,205 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:43:40,219 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:43:40,219 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:01,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:44:01,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:44:01,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:01,196 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:01,196 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:44:01,203 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:44:01,203 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:22,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:44:22,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:44:22,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:22,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:22,611 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:44:22,614 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:44:22,614 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:41,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-25 23:44:41,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-25 23:44:41,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:41,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750921788, 'iat': 1750919988}
2025-06-25 23:44:41,803 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-25 23:44:41,811 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-25 23:44:41,811 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-25 23:44:42,802 - INFO - app.core.security - Closing Redis connection...
2025-06-25 23:44:42,805 - INFO - app.core.security - Redis connection closed.
2025-06-26 00:17:59,637 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 00:17:59,637 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 00:17:59,747 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 00:17:59,747 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 00:17:59,812 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 00:17:59,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 00:17:59,812 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 00:17:59,812 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 7, 52, 59, 812286), 'iat': datetime.datetime(2025, 6, 26, 7, 17, 59, 812292)}
2025-06-26 00:17:59,823 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 00:18:02,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,198 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,206 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,233 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,262 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,265 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,288 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,289 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,306 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,307 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,330 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,430 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,448 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,505 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,506 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,511 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,729 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,750 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,757 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,821 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,823 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,842 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,844 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,868 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,868 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,869 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,872 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,907 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,924 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,924 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,927 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,950 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,952 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,956 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,976 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,978 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:02,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:02,996 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:02,996 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:02,999 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,018 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,021 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,037 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,037 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,038 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,040 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,062 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,065 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,088 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,090 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,114 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,115 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,117 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,139 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,141 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,163 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,164 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,166 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,187 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,204 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,207 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,225 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,245 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,247 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,270 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,272 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,290 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,293 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,311 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,313 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,332 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,334 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,352 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,353 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,355 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,374 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,376 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,415 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,417 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,435 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,437 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,458 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,460 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,479 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,482 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,500 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,501 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,518 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,519 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,541 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,541 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,543 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:03,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:03,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:03,562 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 00:18:03,564 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 00:18:14,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,427 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,427 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 00:18:14,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,428 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,428 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:14,464 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:14,464 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,465 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,495 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,495 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 00:18:14,496 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,496 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,497 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,497 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:14,515 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:14,516 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,516 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:14,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:14,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:14,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:14,526 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:14,558 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:14,559 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:15,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:15,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:15,412 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:15,412 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:15,412 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:15,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:15,428 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:15,745 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:15,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:15,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:16,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:16,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,659 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:16,671 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:16,671 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:16,717 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:16,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:16,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:16,719 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:16,746 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:16,746 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:18:21,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:18:21,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:18:21,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:21,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:18:21,752 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:18:21,767 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:18:21,768 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:11,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:11,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:11,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,168 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,168 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 00:19:11,168 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:11,168 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:11,169 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,169 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:11,169 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:19:11,191 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:19:11,192 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:11,198 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:21,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:21,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:21,181 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:21,181 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:21,181 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:19:21,195 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:19:21,196 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:19:36,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:19:36,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:19:36,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:36,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:19:36,966 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:19:36,984 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:19:36,984 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:20:21,663 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 00:20:21,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 00:20:21,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 00:20:21,664 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 26, 7, 50, 21, 663887), 'iat': datetime.datetime(2025, 6, 26, 7, 20, 21, 663900)}
2025-06-26 00:20:21,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 00:20:21,665 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTUyNzIyMSwiaWF0IjoxNzUwOTIyNDIxfQ.ENerHvnXOjEumwM2anaZBp09oQAFBPPOWiiFBBTtARQ, Expiry (seconds): 604800
2025-06-26 00:20:21,670 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-26 00:20:36,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:20:36,586 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:20:36,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:20:36,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:20:36,587 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 00:20:36,599 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 00:20:36,599 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 00:20:38,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:20:38,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:20:38,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:38,131 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:38,131 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:20:38,157 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:20:38,157 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:20:58,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:20:58,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:20:58,218 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:58,218 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:20:58,218 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:20:58,224 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:20:58,224 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:11,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:11,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:11,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:21:11,050 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750924221, 'iat': 1750922421}
2025-06-26 00:21:11,050 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 00:21:11,068 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 00:21:11,068 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 00:21:20,081 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:20,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:20,082 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,082 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,082 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:20,116 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:20,118 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:20,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:20,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:20,839 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,839 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,840 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:20,866 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:20,867 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:20,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:20,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:20,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:20,986 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:21,044 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:21,045 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:21:24,391 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:21:24,391 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:21:24,391 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:24,392 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:21:24,392 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:21:24,416 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:21:24,416 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:22:20,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:22:20,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:22:20,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:22:20,962 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:22:20,962 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:22:21,079 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:22:21,093 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:23:23,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:23:23,610 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:23:23,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:23:23,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:23:23,612 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:23:23,658 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:23:23,659 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:24:21,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:24:21,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:24:21,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:24:21,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:24:21,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:24:21,409 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:24:21,409 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:25:21,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:25:21,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:25:21,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:25:21,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:25:21,068 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:25:21,088 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:25:21,090 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:26:23,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:26:23,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:26:23,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:26:23,357 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:26:23,358 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:26:23,432 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:26:23,434 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 00:27:21,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 00:27:21,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 00:27:21,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:27:21,176 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750924091, 'iat': 1750922291}
2025-06-26 00:27:21,179 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 00:27:21,204 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 00:27:21,205 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:34:03,596 - INFO - app.core.security - Closing Redis connection...
2025-06-26 01:34:03,607 - INFO - app.core.security - Redis connection closed.
2025-06-26 01:48:49,943 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 01:48:49,944 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 01:48:49,977 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 01:48:49,977 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 01:48:49,985 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:48:49,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:48:49,985 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:48:49,985 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 23, 49, 985305), 'iat': datetime.datetime(2025, 6, 26, 8, 48, 49, 985307)}
2025-06-26 01:48:49,986 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:49:08,415 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:49:08,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:49:08,415 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:49:08,415 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 9, 19, 8, 415259), 'iat': datetime.datetime(2025, 6, 26, 8, 49, 8, 415263)}
2025-06-26 01:49:08,415 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:49:08,415 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MzI1NDgsImlhdCI6MTc1MDkyNzc0OH0.1j5jYdeN4d2sbO5ZZTma9msFq3QiZUOnSj38NOoXFEY, Expiry (seconds): 604800
2025-06-26 01:49:08,428 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-26 01:50:10,508 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:50:10,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:50:10,509 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:50:10,509 - DEBUG - app.core.security - Payload to encode: {'sub': '6', 'user_type': 'demo', 'account_number': '0BBEF', 'exp': datetime.datetime(2025, 6, 26, 9, 20, 10, 508903), 'iat': datetime.datetime(2025, 6, 26, 8, 50, 10, 508911)}
2025-06-26 01:50:10,509 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:50:10,510 - INFO - app.core.security - Storing refresh token for user ID 6 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI2IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiMEJCRUYiLCJleHAiOjE3NTE1MzI2MTAsImlhdCI6MTc1MDkyNzgxMH0.fqWvkMt9pXkyQvgQbzFFgKMIls1laLzZAl2nkb_W_Ok, Expiry (seconds): 604800
2025-06-26 01:50:10,518 - INFO - app.core.security - Refresh token stored successfully for user ID: 6
2025-06-26 01:50:37,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,468 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,502 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,530 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,531 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,536 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,646 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,669 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,681 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,739 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:37,748 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 01:50:37,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:37,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:37,901 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 01:50:54,178 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:50:54,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:50:54,178 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:50:54,178 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 26, 9, 20, 54, 178196), 'iat': datetime.datetime(2025, 6, 26, 8, 50, 54, 178203)}
2025-06-26 01:50:54,178 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:50:54,179 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MzI2NTQsImlhdCI6MTc1MDkyNzg1NH0.mHvB54Mcr2xYgCxNjNY9B7WxglzULtRXe29eAt9tRsA, Expiry (seconds): 604800
2025-06-26 01:50:54,184 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-26 01:50:55,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,283 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,283 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:50:55,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,285 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,285 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,285 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,315 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,316 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,316 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,345 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,346 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,346 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:50:55,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,349 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,350 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,350 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,395 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,398 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,421 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,424 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,424 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:55,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:55,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,434 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:55,434 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:55,552 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,552 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:55,582 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:55,582 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:56,503 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:56,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:56,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:56,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:56,510 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:56,533 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:56,534 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:50:56,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:56,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:56,828 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:58,154 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:50:58,156 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:50:58,156 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:58,157 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:50:58,157 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:50:58,195 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:50:58,196 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:52:10,895 - INFO - app.core.security - Closing Redis connection...
2025-06-26 01:52:10,897 - INFO - app.core.security - Redis connection closed.
2025-06-26 01:59:18,810 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 01:59:18,810 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 01:59:18,822 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 01:59:18,822 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 01:59:18,832 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:59:18,832 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:59:18,832 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:59:18,832 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 34, 18, 832278), 'iat': datetime.datetime(2025, 6, 26, 8, 59, 18, 832280)}
2025-06-26 01:59:18,833 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:59:24,664 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:24,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:24,665 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:59:31,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:31,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:31,099 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:59:31,099 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750929654, 'iat': 1750927854}
2025-06-26 01:59:31,099 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 01:59:31,127 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 01:59:31,128 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 01:59:31,128 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5Mjk2NTQsImlhdCI6MTc1MDkyNzg1NH0.Yg718RCN7SRlUNPOgsWMKePeQf5zWGjcOPhyeXkAwjk
2025-06-26 01:59:31,136 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5Mjk2NTQsImlhdCI6MTc1MDkyNzg1NH0.Yg718RCN7SRlUNPOgsWMKePeQf5zWGjcOPhyeXkAwjk
2025-06-26 01:59:44,296 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 01:59:44,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 01:59:44,296 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 01:59:44,296 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 26, 9, 29, 44, 295961), 'iat': datetime.datetime(2025, 6, 26, 8, 59, 44, 295972)}
2025-06-26 01:59:44,296 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 01:59:44,297 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MzMxODQsImlhdCI6MTc1MDkyODM4NH0.1JS9Z8yIrwOReJ_tt4AQDpYVI1TelH2GaesH8ugfE1U, Expiry (seconds): 604800
2025-06-26 01:59:44,302 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-26 01:59:45,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,419 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,419 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,420 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:45,435 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:45,443 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,445 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,477 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,497 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,498 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 01:59:45,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,508 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,509 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:45,549 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:45,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:45,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,553 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:45,553 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:45,581 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:45,582 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,582 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:45,595 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:45,596 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:46,852 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:46,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:46,853 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:46,853 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:46,853 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:46,864 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:46,864 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:47,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:47,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:47,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:47,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:47,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:47,977 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:47,977 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:47,977 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:48,094 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:48,095 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 01:59:48,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 01:59:48,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 01:59:48,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:48,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 01:59:48,530 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 01:59:48,557 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 01:59:48,560 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:17,705 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:17,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:17,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:17,706 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:17,707 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:17,726 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:17,726 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:19,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:19,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:19,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:19,229 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:19,230 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:19,266 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:19,267 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:21,020 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:21,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:21,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:21,021 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:21,021 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:21,032 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:21,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:23,097 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:23,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:23,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:23,098 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:23,098 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:23,103 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:23,103 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:44,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:44,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:44,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,773 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,774 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:00:44,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:00:44,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:00:44,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,777 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:00:44,777 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:00:44,816 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:00:44,817 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:00:44,822 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:01:12,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:01:12,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:01:12,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:01:12,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:01:12,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:01:12,806 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:01:12,806 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:01:53,333 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:01:53,333 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:01:53,333 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:01:53,333 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 26, 9, 31, 53, 333357), 'iat': datetime.datetime(2025, 6, 26, 9, 1, 53, 333360)}
2025-06-26 02:01:53,333 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:01:53,334 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTUzMzMxMywiaWF0IjoxNzUwOTI4NTEzfQ.P6OMud71udFN0gI6lY9ZnPkM07q7Rk0rwEioCvOpZPc, Expiry (seconds): 604800
2025-06-26 02:01:53,336 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-26 02:02:07,852 - DEBUG - app.core.security - Attempting to decode token: generate_unique_10_digit_id...
2025-06-26 02:02:07,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:02:07,852 - WARNING - app.core.security - JWTError in decode_token: JWTError - Not enough segments
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 180, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 74, in verify
    header, payload, signing_input, signature = _load(token)
                                                ~~~~~^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 184, in _load
    raise JWSError("Not enough segments")
jose.exceptions.JWSError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Not enough segments
2025-06-26 02:02:07,860 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 180, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 74, in verify
    header, payload, signing_input, signature = _load(token)
                                                ~~~~~^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 184, in _load
    raise JWSError("Not enough segments")
jose.exceptions.JWSError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 02:02:25,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:02:25,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:02:25,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:02:25,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:02:25,088 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:02:25,092 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:02:25,092 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:02:30,173 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:02:30,174 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:05:49,895 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:05:49,896 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:05:49,914 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:05:49,914 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:05:49,921 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:05:49,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:05:49,921 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:05:49,921 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 40, 49, 921754), 'iat': datetime.datetime(2025, 6, 26, 9, 5, 49, 921757)}
2025-06-26 02:05:49,922 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:05:51,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:05:51,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:05:51,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:05,124 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:05,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:05,124 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:06:05,124 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:06:05,124 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:06:05,128 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:06:05,129 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:06:13,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:13,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:13,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:13,938 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:13,938 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:13,946 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:13,946 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:14,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:14,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:14,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:14,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:14,742 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:14,746 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:14,746 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:28,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:28,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:28,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:28,715 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:28,716 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:28,732 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:28,732 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:30,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:06:30,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:06:30,884 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:30,885 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:06:30,885 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:06:30,974 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:06:30,974 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:06:51,043 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:06:51,044 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:10:07,662 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:10:07,662 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:10:07,697 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:10:07,697 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:10:07,705 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:10:07,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:10:07,705 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:10:07,705 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 45, 7, 705555), 'iat': datetime.datetime(2025, 6, 26, 9, 10, 7, 705559)}
2025-06-26 02:10:07,706 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:10:14,544 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:14,544 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:14,544 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:28,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:28,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,970 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,971 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:10:28,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:28,971 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:28,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:28,971 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:28,988 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:28,988 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:28,989 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,035 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,037 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:29,061 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:29,061 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,108 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,108 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:10:29,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,109 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,111 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,112 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:29,130 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:29,130 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,131 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:29,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:29,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:29,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,410 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:29,410 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:29,429 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:29,430 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:30,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:30,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:30,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:30,947 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:30,947 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:30,963 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:30,964 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:31,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:31,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:31,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:31,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:31,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:31,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:31,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:31,946 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:32,200 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:32,200 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:33,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:33,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:33,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:33,097 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:33,097 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:33,120 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:33,121 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:45,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:45,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:45,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,700 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,700 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:10:45,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:10:45,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:10:45,704 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,705 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:10:45,705 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:10:45,729 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:10:45,729 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:10:45,732 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:12,009 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:12,009 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:12,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:12,012 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:12,012 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:12,042 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:12,044 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:33,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:33,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:33,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:11:33,396 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:11:33,396 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:11:33,398 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:11:33,398 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:11:49,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,101 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,101 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:11:49,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,103 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,104 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,120 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,121 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,121 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,150 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,162 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,163 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,187 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:11:49,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,188 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,195 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,196 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,196 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:49,245 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:49,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:49,246 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:49,247 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:49,257 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:49,258 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:50,004 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:50,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:50,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,006 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,006 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:50,016 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:50,016 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:11:50,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:50,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:50,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:11:50,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:11:50,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:11:50,848 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:11:50,861 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:11:50,862 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:09,402 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:09,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:09,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:09,404 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:09,404 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:12:09,424 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:12:09,425 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,919 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,919 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:12:20,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:20,920 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:20,920 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:20,920 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:12:20,927 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:12:20,928 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:20,928 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:12:38,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:12:38,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:12:38,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:38,977 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:12:38,977 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:12:38,989 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:12:38,989 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:13:09,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:13:09,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:13:09,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:09,939 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:09,939 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:13:09,944 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:13:09,945 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:13:21,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:13:21,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:13:21,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:21,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:13:21,487 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:13:21,497 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:13:21,497 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:13:55,311 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:13:55,311 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:17:37,610 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:17:37,610 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:17:37,630 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:17:37,630 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:17:37,638 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:17:37,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:17:37,638 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:17:37,638 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 9, 52, 37, 638879), 'iat': datetime.datetime(2025, 6, 26, 9, 17, 37, 638881)}
2025-06-26 02:17:37,639 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:17:42,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:17:42,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:17:42,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,255 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,268 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,269 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,269 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,281 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,281 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,286 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,286 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,286 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,291 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,295 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,295 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,560 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,560 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,560 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,564 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,564 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:22,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:22,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:22,795 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,795 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:22,795 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:22,798 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:22,798 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:23,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:23,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:23,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:23,043 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:23,043 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:23,046 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:23,047 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:23,105 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:23,105 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:23,106 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:25,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:25,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:25,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:25,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:25,536 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:25,543 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:25,543 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:37,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:37,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:18:37,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:18:37,695 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:18:37,710 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:18:37,710 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:18:37,710 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:19:05,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:19:05,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:19:05,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:05,502 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:05,502 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:19:05,513 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:19:05,514 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:19:26,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:19:26,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:19:26,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:26,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:19:26,068 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:19:26,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:19:26,078 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:19:38,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:19:38,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:19:38,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:19:38,711 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750930313, 'iat': 1750928513}
2025-06-26 02:19:38,711 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 02:19:38,715 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 02:19:38,715 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 02:21:20,720 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:21:20,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:21:20,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:21:20,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750930184, 'iat': 1750928384}
2025-06-26 02:21:20,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 02:21:20,733 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 02:21:20,733 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 02:21:24,439 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:21:24,439 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:41:18,093 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:41:18,094 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:41:18,118 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:41:18,118 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:41:18,127 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:41:18,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:41:18,127 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:41:18,127 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 10, 16, 18, 127791), 'iat': datetime.datetime(2025, 6, 26, 9, 41, 18, 127794)}
2025-06-26 02:41:18,128 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:48:20,695 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:48:20,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:48:20,697 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:48:20,698 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 26, 10, 18, 20, 694967), 'iat': datetime.datetime(2025, 6, 26, 9, 48, 20, 695001)}
2025-06-26 02:48:20,717 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:48:20,719 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MzYxMDAsImlhdCI6MTc1MDkzMTMwMH0.Qphprjo8AcqhM3D9k6Ef0nhbSrhxUXmCZLvVORWUsBg, Expiry (seconds): 604800
2025-06-26 02:48:20,725 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-26 02:48:22,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:22,878 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:22,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,883 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,883 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:48:22,883 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:22,883 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:22,885 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,887 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:22,896 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:22,896 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:22,896 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:22,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:22,931 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:22,932 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,932 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,932 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:48:22,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:22,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:22,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,934 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,935 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:22,952 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:22,952 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:22,953 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:22,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:22,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:22,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,987 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:22,987 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:23,009 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:23,009 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:23,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:23,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:23,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:23,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:23,520 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:23,529 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:23,529 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:23,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:23,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:23,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:24,103 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:24,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:24,104 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:24,104 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:24,104 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:24,117 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:24,117 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:25,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:25,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:25,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:25,450 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:25,450 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:25,455 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:25,455 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:37,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:37,160 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:37,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:37,161 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:37,161 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:37,173 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:37,173 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:48:45,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:48:45,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:48:45,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:45,886 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933100, 'iat': 1750931300}
2025-06-26 02:48:45,886 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:48:45,899 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:48:45,900 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:49:31,383 - INFO - app.core.security - Closing Redis connection...
2025-06-26 02:49:31,384 - INFO - app.core.security - Redis connection closed.
2025-06-26 02:56:44,602 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 02:56:44,602 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 02:56:44,615 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 02:56:44,615 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 02:56:44,624 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:56:44,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:56:44,625 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:56:44,625 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 10, 31, 44, 624940), 'iat': datetime.datetime(2025, 6, 26, 9, 56, 44, 624943)}
2025-06-26 02:56:44,626 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:57:13,451 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 02:57:13,451 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 02:57:13,451 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 02:57:13,451 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 26, 10, 27, 13, 451176), 'iat': datetime.datetime(2025, 6, 26, 9, 57, 13, 451190)}
2025-06-26 02:57:13,452 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 02:57:13,452 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MzY2MzMsImlhdCI6MTc1MDkzMTgzM30.M2Xcz_Qv6VMPWNhQuEg8ZmZzzifrLXz1ORwyzgGuT9c, Expiry (seconds): 604800
2025-06-26 02:57:13,457 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-26 02:57:14,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:14,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:14,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,589 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,589 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:57:14,590 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:14,590 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:14,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,590 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,590 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:57:14,598 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:57:14,599 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:57:14,599 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:57:14,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:14,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:14,614 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,615 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,615 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 02:57:14,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:14,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:14,616 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,616 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,616 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:57:14,622 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:57:14,622 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:57:14,623 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:57:14,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:14,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:14,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:14,631 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:57:14,636 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:57:14,636 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:57:15,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:15,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:15,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:15,053 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:15,053 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:57:15,060 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:57:15,060 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:57:15,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:15,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:15,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:15,549 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:15,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:15,550 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:15,550 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:15,551 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:57:15,558 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:57:15,558 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:57:16,806 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:57:16,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:57:16,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:16,807 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:57:16,807 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:57:16,813 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:57:16,813 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:58:26,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:58:26,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:58:26,749 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:58:26,750 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:58:26,750 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:58:26,758 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:58:26,759 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 02:59:33,827 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 02:59:33,827 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 02:59:33,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:59:33,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 02:59:33,827 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 02:59:33,833 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 02:59:33,833 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:00:15,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:00:15,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:00:15,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 03:00:15,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 03:00:15,788 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:00:15,793 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:00:15,793 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:00:19,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:00:19,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:00:19,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 03:00:19,079 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750933633, 'iat': 1750931833}
2025-06-26 03:00:19,079 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:00:19,094 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:00:19,094 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:04:12,306 - INFO - app.core.security - Closing Redis connection...
2025-06-26 03:04:12,307 - INFO - app.core.security - Redis connection closed.
2025-06-26 03:29:24,524 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 03:29:24,526 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 03:29:24,570 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 03:29:24,570 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 03:29:24,581 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 03:29:24,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 03:29:24,581 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 03:29:24,581 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 11, 4, 24, 581123), 'iat': datetime.datetime(2025, 6, 26, 10, 29, 24, 581125)}
2025-06-26 03:29:24,582 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 03:29:26,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:26,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:26,600 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 03:29:26,602 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-26 03:29:32,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:32,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:32,608 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-26 03:29:41,043 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 03:29:41,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 03:29:41,044 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 03:29:41,044 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 26, 10, 59, 41, 43715), 'iat': datetime.datetime(2025, 6, 26, 10, 29, 41, 43723)}
2025-06-26 03:29:41,044 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 03:29:41,045 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1Mzg1ODEsImlhdCI6MTc1MDkzMzc4MX0.iAV7SC0q7LZaAlrXwGQhbzfgYeZQkOePU60KgaXJ404, Expiry (seconds): 604800
2025-06-26 03:29:41,064 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-26 03:29:42,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:42,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:42,236 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,236 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,236 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 03:29:42,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:42,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:42,237 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,237 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,237 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:29:42,250 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:29:42,250 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:29:42,250 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:29:42,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:42,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:42,287 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,287 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,287 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 03:29:42,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:42,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:42,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,289 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,290 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:29:42,305 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:29:42,306 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:29:42,308 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:29:42,332 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:42,333 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:42,333 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,333 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,334 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:29:42,391 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:29:42,392 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:29:42,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:42,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:42,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,804 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:42,804 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:29:42,835 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:29:42,835 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:29:43,389 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:43,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:43,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:43,390 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:43,391 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:29:43,401 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:29:43,401 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:29:43,822 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:43,822 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:43,823 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:44,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:29:44,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:29:44,635 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:44,635 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:29:44,635 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:29:44,648 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:29:44,648 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:30:24,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:30:24,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:30:24,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:30:24,050 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:30:24,050 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 03:30:24,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:30:24,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:30:24,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:30:24,051 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:30:24,052 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:30:24,061 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:30:24,062 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:30:24,062 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:31:11,424 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:31:11,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:31:11,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:31:11,428 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:31:11,428 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:31:11,453 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:31:11,453 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:35:01,076 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:35:01,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:35:01,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:35:01,078 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:35:01,078 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:35:01,089 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:35:01,089 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:35:48,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:35:48,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:35:48,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:35:48,205 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750935581, 'iat': 1750933781}
2025-06-26 03:35:48,206 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:35:48,258 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:35:48,259 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:39:31,939 - INFO - app.core.security - Closing Redis connection...
2025-06-26 03:39:31,944 - INFO - app.core.security - Redis connection closed.
2025-06-26 03:52:14,522 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 03:52:14,522 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 03:52:14,539 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 03:52:14,540 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 03:52:14,550 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 03:52:14,550 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 03:52:14,550 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 03:52:14,550 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 11, 27, 14, 550680), 'iat': datetime.datetime(2025, 6, 26, 10, 52, 14, 550685)}
2025-06-26 03:52:14,551 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 03:52:33,426 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 03:52:33,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 03:52:33,426 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 03:52:33,427 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 26, 11, 22, 33, 426263), 'iat': datetime.datetime(2025, 6, 26, 10, 52, 33, 426276)}
2025-06-26 03:52:33,427 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 03:52:33,427 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1Mzk5NTMsImlhdCI6MTc1MDkzNTE1M30.g3EdPlz8ownLgyQHPeEsXXLk2M2Bhxnrmwahn0ndH3k, Expiry (seconds): 604800
2025-06-26 03:52:33,446 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-26 03:52:34,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:34,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:34,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,580 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,580 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 03:52:34,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:34,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:34,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,581 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:52:34,621 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:52:34,622 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:34,628 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:34,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:34,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:34,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,669 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,669 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 03:52:34,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:34,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:34,677 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,678 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,702 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:52:34,724 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:52:34,724 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:34,725 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:34,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:34,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:34,738 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:34,738 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:52:34,759 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:52:34,759 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:35,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:35,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:36,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:36,000 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:36,000 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:52:36,016 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:52:36,016 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:36,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:36,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:36,348 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:37,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:37,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:37,455 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:37,456 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:37,457 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:52:37,490 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:52:37,490 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:37,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:37,993 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:37,994 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:37,995 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:37,995 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:52:38,042 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:52:38,042 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:52:45,530 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:52:45,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:52:45,531 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:45,531 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:52:45,531 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:52:45,545 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:52:45,545 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:53:14,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 03:53:14,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 03:53:14,867 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:53:14,868 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 03:53:14,868 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 03:53:14,895 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 03:53:14,896 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 03:57:21,365 - INFO - app.core.security - Closing Redis connection...
2025-06-26 03:57:21,371 - INFO - app.core.security - Redis connection closed.
2025-06-26 04:12:50,404 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 04:12:50,406 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 04:12:50,429 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 04:12:50,429 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 04:12:50,440 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 04:12:50,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 04:12:50,440 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 04:12:50,440 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 11, 47, 50, 440852), 'iat': datetime.datetime(2025, 6, 26, 11, 12, 50, 440855)}
2025-06-26 04:12:50,442 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 04:12:52,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:12:52,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:12:52,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:13:11,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:13:11,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:13:11,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:13:11,857 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:13:11,857 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:13:11,869 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:13:11,869 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:13:18,546 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:13:18,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:13:18,548 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:13:18,549 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:13:18,549 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:13:18,563 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:13:18,564 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:14:26,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:14:26,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:14:26,735 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:14:26,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:14:26,735 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:14:26,743 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:14:26,743 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:14:33,543 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:14:33,544 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:14:33,545 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:14:33,545 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:14:33,546 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:14:33,561 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:14:33,561 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:15:41,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:15:41,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:15:41,684 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:15:41,684 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:15:41,685 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:15:41,712 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:15:41,713 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:16:03,851 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:16:03,851 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:16:03,852 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:16:03,852 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:16:03,852 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:16:03,859 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:16:03,859 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:17:11,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:17:11,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:17:11,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:17:11,579 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:17:11,579 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:17:11,621 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:17:11,622 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:17:16,460 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:17:16,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:17:16,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:17:16,463 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:17:16,463 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:17:16,487 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:17:16,488 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:18:24,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:18:24,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:18:24,563 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:18:24,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:18:24,565 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:18:24,602 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:18:24,603 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:18:35,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:18:35,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:18:35,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:18:35,860 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:18:35,861 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:18:35,887 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:18:35,887 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:19:39,559 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:19:39,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:19:39,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:39,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:39,560 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:19:39,568 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:19:39,570 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:19:39,663 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:19:39,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:19:39,664 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:39,664 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:39,664 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:19:39,711 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:19:39,711 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:19:50,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:19:50,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:19:50,237 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:50,237 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:50,237 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:19:50,247 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:19:50,247 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:19:52,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:19:52,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:19:52,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:52,904 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:19:52,904 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:19:52,925 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:19:52,926 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:20:34,775 - INFO - app.core.security - Closing Redis connection...
2025-06-26 04:20:34,775 - INFO - app.core.security - Redis connection closed.
2025-06-26 04:20:58,525 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 04:20:58,525 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 04:20:58,540 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 04:20:58,540 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 04:20:58,556 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 04:20:58,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 04:20:58,556 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 04:20:58,556 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 11, 55, 58, 555999), 'iat': datetime.datetime(2025, 6, 26, 11, 20, 58, 556007)}
2025-06-26 04:20:58,556 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 04:21:00,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:00,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:00,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:00,767 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:00,767 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:21:00,781 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:21:00,781 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:21:01,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:01,859 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:01,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:03,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:03,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:03,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:03,283 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:03,283 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:21:03,298 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:21:03,299 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:21:06,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:06,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:06,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:06,330 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5MzY5NTMsImlhdCI6MTc1MDkzNTE1M30.PUcjaegj_aHheajH9p-OIHeePqeAWWdACoofnYe5sjo
2025-06-26 04:21:06,331 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5MzY5NTMsImlhdCI6MTc1MDkzNTE1M30.PUcjaegj_aHheajH9p-OIHeePqeAWWdACoofnYe5sjo
2025-06-26 04:21:10,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:10,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:10,274 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:10,274 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750936953, 'iat': 1750935153}
2025-06-26 04:21:10,274 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-26 04:21:10,332 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-26 04:21:10,332 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-26 04:21:10,333 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5MzY5NTMsImlhdCI6MTc1MDkzNTE1M30.PUcjaegj_aHheajH9p-OIHeePqeAWWdACoofnYe5sjo
2025-06-26 04:21:10,349 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA5MzY5NTMsImlhdCI6MTc1MDkzNTE1M30.PUcjaegj_aHheajH9p-OIHeePqeAWWdACoofnYe5sjo
2025-06-26 04:21:19,887 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 04:21:19,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 04:21:19,887 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 04:21:19,887 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 26, 11, 51, 19, 887385), 'iat': datetime.datetime(2025, 6, 26, 11, 21, 19, 887394)}
2025-06-26 04:21:19,888 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 04:21:19,888 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1NDE2NzksImlhdCI6MTc1MDkzNjg3OX0.kFBTWdSmfEARppc0Q2t-XZIDYbyRk_lxNfbF1-c2go4, Expiry (seconds): 604800
2025-06-26 04:21:19,893 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-26 04:21:21,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:21,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:21,008 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,008 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,008 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:21:21,008 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:21,008 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:21,009 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,009 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,009 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:21:21,029 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:21:21,030 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:21,031 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:21,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:21,073 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:21,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,074 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,074 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:21:21,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:21,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:21,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,078 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,078 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:21:21,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:21,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:21,126 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,126 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,127 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:21:21,150 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:21:21,150 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:21,150 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:21,185 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:21:21,191 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:21,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:21,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:21,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,266 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:21,266 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:21:21,309 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:21:21,310 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:24,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:24,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:24,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:24,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:24,453 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:21:24,474 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:21:24,474 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:24,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:24,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:24,852 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:28,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:28,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:28,531 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:28,531 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:28,531 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:21:28,582 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:21:28,582 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:21:56,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:21:56,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:21:56,635 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:56,635 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:21:56,636 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:21:56,644 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:21:56,644 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:22:13,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:22:13,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:22:13,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:13,284 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:13,285 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:22:13,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:22:13,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:22:13,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:13,286 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:13,286 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:22:13,296 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:22:13,296 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:22:13,296 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:22:38,038 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:22:38,038 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:22:38,038 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:38,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:38,039 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:22:38,045 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:22:38,045 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:22:44,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:22:44,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:22:44,273 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:44,273 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:22:44,273 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:22:44,280 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:22:44,280 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:22:53,786 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 04:22:53,786 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 04:22:53,787 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 04:22:53,787 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 26, 11, 52, 53, 786562), 'iat': datetime.datetime(2025, 6, 26, 11, 22, 53, 786570)}
2025-06-26 04:22:53,787 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 04:22:53,787 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTU0MTc3MywiaWF0IjoxNzUwOTM2OTczfQ.n1aM8k8eLe5CLRmyyR3qsAKwbMO2YLALb1Yhizg7uiI, Expiry (seconds): 604800
2025-06-26 04:22:53,790 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-26 04:23:13,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:23:13,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:23:13,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750938773, 'iat': 1750936973}
2025-06-26 04:23:13,709 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750938773, 'iat': 1750936973}
2025-06-26 04:23:13,709 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 04:23:13,722 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 04:23:13,723 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 04:23:54,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:23:54,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:23:54,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:23:54,434 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:23:54,434 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:23:54,460 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:23:54,460 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:24:33,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:24:33,891 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:24:33,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:24:33,892 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:24:33,892 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:24:33,918 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:24:33,919 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:24:34,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:24:34,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:24:34,596 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:24:34,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:24:34,596 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:24:34,622 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:24:34,622 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:25:11,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:25:11,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:25:11,873 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:25:11,873 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:25:11,873 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:25:11,878 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:25:11,878 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:26:27,736 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:26:27,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:26:27,737 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:26:27,737 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:26:27,737 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:26:27,743 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:26:27,743 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:27:13,315 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 04:27:13,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 04:27:13,315 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 04:27:13,315 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 26, 11, 57, 13, 315677), 'iat': datetime.datetime(2025, 6, 26, 11, 27, 13, 315681)}
2025-06-26 04:27:13,316 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 04:27:13,316 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1NDIwMzMsImlhdCI6MTc1MDkzNzIzM30.zbIsR6tYcmlvzzsNnsIMSHKNF739dhm105OPXDHlvJk, Expiry (seconds): 604800
2025-06-26 04:27:13,350 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-26 04:27:25,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:27:25,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:27:25,728 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751542033, 'iat': 1750937233}
2025-06-26 04:27:25,728 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1NDIwMzMsImlhdCI6MTc1MDkzNzIzM30.zbIsR6tYcmlvzzsNnsIMSHKNF739dhm105OPXDHlvJk
2025-06-26 04:27:25,735 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 04:27:25,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 04:27:25,736 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 04:27:25,736 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 26, 11, 57, 25, 735884), 'iat': datetime.datetime(2025, 6, 26, 11, 27, 25, 735888)}
2025-06-26 04:27:25,736 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 04:27:25,736 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1NDIwNDUsImlhdCI6MTc1MDkzNzI0NX0.XDQoFnS_NpThK_pHirYS8cxE6ioF1hwpzqzRMq3FeoM, Expiry (seconds): 604800
2025-06-26 04:27:25,769 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-26 04:32:02,055 - INFO - app.core.security - Closing Redis connection...
2025-06-26 04:32:02,057 - INFO - app.core.security - Redis connection closed.
2025-06-26 04:36:01,181 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-26 04:36:01,181 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-26 04:36:01,196 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-26 04:36:01,196 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-26 04:36:01,217 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-26 04:36:01,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-26 04:36:01,217 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-26 04:36:01,217 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 26, 12, 11, 1, 217114), 'iat': datetime.datetime(2025, 6, 26, 11, 36, 1, 217120)}
2025-06-26 04:36:01,217 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-26 04:37:12,505 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:12,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:12,507 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,507 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,507 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:37:12,507 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:12,507 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:12,507 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,508 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:12,514 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:12,514 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:12,515 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:12,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:12,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:12,558 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,558 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,559 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:37:12,559 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:12,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:12,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,559 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,560 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:12,570 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:12,571 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:12,571 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:12,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:12,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:12,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,579 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:12,579 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:12,630 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:12,630 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:14,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:14,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:14,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:14,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:14,083 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:14,099 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:14,099 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:14,446 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:14,447 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:14,448 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:14,753 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:14,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:14,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:14,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:14,754 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:14,954 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:14,955 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:17,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:17,073 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:17,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:17,074 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:17,074 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:17,155 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:17,155 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:26,070 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:26,070 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:26,071 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:26,072 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:26,072 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:26,083 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:26,083 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:41,644 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:41,645 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:41,645 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:41,646 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:41,646 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:37:41,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:37:41,646 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:37:41,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:41,647 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:37:41,647 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:37:41,656 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:37:41,657 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:37:41,657 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:38:07,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:38:07,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:38:07,513 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:07,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:07,513 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:38:07,517 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:38:07,517 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:38:14,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:38:14,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:38:14,093 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750938773, 'iat': 1750936973}
2025-06-26 04:38:14,093 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1750938773, 'iat': 1750936973}
2025-06-26 04:38:14,093 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-26 04:38:14,098 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-26 04:38:14,099 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-26 04:38:20,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:38:20,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:38:20,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:20,726 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:20,726 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:38:20,734 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:38:20,734 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:38:21,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:38:21,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:38:21,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:21,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:21,262 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:38:21,273 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:38:21,273 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:38:21,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:38:21,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:38:21,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:21,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:21,402 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:38:21,440 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:38:21,440 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:38:29,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:38:29,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:38:29,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:29,365 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:29,365 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:38:29,380 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:38:29,380 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:38:35,796 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:38:35,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:38:35,797 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:35,797 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:38:35,797 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:38:35,814 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:38:35,814 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:39:17,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:39:17,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:39:17,942 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:39:17,943 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:39:17,943 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:39:17,992 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:39:17,992 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:39:47,053 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:39:47,053 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:39:47,054 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:39:47,054 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:39:47,054 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:39:47,092 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:39:47,093 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:15,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:15,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:15,103 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:15,103 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:15,103 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:15,112 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:15,112 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:55,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:55,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:55,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,242 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,242 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:41:55,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:55,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:55,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,242 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,243 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:55,252 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:55,252 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:55,252 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:55,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:55,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:55,288 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,288 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,289 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:41:55,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:55,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:55,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,289 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,289 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:55,326 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:55,326 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:55,326 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:55,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:55,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:55,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,375 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,375 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:55,413 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:55,413 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:55,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:55,688 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:55,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,691 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:55,691 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:55,756 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:55,756 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:57,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:57,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:57,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:57,712 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:57,712 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:41:57,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:57,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:57,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:57,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:57,713 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:57,828 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:57,828 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:57,829 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:58,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:58,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:58,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:58,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:58,019 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:58,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:58,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:58,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:58,066 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:58,066 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-26 04:41:58,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:58,072 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:58,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:58,073 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:58,080 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:58,091 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:58,092 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:58,102 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:58,102 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:58,102 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:59,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:59,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:59,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:59,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:41:59,649 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:41:59,661 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:41:59,662 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:41:59,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:41:59,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:41:59,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:42:00,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:42:00,981 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:42:00,982 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:42:00,982 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:42:00,983 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:42:01,071 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:42:01,071 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:42:01,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:42:01,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:42:01,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:42:01,742 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:42:01,742 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-26 04:42:01,790 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-26 04:42:01,791 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-26 04:42:58,008 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-26 04:42:58,009 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-26 04:42:58,010 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750938679, 'iat': 1750936879}
2025-06-26 04:42:58,012 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA5Mzg2NzksImlhdCI6MTc1MDkzNjg3OX0.vSOuAakZb0dPyuGOOy7_fAZ00-YlXXIHujn2YIQkeeM
2025-06-26 04:42:58,026 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA5Mzg2NzksImlhdCI6MTc1MDkzNjg3OX0.vSOuAakZb0dPyuGOOy7_fAZ00-YlXXIHujn2YIQkeeM
2025-06-26 04:43:10,858 - INFO - app.core.security - Closing Redis connection...
2025-06-26 04:43:10,861 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:11:08,508 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:11:08,508 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:11:08,516 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:11:08,516 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:11:08,528 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:11:08,528 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:11:08,528 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:11:08,528 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 10, 46, 8, 528474), 'iat': datetime.datetime(2025, 6, 27, 10, 11, 8, 528480)}
2025-06-27 03:11:08,529 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:11:14,418 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:11:14,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:11:14,419 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:11:14,419 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 10, 41, 14, 418117), 'iat': datetime.datetime(2025, 6, 27, 10, 11, 14, 418140)}
2025-06-27 03:11:14,420 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:11:14,421 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjIzODc0LCJpYXQiOjE3NTEwMTkwNzR9.mi_uwiwd2x2lIdUb9bqa9Q-GWOytSkK8fOk42rrm7hg, Expiry (seconds): 604800
2025-06-27 03:11:14,424 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 03:11:15,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:15,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:15,635 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,636 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,636 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 03:11:15,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:15,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:15,636 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,636 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,636 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:11:15,645 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:11:15,647 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:15,648 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:15,664 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:15,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:15,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,666 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,666 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 03:11:15,670 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:15,670 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:15,671 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,672 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,672 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:11:15,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:15,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:15,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,694 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:11:15,707 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:11:15,708 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:15,708 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:15,749 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:11:15,749 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:15,777 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:15,777 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:15,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,780 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:15,780 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:11:15,831 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:11:15,831 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:17,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:17,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:17,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:17,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:17,513 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:11:17,530 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:11:17,531 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:17,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:17,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:17,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:18,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:11:18,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:11:18,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:18,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:11:18,912 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:11:18,934 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:11:18,935 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:11:32,425 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:11:32,426 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:17:56,760 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:17:56,760 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:17:56,765 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:17:56,765 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:17:56,774 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:17:56,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:17:56,774 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:17:56,774 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 10, 52, 56, 774383), 'iat': datetime.datetime(2025, 6, 27, 10, 17, 56, 774386)}
2025-06-27 03:17:56,774 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:18:01,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:01,061 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:01,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:18:01,062 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIwODc0LCJpYXQiOjE3NTEwMTkwNzR9.5VPDXBm12ANEzvVPdxBvsYOoox-j9fb5mIZ1uTLb6O0
2025-06-27 03:18:01,063 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIwODc0LCJpYXQiOjE3NTEwMTkwNzR9.5VPDXBm12ANEzvVPdxBvsYOoox-j9fb5mIZ1uTLb6O0
2025-06-27 03:18:01,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:01,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:01,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751020874, 'iat': 1751019074}
2025-06-27 03:18:07,960 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:18:07,960 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:18:07,960 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:18:07,961 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 10, 48, 7, 959927), 'iat': datetime.datetime(2025, 6, 27, 10, 18, 7, 959941)}
2025-06-27 03:18:07,961 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:18:07,962 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjI0Mjg3LCJpYXQiOjE3NTEwMTk0ODd9.qkx7wjlKqVkHKeHa8YSc2vWe9ddx_86ty9xjRh0LRpM, Expiry (seconds): 604800
2025-06-27 03:18:07,965 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 03:18:09,181 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:09,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:09,182 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,182 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,182 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 03:18:09,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:09,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:09,182 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,183 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,183 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:18:09,192 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:18:09,193 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:09,193 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:09,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:09,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:09,246 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,247 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,247 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 03:18:09,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:09,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:09,248 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,249 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,249 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:18:09,279 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:18:09,279 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:09,279 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:09,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:09,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:09,298 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,298 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,298 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:18:09,321 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:18:09,325 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:09,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:09,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:09,410 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,410 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:09,410 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:18:09,448 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:18:09,448 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:10,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:10,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:10,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:10,454 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:10,455 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:18:10,469 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:18:10,469 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:10,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:10,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:10,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:13,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:13,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:13,331 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:13,331 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:13,332 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:18:13,434 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:18:13,436 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:18:54,072 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:18:54,073 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:18:54,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:54,076 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:18:54,076 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:18:54,091 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:18:54,091 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:19:21,096 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:19:21,097 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:22:49,897 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:22:49,897 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:22:49,903 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:22:49,904 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:22:49,915 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:22:49,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:22:49,915 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:22:49,915 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 10, 57, 49, 915392), 'iat': datetime.datetime(2025, 6, 27, 10, 22, 49, 915397)}
2025-06-27 03:22:49,916 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:22:52,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:22:52,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:22:52,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:22:54,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:22:54,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:22:54,145 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:22:54,145 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:22:54,152 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:23:09,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:23:09,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:23:09,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:23:09,283 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:23:09,291 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:23:12,011 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:23:12,011 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:23:12,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:23:12,012 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:23:12,012 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:23:12,027 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:23:12,027 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:23:27,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:23:27,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:23:27,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:23:27,135 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:23:27,136 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:23:27,151 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:23:27,152 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:23:52,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:23:52,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:23:52,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:23:52,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:23:52,661 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:23:52,725 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:23:52,726 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:24:09,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:24:09,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:24:09,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:24:09,609 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:24:09,616 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:24:26,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:24:26,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:24:26,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:24:26,553 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:24:26,553 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:24:26,561 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:24:26,561 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:24:38,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:24:38,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:24:38,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:24:38,021 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:24:38,027 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:24:58,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:24:58,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:24:58,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:24:58,495 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:24:58,496 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:25:13,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:25:13,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:25:13,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:25:13,905 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:25:13,906 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:25:13,954 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:25:13,954 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:25:43,797 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:25:43,797 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:25:43,798 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:25:43,799 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:25:43,799 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:25:43,815 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:25:43,816 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:25:49,931 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:25:49,932 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:25:49,932 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:25:49,933 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:25:49,941 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:26:59,041 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:26:59,042 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:26:59,042 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:26:59,042 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:26:59,042 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:26:59,048 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:26:59,048 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:28:09,883 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:28:09,883 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:28:09,889 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:28:09,890 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:28:09,890 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:28:09,931 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:28:09,932 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:28:13,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:28:13,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:28:13,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:28:13,890 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:28:13,890 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:28:13,908 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:28:13,909 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:28:25,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:28:25,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:28:25,521 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:28:25,521 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:28:25,535 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:28:42,170 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:28:42,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:28:42,171 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:28:42,172 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:28:42,177 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:29:06,406 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:29:06,406 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:29:06,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:06,410 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:06,410 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:29:06,454 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:29:06,454 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:29:19,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:29:19,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:29:19,480 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:19,483 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:29:19,484 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:29:23,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:29:23,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:29:23,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:23,804 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:23,804 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:29:23,914 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:29:23,915 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:29:31,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:29:31,013 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:29:31,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:31,014 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:31,015 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:29:31,078 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:29:31,078 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:29:36,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:29:36,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:29:36,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:36,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:29:36,541 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:29:36,714 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:29:36,723 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:30:40,923 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:30:40,924 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:32:06,427 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:32:06,427 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:32:06,431 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:32:06,431 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:32:06,441 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:32:06,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:32:06,442 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:32:06,442 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 11, 7, 6, 441932), 'iat': datetime.datetime(2025, 6, 27, 10, 32, 6, 441938)}
2025-06-27 03:32:06,442 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:32:12,744 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:32:12,744 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:32:12,745 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:32:14,355 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:32:14,355 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:32:14,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:32:14,359 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:32:14,367 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:32:16,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:32:16,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:32:16,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:32:16,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:32:16,052 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:32:16,060 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:32:16,060 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:32:27,526 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:32:27,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:32:27,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:32:27,527 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:32:27,530 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:32:40,827 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:32:40,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:32:40,829 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:32:40,830 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:32:40,831 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:32:40,852 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:32:40,853 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:33:12,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:33:12,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:33:12,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:33:12,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:33:12,752 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:33:12,756 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:33:12,756 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:33:14,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:33:14,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:33:14,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:33:14,618 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:33:14,618 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:33:14,625 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:33:14,625 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:34:20,791 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:34:20,792 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:37:22,493 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:37:22,493 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:37:22,499 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:37:22,499 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:37:22,512 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:37:22,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:37:22,512 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:37:22,512 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 11, 12, 22, 512033), 'iat': datetime.datetime(2025, 6, 27, 10, 37, 22, 512038)}
2025-06-27 03:37:22,513 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:37:27,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:37:27,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:37:27,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:37:27,020 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:37:27,020 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:37:29,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:37:29,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:37:29,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:37:30,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:37:30,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:37:30,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:37:30,757 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:37:30,767 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:37:35,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:37:35,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:37:35,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:37:35,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:37:35,587 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:37:35,623 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:37:35,623 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:37:53,340 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:37:53,340 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:37:53,340 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:37:53,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:37:53,340 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:37:53,376 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:37:53,376 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:38:09,759 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:38:09,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:38:09,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:38:09,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:38:09,761 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:38:09,773 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:38:09,773 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:38:14,458 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:38:14,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:38:14,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:38:14,459 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:38:14,459 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:38:14,473 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:38:14,474 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:38:19,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:38:19,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:38:19,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:38:19,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:38:19,472 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:38:19,479 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:38:19,479 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:38:45,267 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:38:45,268 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:40:01,232 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:40:01,232 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:40:01,237 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:40:01,237 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:40:01,246 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:40:01,246 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:40:01,246 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:40:01,246 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 11, 15, 1, 246091), 'iat': datetime.datetime(2025, 6, 27, 10, 40, 1, 246095)}
2025-06-27 03:40:01,246 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:40:03,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:40:03,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:40:03,810 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:04,951 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:40:04,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:40:04,952 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:04,953 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:40:04,954 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:40:16,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:40:16,113 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:40:16,114 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:16,114 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:16,114 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:40:16,135 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:40:16,136 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:40:40,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:40:40,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:40:40,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:40,444 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:40,444 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:40:40,448 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:40:40,448 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:40:45,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:40:45,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:40:45,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:45,440 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:45,440 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:40:45,444 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:40:45,445 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:40:52,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:40:52,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:40:52,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:52,242 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:40:52,242 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:40:52,248 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:40:52,248 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:40:58,590 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:40:58,591 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:42:07,665 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:42:07,666 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:42:07,669 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:42:07,669 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:42:07,678 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:42:07,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:42:07,678 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:42:07,678 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 11, 17, 7, 678215), 'iat': datetime.datetime(2025, 6, 27, 10, 42, 7, 678220)}
2025-06-27 03:42:07,678 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:42:10,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:42:10,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:42:10,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:42:10,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:42:10,064 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:42:10,274 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:42:10,274 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:42:11,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:42:11,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:42:11,296 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:42:11,296 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:42:11,297 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:42:15,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:42:15,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:42:15,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:12,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:43:12,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:43:12,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:12,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:12,773 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:43:12,781 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:43:12,781 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:43:13,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:43:13,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:43:13,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:13,769 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:43:13,774 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:43:14,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:43:14,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:43:14,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:14,812 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:14,812 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:43:14,821 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:43:14,821 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:43:25,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:43:25,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:43:25,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:25,567 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:25,567 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:43:25,571 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:43:25,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:43:40,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:43:40,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:43:40,708 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:40,708 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:43:40,710 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:43:52,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:43:52,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:43:52,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:52,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:43:52,214 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:43:52,311 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:43:52,312 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:44:05,830 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:44:05,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:44:05,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:05,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:05,845 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:44:05,897 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:44:05,901 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:44:24,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:44:24,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:44:24,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:24,418 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:44:24,428 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIxMjg3LCJpYXQiOjE3NTEwMTk0ODd9.kbODf44J9lsd-FGrKeywz4zuo8jVGXhuPhGfgTMccFo
2025-06-27 03:44:26,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:44:26,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:44:26,566 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:26,566 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:26,566 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:44:26,578 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:44:26,578 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:44:32,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:44:32,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:44:32,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:32,765 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:32,765 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:44:32,784 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:44:32,784 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:44:40,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:44:40,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:44:40,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:40,818 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751021287, 'iat': 1751019487}
2025-06-27 03:44:40,818 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:44:40,826 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:44:40,827 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:45:09,238 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:45:09,242 - INFO - app.core.security - Redis connection closed.
2025-06-27 03:52:07,173 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 03:52:07,174 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 03:52:07,183 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 03:52:07,183 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 03:52:07,203 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:52:07,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:52:07,203 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:52:07,204 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 11, 27, 7, 203627), 'iat': datetime.datetime(2025, 6, 27, 10, 52, 7, 203636)}
2025-06-27 03:52:07,205 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:52:10,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:10,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:10,761 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 03:52:10,800 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-27 03:52:11,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:11,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:11,768 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 03:52:13,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:13,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:13,574 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 03:52:18,128 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 03:52:18,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 03:52:18,129 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 03:52:18,129 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 11, 22, 18, 128561), 'iat': datetime.datetime(2025, 6, 27, 10, 52, 18, 128577)}
2025-06-27 03:52:18,129 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 03:52:18,129 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjI2MzM4LCJpYXQiOjE3NTEwMjE1Mzh9.ZL2OKEvVSj8RpLb5qIAHEHLoMdmVQUlLps1jZN-o9D4, Expiry (seconds): 604800
2025-06-27 03:52:18,132 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 03:52:19,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:19,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:19,537 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,541 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,541 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 03:52:19,542 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:19,542 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:19,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,548 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,548 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:52:19,620 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:52:19,620 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:19,621 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:19,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:19,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:19,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,650 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,650 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:52:19,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:19,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:19,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,722 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,724 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 03:52:19,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:19,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:19,731 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:19,738 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:52:19,766 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:52:19,767 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:19,769 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:19,939 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:52:19,939 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:20,131 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:20,132 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:20,133 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:20,134 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:20,134 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:52:20,215 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:52:20,216 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:23,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:23,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:23,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:23,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:23,376 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:52:23,575 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:52:23,575 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:23,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:23,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:23,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:29,839 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:29,840 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:29,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:29,846 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:52:29,846 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:52:29,903 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:52:29,904 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:52:39,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:52:39,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:52:39,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:53:34,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:53:34,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:53:34,233 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:53:34,233 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 03:53:34,237 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 03:53:34,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:53:34,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:53:34,278 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:53:34,279 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:53:34,279 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:53:34,299 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:53:34,300 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:53:44,335 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:53:44,335 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:53:44,336 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:53:44,336 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:53:44,340 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:53:44,365 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:53:44,369 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:54:01,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:54:01,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:54:01,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:01,029 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:01,029 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:54:01,065 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:54:01,065 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:54:30,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:54:30,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:54:30,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:30,286 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 03:54:30,287 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 03:54:38,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:54:38,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:54:38,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:38,806 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:38,818 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:54:38,954 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:54:38,954 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:54:47,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:54:47,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:54:47,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:47,976 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:47,976 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:54:48,022 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:54:48,022 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:54:49,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 03:54:49,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 03:54:49,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:49,591 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 03:54:49,591 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 03:54:49,701 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 03:54:49,701 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 03:55:42,221 - INFO - app.core.security - Closing Redis connection...
2025-06-27 03:55:42,223 - INFO - app.core.security - Redis connection closed.
2025-06-27 04:09:19,345 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 04:09:19,345 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 04:09:19,350 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 04:09:19,351 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 04:09:19,393 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:09:19,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:09:19,393 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:09:19,393 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 11, 44, 19, 393580), 'iat': datetime.datetime(2025, 6, 27, 11, 9, 19, 393587)}
2025-06-27 04:09:19,394 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:09:34,123 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:34,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:34,125 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,126 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:09:34,151 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:09:34,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:34,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:34,182 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,182 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,183 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:34,206 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:34,207 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:09:34,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:34,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:34,331 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:34,350 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:34,350 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,350 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,350 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:34,556 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:34,557 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:09:34,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:34,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:34,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,714 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,715 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:34,740 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:34,740 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:09:34,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:34,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:34,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,873 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:34,900 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:34,900 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:09:34,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:34,984 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:34,986 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,987 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:34,987 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:35,026 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:35,027 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:09:35,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:35,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:35,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:35,074 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:35,074 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:35,078 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:35,079 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:09:36,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:36,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:36,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:36,177 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:36,177 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:36,204 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:36,206 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:09:49,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:09:49,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:09:49,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:49,238 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:09:49,238 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:09:49,252 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:09:49,252 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:10:10,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:10:10,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:10:10,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:10:10,588 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:10:10,588 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:10:10,619 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:10:10,620 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:10:51,252 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:10:51,253 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:10:51,253 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:10:51,254 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:10:51,254 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:10:51,289 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:10:51,290 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:11:08,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:11:08,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:11:08,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:11:08,625 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:11:08,625 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:11:08,659 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:11:08,660 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:11:42,089 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:11:42,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:11:42,090 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:11:42,090 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:11:42,098 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:11:57,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:11:57,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:11:57,962 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:11:57,974 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:11:57,996 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:12:01,259 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:01,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:01,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,269 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,269 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:12:01,271 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:01,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:01,275 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,278 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,281 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:12:01,306 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:12:01,307 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:01,307 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:01,358 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:01,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:01,363 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,363 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,364 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:12:01,383 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:12:01,384 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:01,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:01,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:01,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,440 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,440 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:12:01,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:01,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:01,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,441 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:12:01,479 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:12:01,481 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:01,482 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:01,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:01,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:01,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,602 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:01,602 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:12:01,638 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:12:01,639 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:02,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:02,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:02,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:02,889 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:02,889 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:12:02,907 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:12:02,907 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:03,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:03,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:03,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:05,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:12:05,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:12:05,355 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:05,355 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:12:05,357 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:12:05,388 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:12:05,389 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:12:32,427 - INFO - app.core.security - Closing Redis connection...
2025-06-27 04:12:32,429 - INFO - app.core.security - Redis connection closed.
2025-06-27 04:15:09,468 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 04:15:09,469 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 04:15:09,473 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 04:15:09,473 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 04:15:09,484 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:15:09,484 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:15:09,485 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:15:09,485 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 11, 50, 9, 484899), 'iat': datetime.datetime(2025, 6, 27, 11, 15, 9, 484902)}
2025-06-27 04:15:09,486 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:15:11,270 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:15:11,270 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:15:11,271 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:26,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:15:26,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:15:26,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:26,028 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:26,028 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:15:26,068 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:15:26,069 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:15:40,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:15:40,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:15:40,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:40,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:40,473 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:15:40,513 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:15:40,513 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:15:47,500 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:15:47,500 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:15:47,504 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:47,504 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:47,505 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:15:47,548 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:15:47,551 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:15:50,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:15:50,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:15:50,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:50,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:15:50,058 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:15:50,123 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:15:50,123 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:16:14,103 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:16:14,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:16:14,103 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:16:14,108 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:16:14,117 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:16:17,490 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:16:17,491 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:16:17,494 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:16:17,494 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:16:17,495 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:16:17,576 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:16:17,577 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:17:04,744 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:17:04,745 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:17:04,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:17:04,747 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:17:04,747 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:17:04,764 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:17:04,765 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:18:14,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:18:14,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:18:14,593 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:18:14,594 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:18:14,597 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:18:19,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:18:19,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:18:19,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:18:19,777 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:18:19,779 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDIzMzM4LCJpYXQiOjE3NTEwMjE1Mzh9.-jmBIzErOaUY0rPgFVTE1o85ZFtMlN8px_PY0hrxcxc
2025-06-27 04:18:20,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:18:20,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:18:20,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:18:20,613 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751023338, 'iat': 1751021538}
2025-06-27 04:18:20,613 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:18:20,633 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:18:20,633 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:18:46,516 - INFO - app.core.security - Closing Redis connection...
2025-06-27 04:18:46,521 - INFO - app.core.security - Redis connection closed.
2025-06-27 04:33:17,552 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 04:33:17,552 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 04:33:17,557 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 04:33:17,557 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 04:33:17,566 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:33:17,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:33:17,566 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:33:17,566 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 8, 17, 566315), 'iat': datetime.datetime(2025, 6, 27, 11, 33, 17, 566317)}
2025-06-27 04:33:17,568 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:33:30,118 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:33:30,118 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:33:30,118 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:33:30,118 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 12, 3, 30, 118233), 'iat': datetime.datetime(2025, 6, 27, 11, 33, 30, 118242)}
2025-06-27 04:33:30,119 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:33:30,119 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjI4ODEwLCJpYXQiOjE3NTEwMjQwMTB9.4UM075G3pleAJtOQrRAl8lFGq-UwUxF3iQDstfjnk2c, Expiry (seconds): 604800
2025-06-27 04:33:30,120 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 04:33:31,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:31,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:31,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,322 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,322 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:33:31,322 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:31,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:31,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,322 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,322 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:31,327 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:31,327 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:31,327 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:31,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:31,345 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:31,345 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,345 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,345 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:33:31,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:31,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:31,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,346 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,346 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:31,357 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:31,357 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:31,357 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:31,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:31,366 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:31,367 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,367 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,367 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:31,393 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:31,393 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:31,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:31,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:31,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,595 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:31,595 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:31,609 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:31,609 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:32,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:32,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:32,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:32,006 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:32,007 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:32,014 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:32,014 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:32,490 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:32,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:32,491 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:33,325 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:33,325 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:33,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:33,326 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025810, 'iat': 1751024010}
2025-06-27 04:33:33,326 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:33,337 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:33,337 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:44,860 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:33:44,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:33:44,861 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:33:44,861 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 12, 3, 44, 860575), 'iat': datetime.datetime(2025, 6, 27, 11, 33, 44, 860584)}
2025-06-27 04:33:44,861 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:33:44,862 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjI4ODI0LCJpYXQiOjE3NTEwMjQwMjR9.WcQMay9m8PxL7Sn4ydGTUQsZE_KUiuyRkORJ9em_occ, Expiry (seconds): 604800
2025-06-27 04:33:44,871 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 04:33:46,181 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:46,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:46,182 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,182 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,182 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:33:46,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:46,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:46,183 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,215 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:46,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:46,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:46,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,403 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:46,505 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:46,506 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:46,506 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:46,595 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:46,596 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:46,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:46,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:46,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,695 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,695 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:33:46,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:46,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:46,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,714 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,714 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:46,908 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:46,921 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:46,921 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:46,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:46,956 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:46,957 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,958 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:46,958 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:46,976 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:46,977 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:49,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:49,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:49,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:49,229 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:49,230 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:49,268 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:49,269 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:33:49,584 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:49,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:49,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:51,721 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:33:51,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:33:51,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:51,724 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:33:51,724 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:33:51,849 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:33:51,849 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:34:07,411 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:34:07,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:34:07,414 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:07,415 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:07,415 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:34:07,534 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:34:07,534 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:34:15,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:34:15,369 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:34:15,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:15,370 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:15,370 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:34:15,398 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:34:15,398 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:34:30,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:34:30,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:34:30,117 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:30,119 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:30,120 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:34:30,145 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:34:30,146 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:34:35,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:34:35,309 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:34:35,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:35,310 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:35,310 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:34:35,324 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:34:35,325 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:34:46,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:34:46,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:34:46,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:46,473 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:34:46,476 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:34:55,842 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:34:55,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:34:55,843 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:55,843 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:55,843 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:34:55,858 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:34:55,858 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:34:59,917 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:34:59,917 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:34:59,917 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:59,918 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:34:59,918 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:34:59,993 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:34:59,994 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:35:19,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:35:19,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:35:19,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:35:19,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:35:19,375 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:35:19,398 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:35:19,401 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:35:46,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:35:46,463 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:35:46,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:35:46,464 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:35:46,467 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:35:49,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:35:49,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:35:49,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:35:49,619 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:35:49,619 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:35:49,641 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:35:49,641 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:36:16,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:36:16,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:36:16,136 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:36:16,136 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:36:16,137 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:36:16,143 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:36:16,143 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:36:19,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:36:19,632 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:36:19,640 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:36:19,642 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:36:19,666 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:37:19,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:37:19,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:37:19,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:37:19,580 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:37:19,581 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:37:33,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:37:33,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:37:33,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:37:33,103 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:37:33,103 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:37:33,107 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:37:33,107 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:37:39,824 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:37:39,825 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:37:39,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:37:39,827 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:37:39,832 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:38:50,840 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:38:50,840 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:38:50,841 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:38:50,842 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:38:50,842 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:38:50,860 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:38:50,861 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:39:25,340 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:39:25,341 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:39:25,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:39:25,342 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:39:25,344 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:40:11,957 - INFO - app.core.security - Closing Redis connection...
2025-06-27 04:40:11,963 - INFO - app.core.security - Redis connection closed.
2025-06-27 04:43:31,389 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 04:43:31,389 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 04:43:31,401 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 04:43:31,401 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 04:43:31,411 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:43:31,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:43:31,411 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:43:31,411 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 18, 31, 411455), 'iat': datetime.datetime(2025, 6, 27, 11, 43, 31, 411459)}
2025-06-27 04:43:31,413 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:43:36,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:43:36,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:43:36,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:43:41,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:43:41,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:43:41,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:43:41,893 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:43:41,895 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:43:46,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:43:46,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:43:46,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:43:46,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:43:46,270 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:43:46,279 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:43:46,279 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:44:11,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:44:11,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:44:11,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:44:11,964 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:44:11,964 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:44:11,969 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:44:11,970 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:44:25,441 - INFO - app.core.security - Closing Redis connection...
2025-06-27 04:44:25,442 - INFO - app.core.security - Redis connection closed.
2025-06-27 04:47:38,625 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 04:47:38,625 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 04:47:38,628 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 04:47:38,628 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 04:47:38,638 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:47:38,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:47:38,638 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:47:38,638 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 22, 38, 638495), 'iat': datetime.datetime(2025, 6, 27, 11, 47, 38, 638504)}
2025-06-27 04:47:38,639 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:47:44,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:44,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:44,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:47:44,239 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:47:44,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:44,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:44,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751025824, 'iat': 1751024024}
2025-06-27 04:47:44,247 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI1ODI0LCJpYXQiOjE3NTEwMjQwMjR9.aE2C7RFEShLtN7dRFnR2qFiRcOBBHsw4UqaNhM5feOo
2025-06-27 04:47:48,658 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 04:47:48,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 04:47:48,658 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 04:47:48,658 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 12, 17, 48, 658206), 'iat': datetime.datetime(2025, 6, 27, 11, 47, 48, 658210)}
2025-06-27 04:47:48,658 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 04:47:48,658 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjI5NjY4LCJpYXQiOjE3NTEwMjQ4Njh9.eQjc9_38hbI2mQumtrvdwhGR9rSNv8zqi-CTbtfbzGE, Expiry (seconds): 604800
2025-06-27 04:47:48,662 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 04:47:49,926 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:49,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:49,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:49,927 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:49,927 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:47:49,927 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:49,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:49,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:49,939 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:49,939 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:47:50,059 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:47:50,060 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:47:50,060 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:47:50,174 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:50,174 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:50,174 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,175 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,175 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:47:50,294 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:47:50,294 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:47:50,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:50,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:50,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,557 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,558 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 04:47:50,558 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:50,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:50,558 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,559 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,559 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:47:50,581 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:47:50,581 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:47:50,581 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:47:50,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:50,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:50,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:50,592 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:47:50,736 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:47:50,736 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:47:52,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:52,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:52,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:52,623 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:52,623 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:47:52,676 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:47:52,676 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:47:52,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:52,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:52,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:55,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:47:55,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:47:55,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:55,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:47:55,417 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:47:55,445 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:47:55,445 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:49:04,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:49:04,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:49:04,607 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:49:04,607 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:49:04,607 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 04:49:04,610 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 04:49:04,610 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 04:49:20,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 04:49:20,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 04:49:20,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 04:49:20,064 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI2NjY4LCJpYXQiOjE3NTEwMjQ4Njh9.bmZmtvRS3aID92ZRh0DyPlxUeLJeBVu6-ws-IIovRJk
2025-06-27 04:49:20,069 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI2NjY4LCJpYXQiOjE3NTEwMjQ4Njh9.bmZmtvRS3aID92ZRh0DyPlxUeLJeBVu6-ws-IIovRJk
2025-06-27 05:03:29,277 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:03:29,277 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:03:29,281 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:03:29,282 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:03:29,297 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:03:29,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:03:29,297 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:03:29,297 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 38, 29, 297450), 'iat': datetime.datetime(2025, 6, 27, 12, 3, 29, 297454)}
2025-06-27 05:03:29,301 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:03:35,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:03:35,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:03:35,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 05:03:38,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:03:38,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:03:38,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751026668, 'iat': 1751024868}
2025-06-27 05:03:38,888 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI2NjY4LCJpYXQiOjE3NTEwMjQ4Njh9.bmZmtvRS3aID92ZRh0DyPlxUeLJeBVu6-ws-IIovRJk
2025-06-27 05:03:38,891 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI2NjY4LCJpYXQiOjE3NTEwMjQ4Njh9.bmZmtvRS3aID92ZRh0DyPlxUeLJeBVu6-ws-IIovRJk
2025-06-27 05:04:10,142 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:04:10,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:04:10,143 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:04:10,143 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 12, 34, 10, 142826), 'iat': datetime.datetime(2025, 6, 27, 12, 4, 10, 142834)}
2025-06-27 05:04:10,143 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:04:10,144 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjMwNjUwLCJpYXQiOjE3NTEwMjU4NTB9.P2eR4kj0KEbYmdciR_xJd2eiNWt_JctsNdzr2Zvf1HA, Expiry (seconds): 604800
2025-06-27 05:04:10,149 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 05:04:11,344 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:11,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:11,345 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,345 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,346 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:04:11,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:11,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:11,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,347 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,347 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:04:11,353 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:04:11,354 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:11,354 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:11,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:11,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:11,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,409 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,409 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:04:11,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:11,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:11,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,409 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:04:11,427 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:04:11,428 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:11,428 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:11,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:11,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:11,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,438 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:04:11,451 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:04:11,451 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:11,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:11,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:11,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,500 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:11,500 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:04:11,557 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:04:11,558 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:12,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:12,827 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:12,831 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:12,831 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:12,837 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:04:12,900 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:04:12,901 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:13,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:13,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:13,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:14,954 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:04:14,955 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:04:14,959 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:04:14,959 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:04:14,978 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:04:14,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:04:14,978 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:04:14,978 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 39, 14, 978377), 'iat': datetime.datetime(2025, 6, 27, 12, 4, 14, 978385)}
2025-06-27 05:04:14,979 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:04:17,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:04:17,013 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:04:17,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:17,014 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:04:17,014 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:04:17,062 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:04:17,062 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:04:44,986 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:04:44,986 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:04:44,995 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:04:44,996 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:04:45,010 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:04:45,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:04:45,010 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:04:45,010 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 39, 45, 9999), 'iat': datetime.datetime(2025, 6, 27, 12, 4, 45, 10005)}
2025-06-27 05:04:45,010 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:05:28,162 - INFO - app.core.security - Closing Redis connection...
2025-06-27 05:05:28,165 - INFO - app.core.security - Redis connection closed.
2025-06-27 05:05:48,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:05:48,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:05:48,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:03,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:03,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,238 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,238 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:06:03,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:03,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:03,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,239 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,239 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:03,245 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:03,246 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:03,246 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:03,271 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:03,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:03,271 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,271 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,271 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:03,278 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:03,278 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:03,304 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:03,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:03,305 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,305 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,305 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:06:03,305 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:03,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:03,307 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,307 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,307 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:03,313 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:03,313 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:03,313 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:03,737 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:03,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:03,738 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,738 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:03,752 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:03,752 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:03,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:03,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:03,998 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,998 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:03,998 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:04,013 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:04,013 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:04,025 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:04,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:04,026 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:04,026 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:04,026 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:04,117 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:04,117 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:04,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:04,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:04,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:04,864 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:04,864 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:06:04,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:04,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:04,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:04,866 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:04,866 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:04,974 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:04,975 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:04,975 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:05,003 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:05,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:05,004 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,004 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,004 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:05,020 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:05,020 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:05,076 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:05,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:05,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,078 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,079 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:06:05,079 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:05,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:05,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,080 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,080 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:05,092 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:05,093 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:05,093 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:05,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:05,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:05,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,202 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:05,213 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:05,213 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:05,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:05,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:05,681 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,681 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:05,681 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:05,687 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:05,688 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:06,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:06,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:06,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:06,407 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:06,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:06,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:06,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:06,424 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:06,466 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:06,466 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:43,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:43,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:43,030 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,030 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,030 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:06:43,030 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:43,030 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:43,031 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,031 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,031 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:43,036 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:43,036 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:43,036 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:43,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:43,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:43,047 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,048 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,048 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:06:43,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:43,048 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:43,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,048 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,048 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:43,056 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:43,057 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:43,057 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:43,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:43,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:43,069 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,069 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,069 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:43,076 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:43,077 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:43,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:43,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:43,397 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,398 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,398 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:43,418 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:43,419 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:43,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:43,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:43,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:43,530 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:43,535 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:43,536 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:44,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:44,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:44,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:44,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:06:44,202 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:06:44,212 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:06:44,212 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:06:44,270 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:06:44,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:06:44,271 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:12,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:07:12,575 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:07:12,576 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:12,576 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:12,576 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:07:12,583 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:07:12,584 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:07:23,335 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:07:23,336 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:07:23,337 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:23,337 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:23,337 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:07:23,353 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:07:23,353 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:07:48,805 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:07:48,805 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:07:48,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:48,806 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI3NjUwLCJpYXQiOjE3NTEwMjU4NTB9.s1q1vHwoxuPAwKzJ0NdBfwxc1uz0GbH0H9kigDpKyLY
2025-06-27 05:07:48,807 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI3NjUwLCJpYXQiOjE3NTEwMjU4NTB9.s1q1vHwoxuPAwKzJ0NdBfwxc1uz0GbH0H9kigDpKyLY
2025-06-27 05:07:59,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:07:59,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:07:59,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:59,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:07:59,919 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:07:59,922 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:07:59,923 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:08:03,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:08:03,398 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:08:03,399 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:08:03,399 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI3NjUwLCJpYXQiOjE3NTEwMjU4NTB9.s1q1vHwoxuPAwKzJ0NdBfwxc1uz0GbH0H9kigDpKyLY
2025-06-27 05:08:03,401 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI3NjUwLCJpYXQiOjE3NTEwMjU4NTB9.s1q1vHwoxuPAwKzJ0NdBfwxc1uz0GbH0H9kigDpKyLY
2025-06-27 05:08:11,868 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:08:11,868 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:08:11,868 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:08:11,869 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:08:11,869 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:08:11,877 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:08:11,877 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:09:00,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:09:00,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:09:00,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:09:00,608 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI3NjUwLCJpYXQiOjE3NTEwMjU4NTB9.s1q1vHwoxuPAwKzJ0NdBfwxc1uz0GbH0H9kigDpKyLY
2025-06-27 05:09:00,609 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI3NjUwLCJpYXQiOjE3NTEwMjU4NTB9.s1q1vHwoxuPAwKzJ0NdBfwxc1uz0GbH0H9kigDpKyLY
2025-06-27 05:09:15,042 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:09:15,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:09:15,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:09:15,043 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751027650, 'iat': 1751025850}
2025-06-27 05:09:15,044 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:09:15,052 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:09:15,052 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:10:47,187 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:10:47,187 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:10:47,193 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:10:47,193 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:10:47,207 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:10:47,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:10:47,207 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:10:47,207 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 45, 47, 207009), 'iat': datetime.datetime(2025, 6, 27, 12, 10, 47, 207015)}
2025-06-27 05:10:47,207 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:10:54,737 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:10:54,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:10:54,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:10:54,737 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 6, 27, 12, 40, 54, 737319), 'iat': datetime.datetime(2025, 6, 27, 12, 10, 54, 737329)}
2025-06-27 05:10:54,738 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:10:54,738 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTE2MzEwNTQsImlhdCI6MTc1MTAyNjI1NH0.OqsZmlJJI1ZBo8mrlsAqmZDP2A77wyA0kMq9Es_vBZA, Expiry (seconds): 604800
2025-06-27 05:10:54,750 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-06-27 05:10:55,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:55,891 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:55,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,893 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,894 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:10:55,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:55,895 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:55,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,896 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,896 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:10:55,920 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:10:55,920 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:10:55,921 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:10:55,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:55,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:55,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,977 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,977 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:10:55,977 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:55,977 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:55,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,980 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:10:55,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:55,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:55,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,989 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:55,989 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:10:56,000 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:10:56,002 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:10:56,002 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:10:56,051 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:10:56,052 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:10:56,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:56,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:56,218 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:56,218 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:56,218 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:10:56,245 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:10:56,245 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:10:57,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:57,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:57,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:57,137 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:57,139 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:10:57,161 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:10:57,162 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:10:57,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:57,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:57,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:58,824 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:10:58,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:10:58,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:58,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:10:58,827 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:10:58,851 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:10:58,851 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:11:10,982 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:11:10,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:11:10,984 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:10,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:10,986 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:11:10,996 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:11:10,998 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:11:21,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:11:21,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:11:21,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:21,712 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:21,712 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:11:21,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:11:21,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:11:21,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:21,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:21,713 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:11:21,851 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:11:21,852 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:11:21,852 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:11:53,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:11:53,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:11:53,809 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:53,810 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:53,810 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:11:53,833 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:11:53,833 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:11:55,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:11:55,895 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:11:55,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:11:55,907 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:11:55,915 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:12:12,721 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:12:12,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:12:12,723 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:12:12,723 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:12:12,723 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:12:12,733 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:12:12,733 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:13:17,191 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:13:17,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:13:17,191 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:13:17,192 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 27, 12, 43, 17, 191459), 'iat': datetime.datetime(2025, 6, 27, 12, 13, 17, 191469)}
2025-06-27 05:13:17,192 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:13:17,192 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTYzMTE5NywiaWF0IjoxNzUxMDI2Mzk3fQ.TqGsHohWNF38Xev8HqtWAAmZmxxmY3zUxWFZnzEPij4, Expiry (seconds): 604800
2025-06-27 05:13:17,197 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 05:13:38,331 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:13:38,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:13:38,331 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:13:38,331 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:13:38,332 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:13:38,348 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:13:38,349 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:13:39,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:13:39,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:13:39,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:13:39,950 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:13:39,966 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:13:54,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:13:54,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:13:54,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751028197, 'iat': 1751026397}
2025-06-27 05:13:54,314 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751028197, 'iat': 1751026397}
2025-06-27 05:13:54,314 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-27 05:13:54,325 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-27 05:13:54,326 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-27 05:13:57,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:13:57,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:13:57,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:13:57,695 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:13:57,695 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:14:23,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:23,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:23,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:23,836 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:14:23,838 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:14:40,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:40,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:40,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,777 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,777 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:14:40,777 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:40,777 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:40,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,777 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,777 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:40,789 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:40,789 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:40,789 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:40,825 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:40,825 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:40,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,826 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,826 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:14:40,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:40,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:40,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,826 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,826 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:40,846 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:40,847 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:40,847 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:40,857 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:40,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:40,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,859 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:40,859 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:40,868 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:40,869 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:41,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:41,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:41,237 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:41,237 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:41,237 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:41,243 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:41,244 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:41,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:41,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:41,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:41,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:41,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:41,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:41,815 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:41,815 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:41,823 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:41,823 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:42,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:42,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:42,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:42,617 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:42,618 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:42,663 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:42,663 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:48,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:48,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:48,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:48,137 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:48,137 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:48,141 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:48,141 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:58,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:58,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:58,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:58,198 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:58,198 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:14:58,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:14:58,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:14:58,199 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:58,200 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:14:58,200 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:14:58,211 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:14:58,211 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:14:58,212 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:15:33,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:15:33,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:15:33,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:33,377 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:33,378 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:15:33,383 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:15:33,383 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:15:45,506 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:15:45,507 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:15:45,507 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751028197, 'iat': 1751026397}
2025-06-27 05:15:45,507 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751028197, 'iat': 1751026397}
2025-06-27 05:15:45,507 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-27 05:15:45,513 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-27 05:15:45,513 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-27 05:15:49,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:15:49,048 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:15:49,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:49,048 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:15:49,051 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:15:53,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:15:53,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:15:53,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:53,223 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:53,223 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:15:53,232 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:15:53,233 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:15:54,003 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:15:54,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:15:54,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:54,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:54,005 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:15:54,017 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:15:54,017 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:15:56,560 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:15:56,560 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:15:56,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:56,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:15:56,560 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:15:56,565 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:15:56,565 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:17:09,948 - INFO - app.core.security - Closing Redis connection...
2025-06-27 05:17:09,951 - INFO - app.core.security - Redis connection closed.
2025-06-27 05:17:20,158 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:17:20,159 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:17:20,166 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:17:20,166 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:17:20,176 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:17:20,176 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:17:20,176 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:17:20,176 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 52, 20, 176077), 'iat': datetime.datetime(2025, 6, 27, 12, 17, 20, 176081)}
2025-06-27 05:17:20,177 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:17:23,647 - INFO - app.core.security - Closing Redis connection...
2025-06-27 05:17:23,654 - INFO - app.core.security - Redis connection closed.
2025-06-27 05:17:27,706 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:17:27,706 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:17:27,712 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:17:27,712 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:17:27,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:17:27,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:17:27,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:17:27,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 52, 27, 723427), 'iat': datetime.datetime(2025, 6, 27, 12, 17, 27, 723437)}
2025-06-27 05:17:27,724 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:17:34,780 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:17:34,780 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:17:34,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:07,412 - INFO - app.core.security - Closing Redis connection...
2025-06-27 05:18:07,412 - INFO - app.core.security - Redis connection closed.
2025-06-27 05:18:09,663 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:18:09,663 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:18:09,669 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:18:09,669 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:18:09,676 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:18:09,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:18:09,676 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:18:09,676 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 12, 53, 9, 676688), 'iat': datetime.datetime(2025, 6, 27, 12, 18, 9, 676690)}
2025-06-27 05:18:09,677 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:18:11,324 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:18:11,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:18:11,324 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:11,324 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:18:11,327 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:18:11,327 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:18:11,328 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:11,337 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:18:17,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:18:17,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:18:17,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:17,569 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:17,570 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:18:17,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:18:17,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:18:17,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:17,571 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:17,571 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:18:17,608 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:18:17,609 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:18:17,609 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:18:32,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:18:32,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:18:32,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:32,462 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:18:32,474 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:18:48,081 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:18:48,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:18:48,082 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:48,082 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:48,082 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-27 05:18:48,099 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-27 05:18:48,099 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-27 05:18:52,490 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:18:52,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:18:52,491 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751028054, 'iat': 1751026254}
2025-06-27 05:18:52,491 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:18:52,539 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEwMjgwNTQsImlhdCI6MTc1MTAyNjI1NH0.ZaM413_LNFt4A21QLkFM45dDEQKmjXIAmpHaKdlrsXM
2025-06-27 05:19:12,216 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:19:12,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:19:12,217 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:19:12,217 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 12, 49, 12, 216952), 'iat': datetime.datetime(2025, 6, 27, 12, 19, 12, 216959)}
2025-06-27 05:19:12,217 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:19:12,217 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjMxNTUyLCJpYXQiOjE3NTEwMjY3NTJ9.bjbyEfMe2oeARFyHlI22UTv3FdzZqS_da0NFjbNG840, Expiry (seconds): 604800
2025-06-27 05:19:12,219 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 05:19:13,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:13,486 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:13,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,488 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,488 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:19:13,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:13,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:13,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,490 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,490 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:19:13,504 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:19:13,504 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:13,504 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:13,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:13,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:13,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,579 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,580 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:19:13,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:13,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:13,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,581 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:19:13,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:13,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:13,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,602 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,602 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:19:13,623 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:19:13,623 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:13,624 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:13,633 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:19:13,634 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:13,737 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:13,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:13,738 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:13,738 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:19:13,780 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:19:13,785 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:14,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:14,987 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:14,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:14,988 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:14,988 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:19:15,005 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:19:15,006 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:15,340 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:15,340 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:15,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:16,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:16,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:16,203 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:16,203 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:16,204 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:19:16,231 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:19:16,232 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:31,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:19:31,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:19:31,127 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:31,128 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:19:31,128 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:19:31,137 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:19:31,137 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:19:44,788 - INFO - app.core.security - Closing Redis connection...
2025-06-27 05:19:44,788 - INFO - app.core.security - Redis connection closed.
2025-06-27 05:25:30,095 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:25:30,096 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:25:30,101 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:25:30,102 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:25:30,111 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:25:30,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:25:30,111 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:25:30,111 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 13, 0, 30, 111198), 'iat': datetime.datetime(2025, 6, 27, 12, 25, 30, 111202)}
2025-06-27 05:25:30,111 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:25:33,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:25:33,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:25:33,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:25:38,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:25:38,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:25:38,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:25:38,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:25:38,070 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:25:38,088 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:25:38,089 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:25:56,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:25:56,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:25:56,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:25:56,452 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:25:56,454 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:26:24,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:26:24,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:26:24,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:26:24,286 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:26:24,286 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:26:24,341 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:26:24,342 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:26:52,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:26:52,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:26:52,248 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:26:52,249 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:26:52,249 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:26:52,390 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:26:52,391 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:26:56,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:26:56,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:26:56,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:26:56,447 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:26:56,448 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:22,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:27:22,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:27:22,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:27:22,515 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:22,522 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:24,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:27:24,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:27:24,407 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:27:24,408 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:24,437 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:34,150 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:27:34,150 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:27:34,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:27:34,151 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:34,152 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:59,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:27:59,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:27:59,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:27:59,429 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:27:59,436 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:28:06,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:28:06,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:28:06,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:28:06,440 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:28:06,440 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:28:06,527 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:28:06,527 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:29:14,960 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:29:14,960 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:29:14,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:29:14,961 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:29:14,961 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:29:14,983 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:29:14,984 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:29:18,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:29:18,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:29:18,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:29:18,196 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:29:18,197 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:29:24,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:29:24,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:29:24,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:29:24,874 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:29:24,874 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:29:24,885 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:29:24,885 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:29:34,523 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:29:34,523 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:29:34,524 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:29:34,524 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:29:34,532 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:29:47,843 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:29:47,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:29:47,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:29:47,845 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:29:47,854 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:30:17,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:30:17,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:30:17,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:30:17,837 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:30:17,838 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:30:30,797 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:30:30,797 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:30:30,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:30:30,807 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:30:30,808 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:30:30,852 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:30:30,853 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:30:39,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:30:39,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:30:39,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:30:39,048 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:30:39,048 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:30:39,055 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:30:39,055 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:30:50,382 - INFO - app.core.security - Closing Redis connection...
2025-06-27 05:30:50,383 - INFO - app.core.security - Redis connection closed.
2025-06-27 05:34:16,751 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:34:16,751 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:34:16,758 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:34:16,758 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:34:16,766 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:34:16,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:34:16,766 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:34:16,766 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 13, 9, 16, 766826), 'iat': datetime.datetime(2025, 6, 27, 12, 34, 16, 766829)}
2025-06-27 05:34:16,767 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:34:18,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:34:18,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:34:18,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:34:20,758 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:34:20,758 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:34:20,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:34:20,758 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:34:20,758 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:34:20,781 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:34:20,781 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:34:25,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:34:25,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:34:25,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:34:25,887 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:34:25,888 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:34:27,055 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:34:27,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:34:27,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:34:27,056 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:34:27,056 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:34:27,064 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:34:27,064 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:35:39,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:35:39,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:35:39,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:35:39,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:35:39,088 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:35:39,114 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:35:39,114 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:35:43,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:35:43,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:35:43,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:35:43,654 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:35:43,654 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:35:43,662 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:35:43,662 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:35:44,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:35:44,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:35:44,918 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:35:44,919 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:35:44,934 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:36:37,507 - INFO - app.core.security - Closing Redis connection...
2025-06-27 05:36:37,509 - INFO - app.core.security - Redis connection closed.
2025-06-27 05:36:50,859 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 05:36:50,859 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 05:36:50,863 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 05:36:50,864 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 05:36:50,874 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 05:36:50,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 05:36:50,875 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 05:36:50,875 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 13, 11, 50, 874787), 'iat': datetime.datetime(2025, 6, 27, 12, 36, 50, 874792)}
2025-06-27 05:36:50,875 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 05:36:52,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:36:52,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:36:52,757 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:36:52,757 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:36:52,757 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:36:52,886 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:36:52,886 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:36:56,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:36:56,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:36:56,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:36:59,574 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:36:59,574 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:36:59,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:36:59,575 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:36:59,575 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:37:01,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:37:01,597 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:37:01,597 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:37:01,598 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:37:01,598 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:37:01,603 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:37:01,603 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:37:07,446 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:37:07,447 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:37:07,448 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:37:07,449 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:37:07,449 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:37:07,474 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:37:07,474 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:37:29,127 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:37:29,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:37:29,129 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:37:29,129 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:37:29,130 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:37:29,175 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:37:29,175 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:38:06,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:38:06,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:38:06,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:06,451 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:06,452 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:38:06,463 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:38:06,463 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:38:17,898 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:38:17,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:38:17,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:17,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:17,900 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:38:17,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:38:17,906 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:38:17,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:17,907 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:17,908 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:38:17,908 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:38:17,939 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:30,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:38:30,656 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:38:30,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:30,657 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:30,660 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:40,932 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:38:40,932 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:38:40,933 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:40,933 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:40,941 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:52,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:38:52,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:38:52,400 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:52,401 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:52,412 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:59,749 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:38:59,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:38:59,750 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:38:59,751 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:38:59,754 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:39:07,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:07,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:07,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:07,939 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:39:07,943 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:39:14,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:14,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:14,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:14,791 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:14,791 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:39:14,794 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:39:14,794 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:15,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:15,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:15,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:15,617 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:39:15,619 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:39:23,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:23,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:23,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,064 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,064 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:39:23,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:23,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:23,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,068 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:39:23,087 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:39:23,087 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:23,088 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:23,127 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:23,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:23,128 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,128 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,128 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:39:23,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:23,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:23,129 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,129 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,129 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:39:23,191 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:39:23,192 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:23,193 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:23,260 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:23,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:23,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:23,262 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:39:23,280 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:39:23,280 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:24,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:24,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:24,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:24,888 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:24,889 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:39:24,911 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:39:24,911 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:25,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:25,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:25,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:25,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:25,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:25,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:25,698 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:25,698 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:39:25,730 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:39:25,731 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:39:26,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:39:26,528 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:39:26,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:26,529 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:39:26,529 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:39:26,544 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:39:26,546 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:40:33,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:40:33,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:40:33,982 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:40:33,983 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:40:33,989 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:40:40,701 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:40:40,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:40:40,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:40:40,703 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:40:40,703 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:40:40,717 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:40:40,717 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:40:44,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:40:44,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:40:44,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:40:44,650 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:40:44,651 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:40:59,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:40:59,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:40:59,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:40:59,812 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:40:59,825 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:41:01,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:41:01,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:41:01,670 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:41:01,671 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:41:01,672 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:41:04,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:41:04,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:41:04,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:41:04,135 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:41:04,137 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:41:55,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:41:55,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:41:55,614 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:41:55,614 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:41:55,614 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:41:55,618 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:41:55,618 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:42:04,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:42:04,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:42:04,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:42:04,462 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:42:04,463 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:42:54,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:42:54,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:42:54,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:42:54,965 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:42:54,978 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:43:11,729 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:43:11,729 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:43:11,729 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:43:11,729 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:43:11,729 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:43:11,735 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:43:11,736 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:43:54,973 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:43:54,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:43:54,973 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:43:54,974 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:43:54,983 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:44:25,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:44:25,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:44:25,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:44:25,287 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:44:25,287 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:44:25,295 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:44:25,295 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:15,983 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:15,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:15,984 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:15,984 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:15,984 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:45:15,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:15,984 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:15,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:15,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:15,985 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:45:16,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:16,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:16,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,024 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:45:16,058 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:45:16,058 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:16,058 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:16,066 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDI4NTUyLCJpYXQiOjE3NTEwMjY3NTJ9.PCYj3c6GNfagfSW6Dfhm4uIqC2Eeb_ayrOeJcM8BI8s
2025-06-27 05:45:16,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:16,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:16,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,085 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,085 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:45:16,120 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:45:16,121 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:16,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:16,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:16,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,322 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,322 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 05:45:16,327 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:16,327 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:16,327 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,327 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,328 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:45:16,369 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:45:16,369 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:16,377 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:16,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:16,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:16,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:16,657 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:45:16,712 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:45:16,713 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:18,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:18,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:18,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:18,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:18,379 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:45:18,394 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:45:18,394 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:45:18,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:18,765 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:18,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:20,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:45:20,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:45:20,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:20,382 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:45:20,382 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:45:20,409 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:45:20,409 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:46:16,481 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:46:16,482 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:46:16,482 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:46:16,483 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751028552, 'iat': 1751026752}
2025-06-27 05:46:16,483 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 05:46:16,498 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 05:46:16,498 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 05:50:01,308 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:50:01,309 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:50:01,313 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 05:50:01,324 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-27 05:50:01,355 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:50:01,355 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:50:01,356 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 05:50:01,364 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-27 05:50:01,391 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:50:01,391 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:50:01,392 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 05:50:01,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 05:50:01,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 05:50:01,857 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 05:50:01,859 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-27 06:02:39,838 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 06:02:39,838 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 06:02:39,854 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 06:02:39,854 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 06:02:39,862 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 06:02:39,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 06:02:39,862 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 06:02:39,862 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 13, 37, 39, 862258), 'iat': datetime.datetime(2025, 6, 27, 13, 2, 39, 862261)}
2025-06-27 06:02:39,863 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 06:02:50,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:50,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:50,288 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 06:02:50,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:50,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:50,311 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 06:02:50,313 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-27 06:02:50,348 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:50,348 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:50,349 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 06:02:50,351 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-27 06:02:52,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:52,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:52,521 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-27 06:02:52,524 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-27 06:02:56,876 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 06:02:56,876 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 06:02:56,876 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 06:02:56,876 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 13, 32, 56, 876348), 'iat': datetime.datetime(2025, 6, 27, 13, 2, 56, 876357)}
2025-06-27 06:02:56,877 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 06:02:56,877 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjM0MTc2LCJpYXQiOjE3NTEwMjkzNzZ9.lU_WaqbXf7qq4iczJnZp1x_OHG1Wzq4Fa4Y5AOwCbRg, Expiry (seconds): 604800
2025-06-27 06:02:56,886 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 06:02:58,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:58,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:58,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,297 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,298 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 06:02:58,298 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:58,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:58,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,304 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:02:58,369 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:02:58,369 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:02:58,369 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:02:58,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:58,454 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:58,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,460 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,460 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:02:58,510 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:02:58,511 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:02:58,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:58,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:58,614 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,616 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,616 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 06:02:58,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:58,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:58,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,617 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,619 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:02:58,670 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:02:58,674 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:02:58,675 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:02:58,735 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:02:58,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:02:58,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:02:58,741 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:02:58,772 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:02:58,773 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:03:00,738 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:03:00,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:03:00,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:03:00,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:03:00,741 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:03:00,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:03:00,792 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:03:00,793 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:03:00,793 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:03:00,793 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:03:00,839 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:03:00,847 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:03:00,870 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:03:00,870 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:03:03,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:03:03,869 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:03:03,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:04:14,442 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:04:14,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:04:14,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:04:14,452 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:04:14,453 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:04:14,498 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:04:14,499 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:04:18,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:04:18,640 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:04:18,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:04:18,643 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxMTc2LCJpYXQiOjE3NTEwMjkzNzZ9.MPpUtOACPPrVHYLwXQC2JZI7I8q6dU4IjYxkjT9XHGU
2025-06-27 06:04:18,647 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxMTc2LCJpYXQiOjE3NTEwMjkzNzZ9.MPpUtOACPPrVHYLwXQC2JZI7I8q6dU4IjYxkjT9XHGU
2025-06-27 06:04:19,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:04:19,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:04:19,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:04:19,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:04:19,794 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:04:19,820 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:04:19,820 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:05:18,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:05:18,957 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:05:18,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:05:18,960 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxMTc2LCJpYXQiOjE3NTEwMjkzNzZ9.MPpUtOACPPrVHYLwXQC2JZI7I8q6dU4IjYxkjT9XHGU
2025-06-27 06:05:18,963 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxMTc2LCJpYXQiOjE3NTEwMjkzNzZ9.MPpUtOACPPrVHYLwXQC2JZI7I8q6dU4IjYxkjT9XHGU
2025-06-27 06:05:28,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:05:28,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:05:28,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:05:28,774 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:05:28,775 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:05:28,786 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:05:28,786 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:05:41,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:05:41,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:05:41,534 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:05:41,534 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxMTc2LCJpYXQiOjE3NTEwMjkzNzZ9.MPpUtOACPPrVHYLwXQC2JZI7I8q6dU4IjYxkjT9XHGU
2025-06-27 06:05:41,538 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxMTc2LCJpYXQiOjE3NTEwMjkzNzZ9.MPpUtOACPPrVHYLwXQC2JZI7I8q6dU4IjYxkjT9XHGU
2025-06-27 06:06:02,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:02,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:02,402 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,402 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,402 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 06:06:02,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:02,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:02,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,403 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,403 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:06:02,430 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:06:02,430 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:06:02,431 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:06:02,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:02,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:02,477 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,478 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,478 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 06:06:02,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:02,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:02,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,479 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,479 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:06:02,485 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:06:02,485 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:06:02,486 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:06:02,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:02,584 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:02,585 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,585 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,585 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:06:02,611 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:06:02,612 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:06:02,924 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:02,925 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:02,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,927 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:02,928 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:06:03,066 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:06:03,067 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:06:04,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:04,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:04,454 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:04,454 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:04,454 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:06:04,480 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:06:04,480 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:06:05,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:05,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:05,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:07,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:06:07,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:06:07,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:07,680 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:06:07,680 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:06:07,694 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:06:07,695 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:08,321 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-27 06:08:08,321 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-27 06:08:08,327 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-27 06:08:08,327 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-27 06:08:08,333 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 06:08:08,333 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 06:08:08,333 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 06:08:08,333 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 27, 13, 43, 8, 333464), 'iat': datetime.datetime(2025, 6, 27, 13, 8, 8, 333467)}
2025-06-27 06:08:08,333 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 06:08:12,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:12,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:12,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031176, 'iat': 1751029376}
2025-06-27 06:08:16,461 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-27 06:08:16,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-27 06:08:16,462 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-27 06:08:16,462 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 27, 13, 38, 16, 461015), 'iat': datetime.datetime(2025, 6, 27, 13, 8, 16, 461046)}
2025-06-27 06:08:16,463 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-27 06:08:16,464 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxNjM0NDk2LCJpYXQiOjE3NTEwMjk2OTZ9.eJiVtUA3Bdpnn5MZvPpRJyImzdm00ZaFY93MsppuoD0, Expiry (seconds): 604800
2025-06-27 06:08:16,468 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-27 06:08:17,800 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:17,800 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:17,801 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,801 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,801 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 06:08:17,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:17,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:17,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,802 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,802 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:08:17,824 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:08:17,825 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:17,827 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:17,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:17,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:17,869 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,870 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,870 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-27 06:08:17,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:17,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:17,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,871 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,872 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:08:17,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:17,906 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:17,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:17,913 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:08:17,921 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:08:17,921 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:17,922 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:18,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:18,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:18,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:18,008 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:18,008 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:08:18,032 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:08:18,035 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:18,087 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:08:18,088 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:19,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:19,987 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:19,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:19,989 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:19,989 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:08:20,011 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:08:20,012 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:20,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:20,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:20,338 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:22,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:22,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:22,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:22,398 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:22,398 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:08:22,424 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:08:22,425 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:08:41,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:08:41,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:08:41,781 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:41,782 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:08:41,782 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:08:41,816 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:08:41,817 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:09:32,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:09:32,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:09:32,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:09:33,002 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:09:33,009 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:09:34,692 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:09:34,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:09:34,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:09:34,693 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:09:34,694 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:09:34,716 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:09:34,716 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:10:07,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:10:07,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:10:07,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:10:07,198 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:10:07,198 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:10:49,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:10:49,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:10:49,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:10:49,622 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:10:49,622 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:10:49,626 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:10:49,626 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:11:03,718 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:11:03,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:11:03,719 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:11:03,720 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:11:03,721 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:11:18,274 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:11:18,274 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:11:18,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:11:18,276 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:11:18,281 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:12:05,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:12:05,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:12:05,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:12:05,883 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:12:05,883 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-27 06:12:05,890 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-27 06:12:05,891 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-27 06:12:06,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-27 06:12:06,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-27 06:12:06,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751031496, 'iat': 1751029696}
2025-06-27 06:12:06,690 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:12:06,693 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMDMxNDk2LCJpYXQiOjE3NTEwMjk2OTZ9.DQoW8dM07xcHOe1R2o99pOll9Bkb14e0fw70FtThLQA
2025-06-27 06:12:22,010 - INFO - app.core.security - Closing Redis connection...
2025-06-27 06:12:22,012 - INFO - app.core.security - Redis connection closed.
